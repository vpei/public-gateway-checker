(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsPublicGatewayChecker = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var IpfsPublicGatewayChecker=(()=>{var dr=Object.create;var pn=Object.defineProperty;var pr=Object.getOwnPropertyDescriptor;var gr=Object.getOwnPropertyNames;var mr=Object.getPrototypeOf,yr=Object.prototype.hasOwnProperty;var gn=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var wr=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of gr(t))!yr.call(e,u)&&u!==r&&pn(e,u,{get:()=>t[u],enumerable:!(i=pr(t,u))||i.enumerable});return e};var Xt=(e,t,r)=>(r=e!=null?dr(mr(e)):{},wr(t||!e||!e.__esModule?pn(r,"default",{value:e,enumerable:!0}):r,e));var Qt=gn((Ft,xi)=>{(function(e){"use strict";function t(r){var i=r&&r.Promise||e.Promise,u=r&&r.XMLHttpRequest||e.XMLHttpRequest;return function(){var p=Object.create(e,{fetch:{value:void 0,writable:!0}});return function(R,f){typeof Ft=="object"&&typeof xi<"u"?f(Ft):typeof define=="function"&&define.amd?define(["exports"],f):f(R.WHATWGFetch={})}(this,function(R){"use strict";var f=typeof p<"u"&&p||typeof self<"u"&&self||typeof f<"u"&&f,E={searchParams:"URLSearchParams"in f,iterable:"Symbol"in f&&"iterator"in Symbol,blob:"FileReader"in f&&"Blob"in f&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in f,arrayBuffer:"ArrayBuffer"in f};function B(d){return d&&DataView.prototype.isPrototypeOf(d)}if(E.arrayBuffer)var O=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],C=ArrayBuffer.isView||function(d){return d&&O.indexOf(Object.prototype.toString.call(d))>-1};function T(d){if(typeof d!="string"&&(d=String(d)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(d)||d==="")throw new TypeError("Invalid character in header field name");return d.toLowerCase()}function W(d){return typeof d!="string"&&(d=String(d)),d}function S(d){var v={next:function(){var P=d.shift();return{done:P===void 0,value:P}}};return E.iterable&&(v[Symbol.iterator]=function(){return v}),v}function _(d){this.map={},d instanceof _?d.forEach(function(v,P){this.append(P,v)},this):Array.isArray(d)?d.forEach(function(v){this.append(v[0],v[1])},this):d&&Object.getOwnPropertyNames(d).forEach(function(v){this.append(v,d[v])},this)}_.prototype.append=function(d,v){d=T(d),v=W(v);var P=this.map[d];this.map[d]=P?P+", "+v:v},_.prototype.delete=function(d){delete this.map[T(d)]},_.prototype.get=function(d){return d=T(d),this.has(d)?this.map[d]:null},_.prototype.has=function(d){return this.map.hasOwnProperty(T(d))},_.prototype.set=function(d,v){this.map[T(d)]=W(v)},_.prototype.forEach=function(d,v){for(var P in this.map)this.map.hasOwnProperty(P)&&d.call(v,this.map[P],P,this)},_.prototype.keys=function(){var d=[];return this.forEach(function(v,P){d.push(P)}),S(d)},_.prototype.values=function(){var d=[];return this.forEach(function(v){d.push(v)}),S(d)},_.prototype.entries=function(){var d=[];return this.forEach(function(v,P){d.push([P,v])}),S(d)},E.iterable&&(_.prototype[Symbol.iterator]=_.prototype.entries);function M(d){if(d.bodyUsed)return i.reject(new TypeError("Already read"));d.bodyUsed=!0}function q(d){return new i(function(v,P){d.onload=function(){v(d.result)},d.onerror=function(){P(d.error)}})}function z(d){var v=new FileReader,P=q(v);return v.readAsArrayBuffer(d),P}function Y(d){var v=new FileReader,P=q(v);return v.readAsText(d),P}function F(d){for(var v=new Uint8Array(d),P=new Array(v.length),Z=0;Z<v.length;Z++)P[Z]=String.fromCharCode(v[Z]);return P.join("")}function te(d){if(d.slice)return d.slice(0);var v=new Uint8Array(d.byteLength);return v.set(new Uint8Array(d)),v.buffer}function $(){return this.bodyUsed=!1,this._initBody=function(d){this.bodyUsed=this.bodyUsed,this._bodyInit=d,d?typeof d=="string"?this._bodyText=d:E.blob&&Blob.prototype.isPrototypeOf(d)?this._bodyBlob=d:E.formData&&FormData.prototype.isPrototypeOf(d)?this._bodyFormData=d:E.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)?this._bodyText=d.toString():E.arrayBuffer&&E.blob&&B(d)?(this._bodyArrayBuffer=te(d.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):E.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(d)||C(d))?this._bodyArrayBuffer=te(d):this._bodyText=d=Object.prototype.toString.call(d):this._bodyText="",this.headers.get("content-type")||(typeof d=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):E.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},E.blob&&(this.blob=function(){var d=M(this);if(d)return d;if(this._bodyBlob)return i.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return i.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return i.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var d=M(this);return d||(ArrayBuffer.isView(this._bodyArrayBuffer)?i.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):i.resolve(this._bodyArrayBuffer))}else return this.blob().then(z)}),this.text=function(){var d=M(this);if(d)return d;if(this._bodyBlob)return Y(this._bodyBlob);if(this._bodyArrayBuffer)return i.resolve(F(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return i.resolve(this._bodyText)},E.formData&&(this.formData=function(){return this.text().then(Oe)}),this.json=function(){return this.text().then(JSON.parse)},this}var ke=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(d){var v=d.toUpperCase();return ke.indexOf(v)>-1?v:d}function ce(d,v){if(!(this instanceof ce))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');v=v||{};var P=v.body;if(d instanceof ce){if(d.bodyUsed)throw new TypeError("Already read");this.url=d.url,this.credentials=d.credentials,v.headers||(this.headers=new _(d.headers)),this.method=d.method,this.mode=d.mode,this.signal=d.signal,!P&&d._bodyInit!=null&&(P=d._bodyInit,d.bodyUsed=!0)}else this.url=String(d);if(this.credentials=v.credentials||this.credentials||"same-origin",(v.headers||!this.headers)&&(this.headers=new _(v.headers)),this.method=k(v.method||this.method||"GET"),this.mode=v.mode||this.mode||null,this.signal=v.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&P)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(P),(this.method==="GET"||this.method==="HEAD")&&(v.cache==="no-store"||v.cache==="no-cache")){var Z=/([?&])_=[^&]*/;if(Z.test(this.url))this.url=this.url.replace(Z,"$1_="+new Date().getTime());else{var ee=/\?/;this.url+=(ee.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}ce.prototype.clone=function(){return new ce(this,{body:this._bodyInit})};function Oe(d){var v=new FormData;return d.trim().split("&").forEach(function(P){if(P){var Z=P.split("="),ee=Z.shift().replace(/\+/g," "),H=Z.join("=").replace(/\+/g," ");v.append(decodeURIComponent(ee),decodeURIComponent(H))}}),v}function Ge(d){var v=new _,P=d.replace(/\r?\n[\t ]+/g," ");return P.split("\r").map(function(Z){return Z.indexOf(`
`)===0?Z.substr(1,Z.length):Z}).forEach(function(Z){var ee=Z.split(":"),H=ee.shift().trim();if(H){var le=ee.join(":").trim();v.append(H,le)}}),v}$.call(ce.prototype);function ae(d,v){if(!(this instanceof ae))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');v||(v={}),this.type="default",this.status=v.status===void 0?200:v.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in v?v.statusText:"",this.headers=new _(v.headers),this.url=v.url||"",this._initBody(d)}$.call(ae.prototype),ae.prototype.clone=function(){return new ae(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new _(this.headers),url:this.url})},ae.error=function(){var d=new ae(null,{status:0,statusText:""});return d.type="error",d};var ze=[301,302,303,307,308];ae.redirect=function(d,v){if(ze.indexOf(v)===-1)throw new RangeError("Invalid status code");return new ae(null,{status:v,headers:{location:d}})},R.DOMException=f.DOMException;try{new R.DOMException}catch{R.DOMException=function(v,P){this.message=v,this.name=P;var Z=Error(v);this.stack=Z.stack},R.DOMException.prototype=Object.create(Error.prototype),R.DOMException.prototype.constructor=R.DOMException}function Ae(d,v){return new i(function(P,Z){var ee=new ce(d,v);if(ee.signal&&ee.signal.aborted)return Z(new R.DOMException("Aborted","AbortError"));var H=new u;function le(){H.abort()}H.onload=function(){var g={status:H.status,statusText:H.statusText,headers:Ge(H.getAllResponseHeaders()||"")};g.url="responseURL"in H?H.responseURL:g.headers.get("X-Request-URL");var h="response"in H?H.response:H.responseText;setTimeout(function(){P(new ae(h,g))},0)},H.onerror=function(){setTimeout(function(){Z(new TypeError("Network request failed"))},0)},H.ontimeout=function(){setTimeout(function(){Z(new TypeError("Network request failed"))},0)},H.onabort=function(){setTimeout(function(){Z(new R.DOMException("Aborted","AbortError"))},0)};function me(g){try{return g===""&&f.location.href?f.location.href:g}catch{return g}}H.open(ee.method,me(ee.url),!0),ee.credentials==="include"?H.withCredentials=!0:ee.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&(E.blob?H.responseType="blob":E.arrayBuffer&&ee.headers.get("Content-Type")&&ee.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(H.responseType="arraybuffer")),v&&typeof v.headers=="object"&&!(v.headers instanceof _)?Object.getOwnPropertyNames(v.headers).forEach(function(g){H.setRequestHeader(g,W(v.headers[g]))}):ee.headers.forEach(function(g,h){H.setRequestHeader(h,g)}),ee.signal&&(ee.signal.addEventListener("abort",le),H.onreadystatechange=function(){H.readyState===4&&ee.signal.removeEventListener("abort",le)}),H.send(typeof ee._bodyInit>"u"?null:ee._bodyInit)})}Ae.polyfill=!0,f.fetch||(f.fetch=Ae,f.Headers=_,f.Request=ce,f.Response=ae),R.Headers=_,R.Request=ce,R.Response=ae,R.fetch=Ae,Object.defineProperty(R,"__esModule",{value:!0})}),{fetch:p.fetch,Headers:p.Headers,Request:p.Request,Response:p.Response,DOMException:p.DOMException}}()}typeof define=="function"&&define.amd?define(function(){return t}):typeof Ft=="object"?xi.exports=t:e.fetchPonyfill=t})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof globalThis<"u"?globalThis:Ft)});var Kn=gn((qn,bi)=>{(function(e,t){typeof define=="function"&&define.amd?define([],function(){return t(e.Countly)}):typeof bi=="object"&&bi.exports?bi.exports=t(e.Countly):e.Countly=t(e.Countly)})(typeof window<"u"?window:qn,function(e){if(typeof window>"u")return;e=e||{};var t={SESSIONS:"sessions",EVENTS:"events",VIEWS:"views",SCROLLS:"scrolls",CLICKS:"clicks",FORMS:"forms",CRASHES:"crashes",ATTRIBUTION:"attribution",USERS:"users",STAR_RATING:"star-rating",LOCATION:"location",APM:"apm",FEEDBACK:"feedback",REMOTE_CONFIG:"remote-config"};e.features=[t.SESSIONS,t.EVENTS,t.VIEWS,t.SCROLLS,t.CLICKS,t.FORMS,t.CRASHES,t.ATTRIBUTION,t.USERS,t.STAR_RATING,t.LOCATION,t.APM,t.FEEDBACK,t.REMOTE_CONFIG];var r={NPS:"[CLY]_nps",SURVEY:"[CLY]_survey",STAR_RATING:"[CLY]_star_rating",VIEW:"[CLY]_view",ORIENTATION:"[CLY]_orientation",PUSH_ACTION:"[CLY]_push_action",ACTION:"[CLY]_action"},i={ERROR:"[ERROR] ",WARNING:"[WARNING] ",INFO:"[INFO] ",DEBUG:"[DEBUG] ",VERBOSE:"[VERBOSE] "},u={DEVELOPER_SUPPLIED:0,SDK_GENERATED:1,TEMPORARY_ID:2,URL_PROVIDED:3},p={BEAT_INTERVAL:500,QUEUE_SIZE:1e3,FAIL_TIMEOUT_AMOUNT:60,INACTIVITY_TIME:20,SESSION_UPDATE:60,MAX_EVENT_BATCH:100,SESSION_COOKIE_TIMEOUT:30,MAX_KEY_LENGTH:128,MAX_VALUE_SIZE:256,MAX_SEGMENTATION_VALUES:30,MAX_BREADCRUMB_COUNT:100,MAX_STACKTRACE_LINES_PER_THREAD:30,MAX_STACKTRACE_LINE_LENGTH:200};e.q=e.q||[],e.onload=e.onload||[];var R="22.06.4",f="javascript_native_web",E=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,B=function(g){var h=this,J=!e.i,X=!1,we="/i",Se="/o/sdk",xe=_("interval",g,p.BEAT_INTERVAL),Pe=_("queue_size",g,p.QUEUE_SIZE),pe=[],ve=[],be={},Ue=[],Ke={},$e=_("ignore_referrers",g,[]),gt=null,mt=!0,rt,At=0,Le=null,Be=0,ot=0,Ct=0,Me=_("fail_timeout",g,p.FAIL_TIMEOUT_AMOUNT),yt=_("inactivity_time",g,p.INACTIVITY_TIME),n=0,s=_("session_update",g,p.SESSION_UPDATE),a=_("max_events",g,p.MAX_EVENT_BATCH),m=_("max_logs",g,null),w=_("use_session_cookie",g,!0),x=_("session_cookie_timeout",g,p.SESSION_COOKIE_TIMEOUT),L=!0,ue=!1,ne=_("offline_mode",g,!1),oe={},se=!0,Ee=T(),wt=!0,Ot=null,Ie=u.SDK_GENERATED,Pt=!1,Mt=0;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(o){c(i.ERROR,"Local storage test failed, Halting local storage support: "+o),wt=!1}for(var _e={},Ei=0;Ei<e.features.length;Ei++)_e[e.features[Ei]]={};this.initialize=function(){if(this.serialize=_("serialize",g,e.serialize),this.deserialize=_("deserialize",g,e.deserialize),this.getViewName=_("getViewName",g,e.getViewName),this.getViewUrl=_("getViewUrl",g,e.getViewUrl),this.getSearchQuery=_("getSearchQuery",g,e.getSearchQuery),this.DeviceIdType=e.DeviceIdType,this.namespace=_("namespace",g,""),this.clearStoredId=_("clear_stored_id",g,!1),this.app_key=_("app_key",g,null),this.onload=_("onload",g,[]),this.utm=_("utm",g,{source:!0,medium:!0,campaign:!0,term:!0,content:!0}),this.ignore_prefetch=_("ignore_prefetch",g,!0),this.rcAutoOptinAb=_("rc_automatic_optin_for_ab",g,!0),this.useExplicitRcApi=_("use_explicit_rc_api",g,!1),this.debug=_("debug",g,!1),this.test_mode=_("test_mode",g,!1),this.metrics=_("metrics",g,{}),this.headers=_("headers",g,{}),this.url=z(_("url",g,"")),this.app_version=_("app_version",g,"0.0"),this.country_code=_("country_code",g,null),this.city=_("city",g,null),this.ip_address=_("ip_address",g,null),this.ignore_bots=_("ignore_bots",g,!0),this.force_post=_("force_post",g,!1),this.remote_config=_("remote_config",g,!1),this.ignore_visitor=_("ignore_visitor",g,!1),this.require_consent=_("require_consent",g,!1),this.track_domains=_("track_domains",g,!0),this.storage=_("storage",g,"default"),this.enableOrientationTracking=_("enable_orientation_tracking",g,!0),this.maxKeyLength=_("max_key_length",g,p.MAX_KEY_LENGTH),this.maxValueSize=_("max_value_size",g,p.MAX_VALUE_SIZE),this.maxSegmentationValues=_("max_segmentation_values",g,p.MAX_SEGMENTATION_VALUES),this.maxBreadcrumbCount=_("max_breadcrumb_count",g,null),this.maxStackTraceLinesPerThread=_("max_stack_trace_lines_per_thread",g,p.MAX_STACKTRACE_LINES_PER_THREAD),this.maxStackTraceLineLength=_("max_stack_trace_line_length",g,p.MAX_STACKTRACE_LINE_LENGTH),this.heatmapWhitelist=_("heatmap_whitelist",g,[]),m&&!this.maxBreadcrumbCount?(this.maxBreadcrumbCount=m,c(i.WARNING,"initialize, 'maxCrashLogs' is deprecated. Use 'maxBreadcrumbCount' instead!")):!m&&!this.maxBreadcrumbCount&&(this.maxBreadcrumbCount=100),this.storage==="cookie"&&(wt=!1),!this.rcAutoOptinAb&&!this.useExplicitRcApi&&(c(i.WARNING,"initialize, Auto opting is disabled, switching to explicit RC API"),this.useExplicitRcApi=!0),Array.isArray($e)||($e=[]),this.url===""&&(c(i.ERROR,"initialize, Please provide server URL"),this.ignore_visitor=!0),he("cly_ignore")&&(this.ignore_visitor=!0),ur(),this.clearStoredId&&(c(i.INFO,"initialize, Clearing the device ID storage"),localStorage.removeItem(this.app_key+"/cly_id"),localStorage.removeItem(this.app_key+"/cly_id_type")),pe=he("cly_queue")||[],ve=he("cly_event")||[],be=he("cly_remote_configs")||{},on(),window.name&&window.name.indexOf("cly:")===0)try{this.passed_data=JSON.parse(window.name.replace("cly:",""))}catch(ge){c(i.ERROR,"initialize, Could not parse name: "+window.name+", error: "+ge)}else if(location.hash&&location.hash.indexOf("#cly:")===0)try{this.passed_data=JSON.parse(location.hash.replace("#cly:",""))}catch(ge){c(i.ERROR,"initialize, Could not parse hash: "+location.hash+", error: "+ge)}if((this.passed_data&&this.passed_data.app_key&&this.passed_data.app_key===this.app_key||this.passed_data&&!this.passed_data.app_key&&J)&&this.passed_data.token&&this.passed_data.purpose){this.passed_data.token!==he("cly_old_token")&&(un(this.passed_data.token),ie("cly_old_token",this.passed_data.token));var o=[];Array.isArray(this.heatmapWhitelist)?(this.heatmapWhitelist.push(this.url),o=this.heatmapWhitelist.map(function(ge){return z(ge)})):o=[this.url],o.includes(this.passed_data.url)&&this.passed_data.purpose==="heatmap"&&(this.ignore_visitor=!0,le(),ee(this.passed_data.url+"/views/heatmap.js",me))}if(this.ignore_visitor){c(i.WARNING,"initialize, ignore_visitor:["+this.ignore_visitor+"], this user will not be tracked");return}c(i.DEBUG,"initialize, app_key:["+this.app_key+"], url:["+this.url+"]"),c(i.DEBUG,"initialize, device_id:["+_("device_id",g,void 0)+"]"),c(i.DEBUG,"initialize, require_consent is enabled:["+this.require_consent+"]");try{c(i.DEBUG,"initialize, metric override:["+JSON.stringify(this.metrics)+"]"),c(i.DEBUG,"initialize, header override:["+JSON.stringify(this.headers)+"]"),c(i.DEBUG,"initialize, number of onload callbacks provided:["+this.onload.length+"]"),c(i.DEBUG,"initialize, utm tags:["+JSON.stringify(this.utm)+"]"),$e&&c(i.DEBUG,"initialize, referrers to ignore :["+JSON.stringify($e)+"]")}catch{c(i.ERROR,"initialize, Could not stringify some config object values")}c(i.DEBUG,"initialize, app_version:["+this.app_version+"]"),c(i.DEBUG,"initialize, provided location info; country_code:["+this.country_code+"], city:["+this.city+"], ip_address:["+this.ip_address+"]"),this.namespace!==""&&c(i.DEBUG,"initialize, namespace given:["+this.namespace+"]"),this.clearStoredId&&c(i.DEBUG,"initialize, clearStoredId flag set to:["+this.clearStoredId+"]"),this.ignore_prefetch&&c(i.DEBUG,"initialize, ignoring pre-fetching and pre-rendering from counting as real website visits :["+this.ignore_prefetch+"]"),this.test_mode&&c(i.WARNING,"initialize, test_mode:["+this.test_mode+"], queues won't be processed"),this.heatmapWhitelist&&c(i.DEBUG,"initialize, heatmap whitelist:["+JSON.stringify(this.heatmapWhitelist)+"], these domains will be whitelisted"),this.storage!=="default"&&c(i.DEBUG,"initialize, storage is set to:["+this.storage+"]"),this.ignore_bots&&c(i.DEBUG,"initialize, ignore traffic from bots :["+this.ignore_bots+"]"),this.force_post&&c(i.DEBUG,"initialize, forced post method for all requests:["+this.force_post+"]"),this.remote_config&&c(i.DEBUG,"initialize, remote_config callback provided:["+!!this.remote_config+"]"),typeof this.rcAutoOptinAb=="boolean"&&c(i.DEBUG,"initialize, automatic RC optin is enabled:["+this.rcAutoOptinAb+"]"),this.useExplicitRcApi||c(i.WARNING,"initialize, will use legacy RC API. Consider enabling new API during init with use_explicit_rc_api flag"),this.track_domains&&c(i.DEBUG,"initialize, tracking domain info:["+this.track_domains+"]"),this.enableOrientationTracking&&c(i.DEBUG,"initialize, enableOrientationTracking:["+this.enableOrientationTracking+"]"),w||c(i.WARNING,"initialize, use_session_cookie is enabled:["+w+"]"),ne&&c(i.DEBUG,"initialize, offline_mode:["+ne+"], user info won't be send to the servers"),ne&&c(i.DEBUG,"initialize, stored remote configs:["+JSON.stringify(be)+"]"),c(i.DEBUG,"initialize, 'getViewName' callback override provided:["+!!this.getViewName+"]"),c(i.DEBUG,"initialize, 'getSearchQuery' callback override provided:["+!!this.getSearchQuery+"]"),this.maxKeyLength!==p.MAX_KEY_LENGTH&&c(i.DEBUG,"initialize, maxKeyLength set to:["+this.maxKeyLength+"] characters"),this.maxValueSize!==p.MAX_VALUE_SIZE&&c(i.DEBUG,"initialize, maxValueSize set to:["+this.maxValueSize+"] characters"),this.maxSegmentationValues!==p.MAX_SEGMENTATION_VALUES&&c(i.DEBUG,"initialize, maxSegmentationValues set to:["+this.maxSegmentationValues+"] key/value pairs"),this.maxBreadcrumbCount!==p.MAX_BREADCRUMB_COUNT&&c(i.DEBUG,"initialize, maxBreadcrumbCount for custom logs set to:["+this.maxBreadcrumbCount+"] entries"),this.maxStackTraceLinesPerThread!==p.MAX_STACKTRACE_LINES_PER_THREAD&&c(i.DEBUG,"initialize, maxStackTraceLinesPerThread set to:["+this.maxStackTraceLinesPerThread+"] lines"),this.maxStackTraceLineLength!==p.MAX_STACKTRACE_LINE_LENGTH&&c(i.DEBUG,"initialize, maxStackTraceLineLength set to:["+this.maxStackTraceLineLength+"] characters"),xe!==p.BEAT_INTERVAL&&c(i.DEBUG,"initialize, interval for heartbeats set to:["+xe+"] milliseconds"),Pe!==p.QUEUE_SIZE&&c(i.DEBUG,"initialize, queue_size set to:["+Pe+"] items max"),Me!==p.FAIL_TIMEOUT_AMOUNT&&c(i.DEBUG,"initialize, fail_timeout set to:["+Me+"] seconds of wait time after a failed connection to server"),yt!==p.INACTIVITY_TIME&&c(i.DEBUG,"initialize, inactivity_time set to:["+yt+"] minutes to consider a user as inactive after no observable action"),s!==p.SESSION_UPDATE&&c(i.DEBUG,"initialize, session_update set to:["+s+"] seconds to check if extending a session is needed while the user is active"),a!==p.MAX_EVENT_BATCH&&c(i.DEBUG,"initialize, max_events set to:["+a+"] events to send in one batch"),m&&c(i.WARNING,"initialize, max_logs set to:["+m+"] breadcrumbs to store for crash logs max, deprecated "),x!==p.SESSION_COOKIE_TIMEOUT&&c(i.DEBUG,"initialize, session_cookie_timeout set to:["+x+"] minutes to expire a cookies session"),c(i.INFO,"initialize, Countly initialized");var l=null,y=h.getSearchQuery(),A=!1,U={};if(y)for(var I=y.substring(1).split("&"),N=0;N<I.length;N++){var b=I[N].split("=");b[0]==="cly_id"?ie("cly_cmp_id",b[1]):b[0]==="cly_uid"?ie("cly_cmp_uid",b[1]):b[0]==="cly_device_id"?l=b[1]:(b[0]+"").indexOf("utm_")===0&&this.utm[b[0].replace("utm_","")]&&(U[b[0].replace("utm_","")]=b[1],A=!0)}var V=he("cly_id")==="[CLY]_temp_id",j=_("device_id",g,void 0);if(he("cly_id")&&!V?(this.device_id=he("cly_id"),c(i.INFO,"initialize, Set the stored device ID"),Ie=he("cly_id_type"),Ie||(c(i.INFO,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED"),Ie=u.DEVELOPER_SUPPLIED)):l!==null?(c(i.INFO,"initialize, Device ID set by URL"),this.device_id=l,Ie=u.URL_PROVIDED):j?(c(i.INFO,"initialize, Device ID set by developer"),this.device_id=j,g&&Object.keys(g).length?g.device_id!==void 0&&(Ie=u.DEVELOPER_SUPPLIED):e.device_id!==void 0&&(Ie=u.DEVELOPER_SUPPLIED)):ne||V?(this.device_id="[CLY]_temp_id",Ie=u.TEMPORARY_ID,ne&&V?c(i.INFO,"initialize, Temp ID set, continuing offline mode from previous app session"):ne&&!V?c(i.INFO,"initialize, Temp ID set, entering offline mode"):(ne=!0,c(i.INFO,"initialize, Temp ID set, enabling offline mode"))):(c(i.INFO,"initialize, Generating the device ID"),this.device_id=_("device_id",g,Ai()),g&&Object.keys(g).length?g.device_id!==void 0&&(Ie=u.DEVELOPER_SUPPLIED):e.device_id!==void 0&&(Ie=u.DEVELOPER_SUPPLIED)),ie("cly_id",this.device_id),ie("cly_id_type",Ie),A){for(var Q in this.utm)U[Q]?this.userData.set("utm_"+Q,U[Q]):this.userData.unset("utm_"+Q);this.userData.save()}sn(),setTimeout(function(){Kt(),h.remote_config&&h.fetch_remote_config(h.remote_config)},1),document.documentElement.setAttribute("data-countly-useragent",Oe())},this.halt=function(){c(i.WARNING,"halt, Resetting Countly"),e.i=void 0,J=!e.i,X=!1,we="/i",Se="/o/sdk",xe=500,Pe=1e3,pe=[],ve=[],be={},Ue=[],Ke={},$e=[],gt=null,mt=!0,At=0,Le=null,Be=0,ot=0,Ct=0,Me=60,yt=20,n=0,s=60,a=100,m=null,w=!0,x=30,L=!0,ue=!1,ne=!1,oe={},se=!0,Ee=T(),wt=!0,Ot=null,Ie=u.SDK_GENERATED,Pt=!1,Mt=0;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch{c(i.ERROR,"halt, Local storage test failed, will fallback to cookies"),wt=!1}e.features=[t.SESSIONS,t.EVENTS,t.VIEWS,t.SCROLLS,t.CLICKS,t.FORMS,t.CRASHES,t.ATTRIBUTION,t.USERS,t.STAR_RATING,t.LOCATION,t.APM,t.FEEDBACK,t.REMOTE_CONFIG],_e={};for(var o=0;o<e.features.length;o++)_e[e.features[o]]={};h.app_key=void 0,h.device_id=void 0,h.onload=void 0,h.utm=void 0,h.ignore_prefetch=void 0,h.debug=void 0,h.test_mode=void 0,h.metrics=void 0,h.headers=void 0,h.url=void 0,h.app_version=void 0,h.country_code=void 0,h.city=void 0,h.ip_address=void 0,h.ignore_bots=void 0,h.force_post=void 0,h.rcAutoOptinAb=void 0,h.useExplicitRcApi=void 0,h.remote_config=void 0,h.ignore_visitor=void 0,h.require_consent=void 0,h.track_domains=void 0,h.storage=void 0,h.enableOrientationTracking=void 0,h.maxKeyLength=void 0,h.maxValueSize=void 0,h.maxSegmentationValues=void 0,h.maxBreadcrumbCount=void 0,h.maxStackTraceLinesPerThread=void 0,h.maxStackTraceLineLength=void 0},this.group_features=function(o){if(c(i.INFO,"group_features, Grouping features"),o)for(var l in o)_e[l]?c(i.WARNING,"group_features, Feature name ["+l+"] is already reserved"):typeof o[l]=="string"?_e[l]={features:[o[l]]}:o[l]&&Array.isArray(o[l])&&o[l].length?_e[l]={features:o[l]}:c(i.ERROR,"group_features, Incorrect feature list for ["+l+"] value: ["+o[l]+"]");else c(i.ERROR,"group_features, Incorrect features:["+o+"]")},this.check_consent=function(o){return c(i.INFO,"check_consent, Checking if consent is given for specific feature:["+o+"]"),this.require_consent?_e[o]?!!(_e[o]&&_e[o].optin):(c(i.ERROR,"check_consent, No feature available for ["+o+"]"),!1):(c(i.INFO,"check_consent, require_consent is off, no consent is necessary"),!0)},this.get_device_id_type=function(){c(i.INFO,"check_device_id_type, Retrieving the current device id type.["+Ie+"]");var o;switch(Ie){case u.SDK_GENERATED:o=h.DeviceIdType.SDK_GENERATED;break;case u.URL_PROVIDED:case u.DEVELOPER_SUPPLIED:o=h.DeviceIdType.DEVELOPER_SUPPLIED;break;case u.TEMPORARY_ID:o=h.DeviceIdType.TEMPORARY_ID;break;default:o=-1;break}return o},this.get_device_id=function(){return c(i.INFO,"get_device_id, Retrieving the device id: ["+this.device_id+"]"),this.device_id},this.check_any_consent=function(){if(c(i.INFO,"check_any_consent, Checking if any consent is given"),!this.require_consent)return c(i.INFO,"check_any_consent, require_consent is off, no consent is necessary"),!0;for(var o in _e)if(_e[o]&&_e[o].optin)return!0;return c(i.INFO,"check_any_consent, No consents given"),!1},this.add_consent=function(o){if(c(i.INFO,"add_consent, Adding consent for ["+o+"]"),Array.isArray(o))for(var l=0;l<o.length;l++)this.add_consent(o[l]);else _e[o]?_e[o].features?(_e[o].optin=!0,this.add_consent(_e[o].features)):_e[o].optin!==!0&&(_e[o].optin=!0,nn(),setTimeout(function(){o===t.SESSIONS&&oe.begin_session?(h.begin_session.apply(h,oe.begin_session),oe.begin_session=null):o===t.VIEWS&&oe.track_pageview&&(Le=null,h.track_pageview.apply(h,oe.track_pageview),oe.track_pageview=null)},1)):c(i.ERROR,"add_consent, No feature available for ["+o+"]")},this.remove_consent=function(o){c(i.INFO,"remove_consent, Removing consent for ["+o+"]"),this.remove_consent_internal(o,!0)},this.remove_consent_internal=function(o,l){if(l=l||!1,Array.isArray(o))for(var y=0;y<o.length;y++)this.remove_consent_internal(o[y],l);else _e[o]?_e[o].features?this.remove_consent_internal(_e[o].features,l):(_e[o].optin=!1,l&&_e[o].optin!==!1&&nn()):c(i.ERROR,"remove_consent, No feature available for ["+o+"]")};var qt,nn=function(){qt&&(clearTimeout(qt),qt=null),qt=setTimeout(function(){for(var o={},l=0;l<e.features.length;l++)_e[e.features[l]].optin===!0?o[e.features[l]]=!0:o[e.features[l]]=!1;Ce({consent:JSON.stringify(o)}),c(i.DEBUG,"Consent update request has been sent to the queue.")},1e3)};this.enable_offline_mode=function(){c(i.INFO,"enable_offline_mode, Enabling offline mode"),this.remove_consent_internal(e.features,!1),ne=!0,this.device_id="[CLY]_temp_id",Ie=u.TEMPORARY_ID},this.disable_offline_mode=function(o){c(i.INFO,"disable_offline_mode, Disabling offline mode"),ne=!1,o&&this.device_id!==o?(this.device_id=o,Ie=u.DEVELOPER_SUPPLIED,ie("cly_id",this.device_id),ie("cly_id_type",u.DEVELOPER_SUPPLIED),c(i.INFO,"disable_offline_mode, Changing id to: "+this.device_id)):(this.device_id=Ai(),this.device_id!==he("cly_id")&&(ie("cly_id",this.device_id),ie("cly_id_type",u.SDK_GENERATED)));var l=!1;if(pe.length>0)for(var y=0;y<pe.length;y++)pe[y].device_id==="[CLY]_temp_id"&&(pe[y].device_id=this.device_id,l=!0);l&&ie("cly_queue",pe,!0)},this.begin_session=function(o,l){if(c(i.INFO,"begin_session, Starting the session"),o&&c(i.INFO,"begin_session, Heartbeats are disabled"),l&&c(i.INFO,"begin_session, Session starts irrespective of session cookie"),this.check_consent(t.SESSIONS)){if(!X){this.enableOrientationTracking&&(this.report_orientation(),k(window,"resize",function(){h.report_orientation()})),rt=T(),X=!0,mt=!o;var y=he("cly_session");if(l||!w||!y||parseInt(y)<=T()){c(i.INFO,"begin_session, Session started"),Ot===null&&(Ot=!0);var A={};A.begin_session=1,A.metrics=JSON.stringify(Jt()),Ce(A)}ie("cly_session",T()+x*60)}}else oe.begin_session=arguments},this.session_duration=function(o){c(i.INFO,"session_duration, Reporting session duration"),this.check_consent(t.SESSIONS)&&X&&(c(i.INFO,"session_duration, Session extended: ",o),Ce({session_duration:o}),an())},this.end_session=function(o,l){c(i.INFO,"end_session, Ending the current session"),this.check_consent(t.SESSIONS)&&X&&(o=o||T()-rt,Si(),!w||l?(c(i.INFO,"end_session, Session ended"),Ce({end_session:1,session_duration:o})):this.session_duration(o),X=!1)},this.change_id=function(o,l){if(c(i.INFO,"change_id, Changing the ID"),l&&c(i.INFO,"change_id, Will merge the IDs"),!o||typeof o!="string"||o.length===0){c(i.ERROR,"change_id, The provided ID: ["+o+"] is not a valid ID");return}if(ne){c(i.WARNING,"change_id, Offline mode was on, initiating disabling sequence instead."),this.disable_offline_mode(o);return}if(this.device_id!==o){l||(ki(),this.end_session(null,!0),Ke={},this.remove_consent_internal(e.features,!1));var y=this.device_id;this.device_id=o,Ie=u.DEVELOPER_SUPPLIED,ie("cly_id",this.device_id),ie("cly_id_type",u.DEVELOPER_SUPPLIED),c(i.INFO,"change_id, Changing ID from:["+y+"] to ["+o+"]"),l?Ce({old_device_id:y}):this.begin_session(!mt,!0),this.remote_config&&(be={},ie("cly_remote_configs",be),this.fetch_remote_config(this.remote_config))}},this.add_event=function(o){c(i.INFO,"add_event, Adding event: ",o);var l=!1;switch(o.key){case r.NPS:l=this.check_consent("feedback");break;case r.SURVEY:l=this.check_consent("feedback");break;case r.STAR_RATING:l=this.check_consent("star-rating");break;case r.VIEW:l=this.check_consent("views");break;case r.ORIENTATION:l=this.check_consent("users");break;case r.PUSH_ACTION:l=this.check_consent("push");break;case r.ACTION:l=this.check_consent("clicks")||this.check_consent("scroll");break;default:l=this.check_consent("events")}l&&Je(o)};function Je(o){if(h.ignore_visitor){c(i.ERROR,"Adding event failed. Possible bot or user opt out");return}if(!o.key){c(i.ERROR,"Adding event failed. Event must have a key property");return}o.count||(o.count=1),o.key=$(o.key,h.maxKeyLength,"add_cly_event",c),o.segmentation=te(o.segmentation,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"add_cly_event",c);var l=["key","count","sum","dur","segmentation"],y=Y(o,l);y.timestamp=S();var A=new Date;y.hour=A.getHours(),y.dow=A.getDay(),ve.push(y),ie("cly_event",ve),c(i.INFO,"Successfully adding event: ",o)}this.start_event=function(o){if(c(i.INFO,"start_event, Starting timed event with key: ["+o+"]"),o=$(o,h.maxKeyLength,"start_event",c),Ke[o]){c(i.WARNING,"start_event, Timed event with key ["+o+"] already started");return}Ke[o]=T()},this.end_event=function(o){if(c(i.INFO,"end_event, Ending timed event"),typeof o=="string"&&(o={key:o}),!o.key){c(i.ERROR,"end_event, Timed event must have a key property");return}if(!Ke[o.key]){c(i.ERROR,"end_event, Timed event with key ["+o.key+"] was not started");return}o.dur=T()-Ke[o.key],this.add_event(o),delete Ke[o.key]},this.report_orientation=function(o){c(i.INFO,"report_orientation, Reporting orientation"),this.check_consent(t.USERS)&&Je({key:r.ORIENTATION,segmentation:{mode:o||P()}})},this.report_conversion=function(o,l){c(i.WARNING,"report_conversion, Deprecated function call! Use 'recordDirectAttribution' in place of this call. Call will be redirected now!"),this.recordDirectAttribution(o,l)},this.recordDirectAttribution=function(o,l){c(i.INFO,"recordDirectAttribution, Recording the attribution for campaign ID: ["+o+"] and the user ID: ["+l+"]"),this.check_consent(t.ATTRIBUTION)&&(o=o||he("cly_cmp_id")||"cly_organic",l=l||he("cly_cmp_uid"),Ce(l?{campaign_id:o,campaign_user:l}:{campaign_id:o}))},this.user_details=function(o){if(c(i.INFO,"user_details, Trying to add user details: ",o),this.check_consent(t.USERS)){o.name=$(o.name,h.maxValueSize,"user_details",c),o.username=$(o.username,h.maxValueSize,"user_details",c),o.email=$(o.email,h.maxValueSize,"user_details",c),o.organization=$(o.organization,h.maxValueSize,"user_details",c),o.phone=$(o.phone,h.maxValueSize,"user_details",c),o.picture=$(o.picture,4096,"user_details",c),o.gender=$(o.gender,h.maxValueSize,"user_details",c),o.byear=$(o.byear,h.maxValueSize,"user_details",c),o.custom=te(o.custom,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"user_details",c);var l=["name","username","email","organization","phone","picture","gender","byear","custom"];Ce({user_details:JSON.stringify(Y(o,l))})}};var et={},st=function(o,l,y){h.check_consent(t.USERS)&&(et[o]||(et[o]={}),y==="$push"||y==="$pull"||y==="$addToSet"?(et[o][y]||(et[o][y]=[]),et[o][y].push(l)):et[o][y]=l)};this.userData={set:function(o,l){c(i.INFO,"set, Setting user's custom property value: ["+l+"] under the key: ["+o+"]"),o=$(o,h.maxKeyLength,"userData set",c),l=$(l,h.maxValueSize,"userData set",c),et[o]=l},unset:function(o){c(i.INFO,"unset, Resetting user's custom property with key: ["+o+"] "),et[o]=""},set_once:function(o,l){c(i.INFO,"set_once, Setting user's unique custom property value: ["+l+"] under the key: ["+o+"] "),o=$(o,h.maxKeyLength,"userData set_once",c),l=$(l,h.maxValueSize,"userData set_once",c),st(o,l,"$setOnce")},increment:function(o){c(i.INFO,"increment, Increasing user's custom property value under the key: ["+o+"] by one"),o=$(o,h.maxKeyLength,"userData increment",c),st(o,1,"$inc")},increment_by:function(o,l){c(i.INFO,"increment_by, Increasing user's custom property value under the key: ["+o+"] by: ["+l+"]"),o=$(o,h.maxKeyLength,"userData increment_by",c),l=$(l,h.maxValueSize,"userData increment_by",c),st(o,l,"$inc")},multiply:function(o,l){c(i.INFO,"multiply, Multiplying user's custom property value under the key: ["+o+"] by: ["+l+"]"),o=$(o,h.maxKeyLength,"userData multiply",c),l=$(l,h.maxValueSize,"userData multiply",c),st(o,l,"$mul")},max:function(o,l){c(i.INFO,"max, Saving user's maximum custom property value compared to the value: ["+l+"] under the key: ["+o+"]"),o=$(o,h.maxKeyLength,"userData max",c),l=$(l,h.maxValueSize,"userData max",c),st(o,l,"$max")},min:function(o,l){c(i.INFO,"min, Saving user's minimum custom property value compared to the value: ["+l+"] under the key: ["+o+"]"),o=$(o,h.maxKeyLength,"userData min",c),l=$(l,h.maxValueSize,"userData min",c),st(o,l,"$min")},push:function(o,l){c(i.INFO,"push, Pushing a value: ["+l+"] under the key: ["+o+"] to user's custom property array"),o=$(o,h.maxKeyLength,"userData push",c),l=$(l,h.maxValueSize,"userData push",c),st(o,l,"$push")},push_unique:function(o,l){c(i.INFO,"push_unique, Pushing a unique value: ["+l+"] under the key: ["+o+"] to user's custom property array"),o=$(o,h.maxKeyLength,"userData push_unique",c),l=$(l,h.maxValueSize,"userData push_unique",c),st(o,l,"$addToSet")},pull:function(o,l){c(i.INFO,"pull, Removing the value: ["+l+"] under the key: ["+o+"] from user's custom property array"),st(o,l,"$pull")},save:function(){c(i.INFO,"save, Saving changes to user's custom property"),h.check_consent(t.USERS)&&Ce({user_details:JSON.stringify({custom:et})}),et={}}},this.report_trace=function(o){if(c(i.INFO,"report_trace, Reporting performance trace"),this.check_consent(t.APM)){for(var l=["type","name","stz","etz","apm_metrics","apm_attr"],y=0;y<l.length;y++)if(l[y]!=="apm_attr"&&typeof o[l[y]]>"u"){c(i.WARNING,"report_trace, APM trace don't have the property: "+l[y]);return}o.name=$(o.name,h.maxKeyLength,"report_trace",c),o.app_metrics=te(o.app_metrics,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"report_trace",c);var A=Y(o,l);A.timestamp=o.stz;var U=new Date;A.hour=U.getHours(),A.dow=U.getDay(),Ce({apm:JSON.stringify(A)}),c(i.INFO,"report_trace, Successfully adding APM trace: ",A)}},this.track_errors=function(o){c(i.INFO,"track_errors, Started tracking errors"),e.i[this.app_key].tracking_crashes=!0,window.cly_crashes||(window.cly_crashes=!0,gt=o,window.onerror=function l(y,A,U,I,N){if(N!=null)M(N,!1);else{I=I||window.event&&window.event.errorCharacter;var b="";typeof y<"u"&&(b+=y+`
`),typeof A<"u"&&(b+="at "+A),typeof U<"u"&&(b+=":"+U),typeof I<"u"&&(b+=":"+I),b+=`
`;try{for(var V=[],j=l.caller;j;)V.push(j.name),j=j.caller;b+=V.join(`
`)}catch(Q){c(i.ERROR,"track_errors, Call stack generation experienced a problem: "+Q)}M(b,!1)}},window.addEventListener("unhandledrejection",function(l){M(new Error("Unhandled rejection (reason: "+(l.reason&&l.reason.stack?l.reason.stack:l.reason)+")."),!0)}))},this.log_error=function(o,l){c(i.INFO,"log_error, Logging errors"),this.recordError(o,!0,l)},this.add_log=function(o){if(c(i.INFO,"add_log, Adding a new log of breadcrumbs: [ "+o+" ]"),this.check_consent(t.CRASHES)){for(o=$(o,h.maxValueSize,"add_log",c);Ue.length>=h.maxBreadcrumbCount;)Ue.shift(),c(i.WARNING,"add_log, Reached maximum crashLogs size. Will erase the oldest one.");Ue.push(o)}},this.fetch_remote_config=function(o,l,y){var A=null,U=null,I=null;if(o&&(!y&&typeof o=="function"?I=o:Array.isArray(o)&&(A=o)),l&&(!y&&typeof l=="function"?I=l:Array.isArray(l)&&(U=l)),!I&&typeof y=="function"&&(I=y),this.useExplicitRcApi){c(i.INFO,"fetch_remote_config, Fetching remote config");var N=this.rcAutoOptinAb?1:0;rn(A,U,N,null,I);return}c(i.WARNING,"fetch_remote_config, Fetching remote config, with legacy API"),rn(A,U,null,"legacy",I)};function rn(o,l,y,A,U){c(i.INFO,"fetch_remote_config_explicit, Fetching sequence initiated");var I={method:"rc"};o&&(I.keys=JSON.stringify(o)),l&&(I.omit_keys=JSON.stringify(l));var N;A==="legacy"&&(I.method="fetch_remote_config"),y===0&&(I.oi=0),y===1&&(I.oi=1),typeof U=="function"&&(N=U),h.check_consent(t.SESSIONS)&&(I.metrics=JSON.stringify(Jt())),h.check_consent(t.REMOTE_CONFIG)?(Ii(I),ct("fetch_remote_config_explicit",h.url+Se,I,function(b,V,j){if(b){c(i.ERROR,"fetch_remote_config_explicit, An error occurred: "+b);return}try{var Q=JSON.parse(j);if(I.keys||I.omit_keys)for(var ge in Q)be[ge]=Q[ge];else be=Q;ie("cly_remote_configs",be)}catch(ye){c(i.ERROR,"fetch_remote_config_explicit, Had an issue while parsing the response: "+ye)}N&&(c(i.INFO,"fetch_remote_config_explicit, Callback function is provided"),N(b,be))},!0)):(c(i.ERROR,"fetch_remote_config_explicit, Remote config requires explicit consent"),N&&N(new Error("Remote config requires explicit consent"),be))}this.enrollUserToAb=function(o){if(c(i.INFO,"enrollUserToAb, Providing AB test keys to opt in for"),!o||!Array.isArray(o)||o.length===0){c(i.ERROR,"enrollUserToAb, No keys provided");return}var l={method:"ab",keys:JSON.stringify(o)};Ii(l),ct("enrollUserToAb",this.url+Se,l,function(y,A,U){if(y){c(i.ERROR,"enrollUserToAb, An error occurred: "+y);return}try{var I=JSON.parse(U);c(i.DEBUG,"enrollUserToAb, Parsed the response's result: ["+I.result+"]")}catch(N){c(i.ERROR,"enrollUserToAb, Had an issue while parsing the response: "+N)}},!0)},this.get_remote_config=function(o){return c(i.INFO,"get_remote_config, Getting remote config from storage"),typeof o<"u"?be[o]:be},this.stop_time=function(){c(i.INFO,"stop_time, Stopping tracking duration"),se&&(se=!1,At=T()-rt,ot=T()-Be)},this.start_time=function(){c(i.INFO,"start_time, Starting tracking duration"),se||(se=!0,rt=T()-At,Be=T()-ot,ot=0,an())},this.track_sessions=function(){c(i.INFO,"track_session, Starting tracking user session"),this.begin_session(),this.start_time(),k(window,"beforeunload",function(){ki(),h.end_session()});var o="hidden";function l(){document[o]||!document.hasFocus()?h.stop_time():h.start_time()}k(window,"focus",l),k(window,"blur",l),k(window,"pageshow",l),k(window,"pagehide",l),"onfocusin"in document&&(k(window,"focusin",l),k(window,"focusout",l)),o in document?document.addEventListener("visibilitychange",l):"mozHidden"in document?(o="mozHidden",document.addEventListener("mozvisibilitychange",l)):"webkitHidden"in document?(o="webkitHidden",document.addEventListener("webkitvisibilitychange",l)):"msHidden"in document&&(o="msHidden",document.addEventListener("msvisibilitychange",l));function y(){n>=yt&&h.start_time(),n=0}k(window,"mousemove",y),k(window,"click",y),k(window,"keydown",y),k(window,"scroll",y),setInterval(function(){n++,n>=yt&&h.stop_time()},6e4)},this.track_pageview=function(o,l,y){if(c(i.INFO,"track_pageview, Tracking page views"),c(i.VERBOSE,"track_pageview, last view is:["+Le+"]"),Le&&(c(i.DEBUG,"track_pageview, Scroll registry triggered"),Oi(),Pt=!0,Mt=0),Si(),o=$(o,h.maxKeyLength,"track_pageview",c),o&&Array.isArray(o)&&(l=o,o=null),o||(o=this.getViewName()),o===void 0||o===""){c(i.ERROR,"track_pageview, No page name to track (it is either undefined or empty string). No page view can be tracked.");return}if(o===null){c(i.ERROR,"track_pageview, View name returned as null. Page view will be ignored.");return}if(l&&l.length)for(var A=0;A<l.length;A++)try{var U=new RegExp(l[A]);if(U.test(o)){c(i.INFO,"track_pageview, Ignoring the page: "+o);return}}catch(j){c(i.ERROR,"track_pageview, Problem with finding ignore list item: "+l[A]+", error: "+j)}Le=o,Be=T(),c(i.VERBOSE,"track_pageview, last view is assigned:["+Le+"]");var I={name:o,visit:1,view:h.getViewUrl()};if(I=te(I,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"track_pageview",c),this.track_domains&&(I.domain=window.location.hostname),w)if(X)Ot&&(Ot=!1,I.start=1);else{var N=he("cly_session");(!N||parseInt(N)<=T())&&(Ot=!1,I.start=1)}else if(typeof document.referrer<"u"&&document.referrer.length){var b=E.exec(document.referrer);b&&b[11]&&b[11]!==window.location.hostname&&(I.start=1)}if(y){y=te(y,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"track_pageview",c);for(var V in y)typeof I[V]>"u"&&(I[V]=y[V])}this.check_consent(t.VIEWS)?Je({key:r.VIEW,segmentation:I}):oe.track_pageview=arguments},this.track_view=function(o,l,y){c(i.INFO,"track_view, Initiating tracking page views"),this.track_pageview(o,l,y)},this.track_clicks=function(o){c(i.INFO,"track_clicks, Starting to track clicks"),o&&c(i.INFO,"track_clicks, Tracking the specified children:["+o+"]"),o=o||document;var l=!0;function y(A){if(l){if(l=!1,ze(A),typeof A.pageX<"u"&&typeof A.pageY<"u"){var U=Ae(),I=d();if(h.check_consent(t.CLICKS)){var N={type:"click",x:A.pageX,y:A.pageY,width:I,height:U,view:h.getViewUrl()};N=te(N,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"processClick",c),h.track_domains&&(N.domain=window.location.hostname),Je({key:r.ACTION,segmentation:N})}}setTimeout(function(){l=!0},1e3)}}k(o,"click",y)},this.track_scrolls=function(o){c(i.INFO,"track_scrolls, Starting to track scrolls"),o&&c(i.INFO,"track_scrolls, Tracking the specified children"),o=o||window,Pt=!0,k(o,"scroll",ln),k(o,"beforeunload",Oi)},this.track_links=function(o){c(i.INFO,"track_links, Starting to track clicks to links"),o&&c(i.INFO,"track_links, Tracking the specified children"),o=o||document;function l(y){var A=ke(ce(y),"a");A&&(ze(y),h.check_consent(t.CLICKS)&&Je({key:"linkClick",segmentation:{href:A.href,text:A.innerText,id:A.id,view:h.getViewUrl()}}))}k(o,"click",l)},this.track_forms=function(o,l){c(i.INFO,"track_forms, Starting to track form submissions. DOM object provided:["+!!o+"] Tracking hidden inputs :["+!!l+"]"),o=o||document;function y(U){return U.name||U.id||U.type||U.nodeName}function A(U){var I=ce(U),N={id:I.attributes.id&&I.attributes.id.nodeValue,name:I.attributes.name&&I.attributes.name.nodeValue,action:I.attributes.action&&I.attributes.action.nodeValue,method:I.attributes.method&&I.attributes.method.nodeValue,view:h.getViewUrl()},b;if(typeof I.elements<"u"){for(var V=0;V<I.elements.length;V++)b=I.elements[V],b&&b.type!=="password"&&b.className.indexOf("cly_user_ignore")===-1&&(typeof N["input:"+y(b)]>"u"&&(N["input:"+y(b)]=[]),b.nodeName.toLowerCase()==="select"?typeof b.multiple<"u"?N["input:"+y(b)].push(O(b)):N["input:"+y(b)].push(b.options[b.selectedIndex].value):b.nodeName.toLowerCase()==="input"?typeof b.type<"u"?b.type.toLowerCase()==="checkbox"||b.type.toLowerCase()==="radio"?b.checked&&N["input:"+y(b)].push(b.value):(b.type.toLowerCase()!=="hidden"||l)&&N["input:"+y(b)].push(b.value):N["input:"+y(b)].push(b.value):(b.nodeName.toLowerCase()==="textarea"||typeof b.value<"u")&&N["input:"+y(b)].push(b.value));for(var j in N)N[j]&&typeof N[j].join=="function"&&(N[j]=N[j].join(", "))}h.check_consent(t.FORMS)&&Je({key:"formSubmit",segmentation:N})}k(o,"submit",A)},this.collect_from_forms=function(o,l){c(i.INFO,"collect_from_forms, Starting to collect possible user data. DOM object provided:["+!!o+"] Submitting custom user property:["+!!l+"]"),o=o||document;function y(A){var U=ce(A),I={},N=!1,b;if(typeof U.elements<"u"){var V={},j=o.getElementsByTagName("LABEL"),Q,ge;for(Q=0;Q<j.length;Q++)j[Q].htmlFor&&j[Q].htmlFor!==""&&(V[j[Q].htmlFor]=j[Q].innerText||j[Q].textContent||j[Q].innerHTML);for(Q=0;Q<U.elements.length;Q++)if(b=U.elements[Q],b&&b.type!=="password"&&b.className.indexOf("cly_user_ignore")===-1){var ye="";if(b.nodeName.toLowerCase()==="select"?typeof b.multiple<"u"?ye=O(b):ye=b.options[b.selectedIndex].value:b.nodeName.toLowerCase()==="input"?typeof b.type<"u"&&(b.type.toLowerCase()==="checkbox"||b.type.toLowerCase()==="radio")?b.checked&&(ye=b.value):ye=b.value:(b.nodeName.toLowerCase()==="textarea"||typeof b.value<"u")&&(ye=b.value),b.className&&b.className.indexOf("cly_user_")!==-1){var Ye=b.className.split(" ");for(ge=0;ge<Ye.length;ge++)if(Ye[ge].indexOf("cly_user_")===0){I[Ye[ge].replace("cly_user_","")]=ye,N=!0;break}}else b.type&&b.type.toLowerCase()==="email"||b.name&&b.name.toLowerCase().indexOf("email")!==-1||b.id&&b.id.toLowerCase().indexOf("email")!==-1||b.id&&V[b.id]&&V[b.id].toLowerCase().indexOf("email")!==-1||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(ye)?(I.email||(I.email=ye),N=!0):b.name&&b.name.toLowerCase().indexOf("username")!==-1||b.id&&b.id.toLowerCase().indexOf("username")!==-1||b.id&&V[b.id]&&V[b.id].toLowerCase().indexOf("username")!==-1?(I.username||(I.username=ye),N=!0):b.name&&(b.name.toLowerCase().indexOf("tel")!==-1||b.name.toLowerCase().indexOf("phone")!==-1||b.name.toLowerCase().indexOf("number")!==-1)||b.id&&(b.id.toLowerCase().indexOf("tel")!==-1||b.id.toLowerCase().indexOf("phone")!==-1||b.id.toLowerCase().indexOf("number")!==-1)||b.id&&V[b.id]&&(V[b.id].toLowerCase().indexOf("tel")!==-1||V[b.id].toLowerCase().indexOf("phone")!==-1||V[b.id].toLowerCase().indexOf("number")!==-1)?(I.phone||(I.phone=ye),N=!0):b.name&&(b.name.toLowerCase().indexOf("org")!==-1||b.name.toLowerCase().indexOf("company")!==-1)||b.id&&(b.id.toLowerCase().indexOf("org")!==-1||b.id.toLowerCase().indexOf("company")!==-1)||b.id&&V[b.id]&&(V[b.id].toLowerCase().indexOf("org")!==-1||V[b.id].toLowerCase().indexOf("company")!==-1)?(I.organization||(I.organization=ye),N=!0):(b.name&&b.name.toLowerCase().indexOf("name")!==-1||b.id&&b.id.toLowerCase().indexOf("name")!==-1||b.id&&V[b.id]&&V[b.id].toLowerCase().indexOf("name")!==-1)&&(I.name||(I.name=""),I.name+=ye+" ",N=!0)}}N&&(c(i.INFO,"collect_from_forms, Gathered user data",I),l?h.user_details({custom:I}):h.user_details(I))}k(o,"submit",y)},this.collect_from_facebook=function(o){c(i.INFO,"collect_from_facebook, Starting to collect possible user data"),FB&&FB.api&&FB.api("/me",function(l){var y={};if(l.name&&(y.name=l.name),l.email&&(y.email=l.email),l.gender==="male"?y.gender="M":l.gender==="female"&&(y.gender="F"),l.birthday){var A=l.birthday.split("/").pop();A&&A.length===4&&(y.byear=A)}if(l.work&&l.work[0]&&l.work[0].employer&&l.work[0].employer.name&&(y.organization=l.work[0].employer.name),o){y.custom={};for(var U in o){for(var I=o[U].split("."),N=l,b=0;b<I.length&&(N=N[I[b]],!(typeof N>"u"));b++);typeof N<"u"&&(y.custom[U]=N)}}h.user_details(y)})},this.opt_out=function(){c(i.INFO,"opt_out, Opting out the user"),this.ignore_visitor=!0,ie("cly_ignore",!0)},this.opt_in=function(){c(i.INFO,"opt_in, Opting in the user"),ie("cly_ignore",!1),this.ignore_visitor=!1,on(),!this.ignore_visitor&&!ue&&Kt()},this.report_feedback=function(o){c(i.WARNING,"report_feedback, Deprecated function call! Use 'recordRatingWidgetWithID' or 'reportFeedbackWidgetManually' in place of this call. Call will be redirected to 'recordRatingWidgetWithID' now!"),this.recordRatingWidgetWithID(o)},this.recordRatingWidgetWithID=function(o){if(c(i.INFO,"recordRatingWidgetWithID, Providing information about user with ID: [ "+o.widget_id+" ]"),!!this.check_consent(t.STAR_RATING)){if(!o.widget_id){c(i.ERROR,"recordRatingWidgetWithID, Rating Widget must contain widget_id property");return}if(!o.rating){c(i.ERROR,"recordRatingWidgetWithID, Rating Widget must contain rating property");return}var l=["widget_id","contactMe","platform","app_version","rating","email","comment"],y={key:r.STAR_RATING,count:1,segmentation:{}};y.segmentation=Y(o,l),y.segmentation.app_version||(y.segmentation.app_version=this.metrics._app_version||this.app_version),y.segmentation.rating>5?(c(i.WARNING,"recordRatingWidgetWithID, You have entered a rating higher than 5. Changing it back to 5 now."),y.segmentation.rating=5):y.segmentation.rating<1&&(c(i.WARNING,"recordRatingWidgetWithID, You have entered a rating lower than 1. Changing it back to 1 now."),y.segmentation.rating=1),c(i.INFO,"recordRatingWidgetWithID, Reporting Rating Widget: ",y),Je(y)}},this.reportFeedbackWidgetManually=function(o,l,y){if(!!this.check_consent(t.FEEDBACK)){if(!(o&&l)){c(i.ERROR,"reportFeedbackWidgetManually, Widget data and/or Widget object not provided. Aborting.");return}if(!o._id){c(i.ERROR,"reportFeedbackWidgetManually, Feedback Widgets must contain _id property");return}if(ne){c(i.ERROR,"reportFeedbackWidgetManually, Feedback Widgets can not be reported in offline mode");return}c(i.INFO,"reportFeedbackWidgetManually, Providing information about user with, provided result of the widget with  ID: [ "+o._id+" ] and type: ["+o.type+"]");var A=[],U=o.type,I;if(U==="nps"){if(y){if(!y.rating){c(i.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");return}y.rating=Math.round(y.rating),y.rating>10?(c(i.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 10. Changing it back to 10 now."),y.rating=10):y.rating<0&&(c(i.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 0. Changing it back to 0 now."),y.rating=0),A=["rating","comment"]}I=r.NPS}else if(U==="survey"){if(y){if(Object.keys(y).length<1){c(i.ERROR,"reportFeedbackWidgetManually, Widget should have answers to be reported");return}A=Object.keys(y)}I=r.SURVEY}else if(U==="rating"){if(y){if(!y.rating){c(i.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");return}y.rating=Math.round(y.rating),y.rating>5?(c(i.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 5. Changing it back to 5 now."),y.rating=5):y.rating<1&&(c(i.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 1. Changing it back to 1 now."),y.rating=1),A=["rating","comment","email","contactMe"]}I=r.STAR_RATING}else{c(i.ERROR,"reportFeedbackWidgetManually, Widget has an unacceptable type");return}var N={key:I,count:1,segmentation:{widget_id:o._id,platform:this.platform,app_version:this.metrics._app_version||this.app_version}};y===null?N.segmentation.closed=1:N.segmentation=F(N.segmentation,y,A),c(i.INFO,"reportFeedbackWidgetManually, Reporting "+U+": ",N),Je(N)}},this.show_feedback_popup=function(o){c(i.WARNING,"show_feedback_popup, Deprecated function call! Use 'presentRatingWidgetWithID' in place of this call. Call will be redirected now!"),this.presentRatingWidgetWithID(o)},this.presentRatingWidgetWithID=function(o){c(i.INFO,"presentRatingWidgetWithID, Showing rating widget popup for the widget with ID: [ "+o+" ]"),this.check_consent(t.STAR_RATING)&&(ne?c(i.ERROR,"presentRatingWidgetWithID, Cannot show ratingWidget popup in offline mode"):ct("presentRatingWidgetWithID",this.url+"/o/feedback/widget",{widget_id:o},function(l,y,A){if(l){c(i.ERROR,"presentRatingWidgetWithID, An error occurred: "+l);return}try{var U=JSON.parse(A);Ri(U,!1)}catch(I){c(i.ERROR,"presentRatingWidgetWithID, JSON parse failed: "+I)}},!0))},this.initialize_feedback_popups=function(o){c(i.WARNING,"initialize_feedback_popups, Deprecated function call! Use 'initializeRatingWidgets' in place of this call. Call will be redirected now!"),this.initializeRatingWidgets(o)},this.initializeRatingWidgets=function(o){if(c(i.INFO,"initializeRatingWidgets, Initializing rating widget with provided widget IDs:[ "+o+"]"),!!this.check_consent(t.STAR_RATING)){o||(o=he("cly_fb_widgets"));for(var l=document.getElementsByClassName("countly-feedback-sticker");l.length>0;)l[0].remove();ct("initializeRatingWidgets",this.url+"/o/feedback/multiple-widgets-by-id",{widgets:JSON.stringify(o)},function(y,A,U){if(y){c(i.ERROR,"initializeRatingWidgets, An error occurred: "+y);return}try{for(var I=JSON.parse(U),N=0;N<I.length;N++)if(I[N].is_active==="true"){var b=I[N].target_devices,V=Ge();if(b[V])if(typeof I[N].hide_sticker=="string"&&(I[N].hide_sticker=I[N].hide_sticker==="true"),I[N].target_page==="all"&&!I[N].hide_sticker)Ri(I[N],!0);else for(var j=I[N].target_pages,Q=0;Q<j.length;Q++){var ge=j[Q].substr(0,j[Q].length-1)===window.location.pathname.substr(0,j[Q].length-1),ye=j[Q]===window.location.pathname,Ye=j[Q].includes("*");(Ye&&ge||ye)&&!I[N].hide_sticker&&Ri(I[N],!0)}}}catch(De){c(i.ERROR,"initializeRatingWidgets, JSON parse error: "+De)}},!0)}},this.enable_feedback=function(o){c(i.WARNING,"enable_feedback, Deprecated function call! Use 'enableRatingWidgets' in place of this call. Call will be redirected now!"),this.enableRatingWidgets(o)},this.enableRatingWidgets=function(o){if(c(i.INFO,"enableRatingWidgets, Enabling rating widget with params:",o),!!this.check_consent(t.STAR_RATING))if(ne)c(i.ERROR,"enableRatingWidgets, Cannot enable rating widgets in offline mode");else{ie("cly_fb_widgets",o.popups||o.widgets),H(this.url+"/star-rating/stylesheets/countly-feedback-web.css");var l=o.popups||o.widgets;l.length>0?(document.body.insertAdjacentHTML("beforeend",'<div id="cfbg"></div>'),this.initializeRatingWidgets(l)):c(i.ERROR,"enableRatingWidgets, You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback")}},this.get_available_feedback_widgets=function(o){if(c(i.INFO,"get_available_feedback_widgets, Getting the feedback list, callback function is provided:["+!!o+"]"),!this.check_consent(t.FEEDBACK)){o&&o(null,new Error("Consent for feedback not provided."));return}if(ne){c(i.ERROR,"get_available_feedback_widgets, Cannot enable feedback widgets in offline mode.");return}var l=this.url+Se,y={method:t.FEEDBACK,device_id:this.device_id,app_key:this.app_key};ct("get_available_feedback_widgets",l,y,function(A,U,I){if(A){c(i.ERROR,"get_available_feedback_widgets, Error occurred while fetching feedbacks: "+A),o&&o(null,A);return}try{var N=JSON.parse(I),b=N.result||[];o&&o(b,null);return}catch(V){c(i.ERROR,"get_available_feedback_widgets, Error while parsing feedback widgets list: "+V),o&&o(null,V)}},!1)},this.getFeedbackWidgetData=function(o,l){if(!o.type){c(i.ERROR,"getFeedbackWidgetData, Expected the provided widget object to have a type but got: ["+JSON.stringify(o)+"], aborting.");return}if(c(i.INFO,"getFeedbackWidgetData, Retrieving data for: ["+JSON.stringify(o)+"], callback function is provided:["+!!l+"]"),!this.check_consent(t.FEEDBACK)){l&&l(null,new Error("Consent for feedback not provided."));return}if(ne){c(i.ERROR,"getFeedbackWidgetData, Cannot enable feedback widgets in offline mode.");return}var y=this.url,A={widget_id:o._id,shown:1,sdk_version:R,sdk_name:f,platform:this.platform,app_version:this.app_version};if(o.type==="nps")y+="/o/surveys/nps/widget";else if(o.type==="survey")y+="/o/surveys/survey/widget";else if(o.type==="rating")y+="/o/surveys/rating/widget";else{c(i.ERROR,"getFeedbackWidgetData, Unknown type info: ["+o.type+"]");return}ct("getFeedbackWidgetData",y,A,U,!0);function U(I,N,b){if(I){c(i.ERROR,"getFeedbackWidgetData, Error occurred while fetching feedbacks: "+I),l&&l(null,I);return}try{var V=JSON.parse(b);l&&l(V,null);return}catch(j){c(i.ERROR,"getFeedbackWidgetData, Error while parsing feedback widgets list: "+j),l&&l(null,j)}}},this.present_feedback_widget=function(o,l,y){if(c(i.INFO,"present_feedback_widget, Presenting the feedback widget by appending to the element with ID: [ "+l+" ] and className: [ "+y+" ]"),!this.check_consent(t.FEEDBACK))return;if(!o||typeof o!="object"||Array.isArray(o)){c(i.ERROR,"present_feedback_widget, Please provide at least one feedback widget object.");return}try{var A=this.url;if(o.type==="nps")c(i.DEBUG,"present_feedback_widget, Widget type: nps."),A+="/feedback/nps";else if(o.type==="survey")c(i.DEBUG,"present_feedback_widget, Widget type: survey."),A+="/feedback/survey";else if(o.type==="rating")c(i.DEBUG,"present_feedback_widget, Widget type: rating."),A+="/feedback/rating";else{c(i.ERROR,"present_feedback_widget, Feedback widget only accepts nps, rating and survey types.");return}var U=window.origin||window.location.origin,I;o.type==="rating"?(c(i.DEBUG,"present_feedback_widget, Loading css for rating widget."),I="ratings",H(this.url+"/star-rating/stylesheets/countly-feedback-web.css")):(c(i.DEBUG,"present_feedback_widget, Loading css for survey or nps."),H(this.url+"/surveys/stylesheets/countly-surveys.css"),I="surveys"),A+="?widget_id="+o._id,A+="&app_key="+this.app_key,A+="&device_id="+this.device_id,A+="&sdk_name="+f,A+="&platform="+this.platform,A+="&app_version="+this.app_version,A+="&sdk_version="+R,A+="&origin="+U,A+="&widget_v=web";var N=document.createElement("iframe");N.src=A,N.name="countly-"+I+"-iframe",N.id="countly-"+I+"-iframe";var b=!1;N.onload=function(){b&&(document.getElementById("countly-"+I+"-wrapper-"+o._id).style.display="none",document.getElementById("csbg").style.display="none"),b=!0,c(i.DEBUG,"present_feedback_widget, Loaded iframe.")};for(var V=document.getElementById("csbg");V;)V.remove(),V=document.getElementById("csbg"),c(i.DEBUG,"present_feedback_widget, Removing past overlay.");for(var j=document.getElementsByClassName("countly-"+I+"-wrapper"),Q=0;Q<j.length;Q++)j[Q].remove(),c(i.DEBUG,"present_feedback_widget, Removed a wrapper.");j=document.createElement("div"),j.className="countly-"+I+"-wrapper",j.id="countly-"+I+"-wrapper-"+o._id,o.type==="survey"&&(j.className=j.className+" "+o.appearance.position);var ge=document.body,ye=!1;if(l&&(document.getElementById(l)?(ge=document.getElementById(l),ye=!0):c(i.ERROR,"present_feedback_widget, Provided ID not found.")),ye||y&&(document.getElementsByClassName(y)[0]?ge=document.getElementsByClassName(y)[0]:c(i.ERROR,"present_feedback_widget, Provided class not found.")),ge.insertAdjacentHTML("beforeend",'<div id="csbg"></div>'),ge.appendChild(j),o.type==="rating"){var Ye=document.createElement("div");Ye.className="countly-ratings-overlay",Ye.id="countly-ratings-overlay-"+o._id,j.appendChild(Ye),c(i.DEBUG,"present_feedback_widget, appended the rating overlay to wrapper"),k(document.getElementById("countly-ratings-overlay-"+o._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+o._id).style.display="none"})}if(j.appendChild(N),c(i.DEBUG,"present_feedback_widget, Appended the iframe"),k(window,"message",function(de){var Ve={};try{Ve=JSON.parse(de.data),c(i.DEBUG,"present_feedback_widget, Parsed response message "+Ve)}catch(hr){c(i.ERROR,"present_feedback_widget, Error while parsing message body "+hr)}if(!Ve.close){c(i.DEBUG,"present_feedback_widget, Closing signal not sent yet");return}document.getElementById("countly-"+I+"-wrapper-"+o._id).style.display="none",document.getElementById("csbg").style.display="none"}),o.type==="survey"){var De=!1;switch(o.showPolicy){case"afterPageLoad":document.readyState==="complete"?De||(De=!0,_t(o)):k(document,"readystatechange",function(de){de.target.readyState==="complete"&&(De||(De=!0,_t(o)))});break;case"afterConstantDelay":setTimeout(function(){De||(De=!0,_t(o))},1e4);break;case"onAbandon":document.readyState==="complete"?k(document,"mouseleave",function(){De||(De=!0,_t(o))}):k(document,"readystatechange",function(de){de.target.readyState==="complete"&&k(document,"mouseleave",function(){De||(De=!0,_t(o))})});break;case"onScrollHalfwayDown":k(window,"scroll",function(){if(!De){var de=Math.max(window.scrollY,document.body.scrollTop,document.documentElement.scrollTop),Ve=Ae();de>=Ve/2&&(De=!0,_t(o))}});break;default:De||(De=!0,_t(o))}}else if(o.type==="nps")document.getElementById("countly-"+I+"-wrapper-"+o._id).style.display="block",document.getElementById("csbg").style.display="block";else if(o.type==="rating"){var Yt=!1;document.readyState==="complete"?Yt||(Yt=!0,dn(o)):k(document,"readystatechange",function(de){de.target.readyState==="complete"&&(Yt||(Yt=!0,dn(o)))})}}catch(de){c(i.ERROR,"present_feedback_widget, Something went wrong while presenting the widget: "+de)}function _t(de){document.getElementById("countly-surveys-wrapper-"+de._id).style.display="block",document.getElementById("csbg").style.display="block"}function dn(de){if(!de.appearance.hideS){c(i.DEBUG,"present_feedback_widget, handling the sticker as it was not set to hidden");var Ve=document.createElement("div");Ve.innerText=de.appearance.text,Ve.style.color=de.appearance.text_color.length<7?"#"+de.appearance.text_color:de.appearance.text_color,Ve.style.backgroundColor=de.appearance.bg_color.length<7?"#"+de.appearance.bg_color:de.appearance.bg_color,Ve.className="countly-feedback-sticker  "+de.appearance.position+"-"+de.appearance.size,Ve.id="countly-feedback-sticker-"+de._id,document.body.appendChild(Ve),k(document.getElementById("countly-feedback-sticker-"+de._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+de._id).style.display="flex",document.getElementById("csbg").style.display="block"})}k(document.getElementById("countly-feedback-close-icon-"+de._id),"click",function(){document.getElementById("countly-ratings-wrapper-"+de._id).style.display="none",document.getElementById("csbg").style.display="none"})}},this.recordError=function(o,l,y){if(c(i.INFO,"recordError, Recording error"),this.check_consent(t.CRASHES)&&o){y=y||gt;var A="";if(typeof o=="object"?typeof o.stack<"u"?A=o.stack:(typeof o.name<"u"&&(A+=o.name+":"),typeof o.message<"u"&&(A+=o.message+`
`),typeof o.fileName<"u"&&(A+="in "+o.fileName+`
`),typeof o.lineNumber<"u"&&(A+="on "+o.lineNumber),typeof o.columnNumber<"u"&&(A+=":"+o.columnNumber)):A=o+"",A.length>h.maxStackTraceLineLength*h.maxStackTraceLinesPerThread){c(i.DEBUG,"record_error, Error stack is too long will be truncated");var U=A.split(`
`);U.length>h.maxStackTraceLinesPerThread&&(U=U.splice(0,h.maxStackTraceLinesPerThread));for(var I=0,N=U.length;I<N;I++)U[I].length>h.maxStackTraceLineLength&&(U[I]=U[I].substring(0,h.maxStackTraceLineLength));A=U.join(`
`)}l=!!l;var b=Jt(),V={_resolution:b._resolution,_error:A,_app_version:b._app_version,_run:T()-Ee};V._not_os_specific=!0,V._javascript=!0;var j=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;j&&(V._bat=Math.floor(j.level*100)),typeof navigator.onLine<"u"&&(V._online=!!navigator.onLine),V._background=!document.hasFocus(),Ue.length>0&&(V._logs=Ue.join(`
`)),Ue=[],V._nonfatal=l,V._view=this.getViewName(),typeof y<"u"&&(y=te(y,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"record_error",c),V._custom=y);try{var Q=document.createElement("canvas"),ge=Q.getContext("experimental-webgl");V._opengl=ge.getParameter(ge.VERSION)}catch(Ye){c(i.ERROR,"Could not get the experimental-webgl context: "+Ye)}var ye={};ye.crash=JSON.stringify(V),ye.metrics=JSON.stringify({_ua:b._ua}),Ce(ye)}};function on(){h.ignore_prefetch&&typeof document.visibilityState<"u"&&document.visibilityState==="prerender"&&(h.ignore_visitor=!0),h.ignore_bots&&ae()&&(h.ignore_visitor=!0)}function ki(){ve.length>0&&(Ce({events:JSON.stringify(ve)}),ve=[],ie("cly_event",ve))}function Ri(o,l){var y=!!document.getElementById("countly-feedback-sticker-"+o._id);if(y){c(i.ERROR,"Widget with same ID exists");return}try{var A=document.createElement("div");A.className="countly-iframe-wrapper",A.id="countly-iframe-wrapper-"+o._id;var U=document.createElement("span");U.className="countly-feedback-close-icon",U.id="countly-feedback-close-icon-"+o._id,U.innerText="x";var I=document.createElement("iframe");if(I.name="countly-feedback-iframe",I.id="countly-feedback-iframe",I.src=h.url+"/feedback?widget_id="+o._id+"&app_key="+h.app_key+"&device_id="+h.device_id+"&sdk_version="+R,document.body.appendChild(A),A.appendChild(U),A.appendChild(I),k(document.getElementById("countly-feedback-close-icon-"+o._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+o._id).style.display="none",document.getElementById("cfbg").style.display="none"}),l){var N=document.createElementNS("http://www.w3.org/2000/svg","svg");N.id="feedback-sticker-svg",N.setAttribute("aria-hidden","true"),N.setAttribute("data-prefix","far"),N.setAttribute("data-icon","grin"),N.setAttribute("class","svg-inline--fa fa-grin fa-w-16"),N.setAttribute("role","img"),N.setAttribute("xmlns","http://www.w3.org/2000/svg"),N.setAttribute("viewBox","0 0 496 512");var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.id="smileyPathInStickerSvg",b.setAttribute("fill","white"),b.setAttribute("d","M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.9-3.1-19.4 5.4-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32z");var V=document.createElement("span");V.innerText=o.trigger_button_text;var j=document.createElement("div");j.style.color=o.trigger_font_color.length<7?"#"+o.trigger_font_color:o.trigger_font_color,j.style.backgroundColor=o.trigger_bg_color.length<7?"#"+o.trigger_bg_color:o.trigger_bg_color,j.className="countly-feedback-sticker  "+o.trigger_position+"-"+o.trigger_size,j.id="countly-feedback-sticker-"+o._id,N.appendChild(b),j.appendChild(N),j.appendChild(V),document.body.appendChild(j);var Q=document.getElementById("smileyPathInStickerSvg");Q&&(Q.style.fill=o.trigger_font_color.length<7?"#"+o.trigger_font_color:o.trigger_font_color),k(document.getElementById("countly-feedback-sticker-"+o._id),"click",function(){document.getElementById("countly-iframe-wrapper-"+o._id).style.display="block",document.getElementById("cfbg").style.display="block"})}else document.getElementById("countly-iframe-wrapper-"+o._id).style.display="block",document.getElementById("cfbg").style.display="block"}catch(ge){c(i.ERROR,"Somethings went wrong while element injecting process: "+ge)}}function sn(){var o;if(typeof h.onload<"u"&&h.onload.length>0){for(o=0;o<h.onload.length;o++)typeof h.onload[o]=="function"&&h.onload[o](h);h.onload=[]}}function Si(){if(Le){var o={name:Le};h.check_consent(t.VIEWS)&&Je({key:r.VIEW,dur:se?T()-Be:ot,segmentation:o}),Le=null}}function rr(){return Le}function an(){if(w){var o=he("cly_session");(!o||parseInt(o)<=T())&&(X=!1,h.begin_session(!mt)),ie("cly_session",T()+x*60)}}function Ii(o){o.app_key=h.app_key,o.device_id=h.device_id,o.sdk_name=f,o.sdk_version=R,o.t=Ie,h.check_consent(t.LOCATION)?(h.country_code&&(o.country_code=h.country_code),h.city&&(o.city=h.city),h.ip_address!==null&&(o.ip_address=h.ip_address)):o.location="",o.timestamp=S();var l=new Date;o.hour=l.getHours(),o.dow=l.getDay()}function Ce(o){if(h.ignore_visitor){c(i.WARNING,"User is opt_out will ignore the request: "+o);return}if(!h.app_key||!h.device_id){c(i.ERROR,"app_key or device_id is missing ",h.app_key,h.device_id);return}Ii(o),pe.length>Pe&&pe.shift(),pe.push(o),ie("cly_queue",pe,!0)}function Kt(){if(sn(),h.ignore_visitor){ue=!1,c(i.WARNING,"User opt_out, no heartbeat");return}ue=!0;var o=0;if(J&&typeof e.q<"u"&&e.q.length>0){var l,y=e.q;for(e.q=[],o=0;o<y.length;o++)if(l=y[o],c(i.DEBUG,"Processing queued call",l),typeof l=="function")l();else if(Array.isArray(l)&&l.length>0){var A=h,U=0;if(e.i[l[U]]&&(A=e.i[l[U]],U++),typeof A[l[U]]=="function")A[l[U]].apply(A,l.slice(U+1));else if(l[U].indexOf("userData.")===0){var I=l[U].replace("userData.","");typeof A.userData[I]=="function"&&A.userData[I].apply(A,l.slice(U+1))}else typeof e[l[U]]=="function"&&e[l[U]].apply(e,l.slice(U+1))}}if(X&&mt&&se){var N=T();N-rt>s&&(h.session_duration(N-rt),rt=N)}if(ve.length>0){if(ve.length<=a)Ce({events:JSON.stringify(ve)}),ve=[];else{var b=ve.splice(0,a);Ce({events:JSON.stringify(b)})}ie("cly_event",ve)}if(!ne&&pe.length>0&&L&&T()>Ct){L=!1;var V=pe[0];c(i.DEBUG,"Processing request",V),ie("cly_queue",pe,!0),h.test_mode||ct("send_request_queue",h.url+we,V,function(j,Q){c(i.DEBUG,"Request Finished",Q,j),j?(Ct=T()+Me,c(i.ERROR,"Request error: ",j)):pe.shift(),ie("cly_queue",pe,!0),L=!0},!1)}setTimeout(Kt,xe)}function Ai(){var o=he("cly_id");return o?(Ie=he("cly_id_type"),o):C()}function or(o){return/[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-4[0-9a-fA-F]{3}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}/.test(o)}function Jt(){var o=JSON.parse(JSON.stringify(h.metrics||{}));if(o._app_version=o._app_version||h.app_version,o._ua=o._ua||Oe(),screen.width){var l=screen.width?parseInt(screen.width):0,y=screen.height?parseInt(screen.height):0;if(l!==0&&y!==0){var A=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);if(A&&window.devicePixelRatio)l=Math.round(l*window.devicePixelRatio),y=Math.round(y*window.devicePixelRatio);else if(Math.abs(window.orientation)===90){var U=l;l=y,y=U}o._resolution=o._resolution||""+l+"x"+y}}window.devicePixelRatio&&(o._density=o._density||window.devicePixelRatio);var I=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;if(typeof I<"u"&&(o._locale=o._locale||I),typeof document.referrer<"u"&&document.referrer.length){var N=E.exec(document.referrer);if(N&&N[11]&&N[11]!==window.location.hostname){var b=!1;if($e&&$e.length)for(var V=0;V<$e.length;V++)try{var j=new RegExp($e[V]);if(j.test(document.referrer)){c(i.DEBUG,"Ignored: "+document.referrer),b=!0;break}}catch(Q){c(i.ERROR,"Problem with ignoring: "+$e[V],", error: "+Q)}b||(o._store=o._store||document.referrer)}}return c(i.DEBUG,"Got metrics",o),o}function c(o,l){if(h.debug&&typeof console<"u"){arguments[2]&&typeof arguments[2]=="object"&&(arguments[2]=JSON.stringify(arguments[2])),J||(l="["+h.app_key+"] "+l),o||(o=i.DEBUG);for(var y="",A=2;A<arguments.length;A++)y+=arguments[A];var U=o+l+y;o===i.ERROR?console.error(U):o===i.WARNING?console.warn(U):o===i.INFO?console.info(U):o===i.VERBOSE?console.log(U):console.debug(U)}}function ct(o,l,y,A,U){U=U||!1;try{c(i.DEBUG,"Sending XML HTTP request");var I=null;window.XMLHttpRequest?I=new window.XMLHttpRequest:window.ActiveXObject&&(I=new window.ActiveXObject("Microsoft.XMLHTTP")),y=y||{};var N=q(y),b="GET";(h.force_post||N.length>=2e3)&&(b="POST"),b==="GET"?I.open("GET",l+"?"+N,!0):(I.open("POST",l,!0),I.setRequestHeader("Content-type","application/x-www-form-urlencoded"));for(var V in h.headers)I.setRequestHeader(V,h.headers[V]);I.onreadystatechange=function(){if(this.readyState===4){c(i.DEBUG,o+" HTTP request completed ["+this.status+"]["+this.responseText+"]");var j;U?j=cn(this.status,this.responseText):j=fn(this.status,this.responseText),j?typeof A=="function"&&A(!1,y,this.responseText):(c(i.ERROR,o+" Failed Server XML HTTP request, ",this.status),typeof A=="function"&&A(!0,y))}},b==="GET"?I.send():I.send(N)}catch(j){c(i.ERROR,o+" Failed XML HTTP request: "+j),typeof A=="function"&&A(!0,y)}}function fn(o,l){if(!(o>=200&&o<300))return c(i.ERROR,"Http response status code is not within the expected range:["+o+"]"),!1;try{var y=JSON.parse(l);return Object.prototype.toString.call(y)!=="[object Object]"?(c(i.ERROR,"Http response is not JSON Object"),!1):!!y.result}catch(A){return c(i.ERROR,"Http response is not JSON: "+A),!1}}function cn(o,l){if(!(o>=200&&o<300))return c(i.ERROR,"Http response status code is not within the expected range: "+o),!1;try{var y=JSON.parse(l);return Object.prototype.toString.call(y)!=="[object Object]"&&!Array.isArray(y)?(c(i.ERROR,"Http response is not JSON Object nor JSON Array"),!1):!0}catch(A){return c(i.ERROR,"Http response is not JSON: "+A),!1}}function ln(){Mt=Math.max(Mt,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)}function Oi(){if(Pt){Pt=!1;var o=Ae(),l=d(),y=v();if(h.check_consent(t.SCROLLS)){var A={type:"scroll",y:Mt+y,width:l,height:o,view:h.getViewUrl()};A=te(A,h.maxKeyLength,h.maxValueSize,h.maxSegmentationValues,"processScrollView",c),h.track_domains&&(A.domain=window.location.hostname),Je({key:r.ACTION,segmentation:A})}}}function sr(){return Ie}function un(o){ie("cly_token",o)}function ar(){var o=he("cly_token");return tt("cly_token"),o}function fr(){return ve}function cr(){return pe}function lr(o){for(var l=o+"=",y=document.cookie.split(";"),A=0,U=y.length;A<U;A++){for(var I=y[A];I.charAt(0)===" ";)I=I.substring(1,I.length);if(I.indexOf(l)===0)return I.substring(l.length,I.length)}return null}function hn(o,l,y){var A=new Date;A.setTime(A.getTime()+y*24*60*60*1e3);var U="; expires="+A.toGMTString();document.cookie=o+"="+l+U+"; path=/"}function he(o,l,y){if(h.storage==="none"){c(i.WARNING,"Storage is disabled. Value with key: "+o+" won't be retrieved");return}y||(o=h.app_key+"/"+o,h.namespace&&(o=z(h.namespace)+"/"+o)),l===void 0&&(l=wt);var A;return l?A=localStorage.getItem(o):h.storage!=="localstorage"&&(A=lr(o)),h.deserialize(A)}function ie(o,l,y,A){if(h.storage==="none"){c(i.WARNING,"Storage is disabled. Value with key: "+o+" won't be stored");return}A||(o=h.app_key+"/"+o,h.namespace&&(o=z(h.namespace)+"/"+o)),y===void 0&&(y=wt),typeof l<"u"&&l!==null&&(l=h.serialize(l),y?localStorage.setItem(o,l):h.storage!=="localstorage"&&hn(o,l,30))}function tt(o,l,y){if(h.storage==="none"){c(i.WARNING,"Storage is disabled. Value with key: "+o+" won't be removed");return}y||(o=h.app_key+"/"+o,h.namespace&&(o=z(h.namespace)+"/"+o)),l===void 0&&(l=wt),l?localStorage.removeItem(o):h.storage!=="localstorage"&&hn(o,"",-1)}function ur(){if(he(h.namespace+"cly_id",!1,!0)){ie("cly_id",he(h.namespace+"cly_id",!1,!0)),ie("cly_id_type",he(h.namespace+"cly_id_type",!1,!0)),ie("cly_event",he(h.namespace+"cly_event",!1,!0)),ie("cly_session",he(h.namespace+"cly_session",!1,!0));var o=he(h.namespace+"cly_queue",!1,!0);Array.isArray(o)&&(o=o.filter(function(l){return l.app_key===h.app_key}),ie("cly_queue",o)),he(h.namespace+"cly_cmp_id",!1,!0)&&(ie("cly_cmp_id",he(h.namespace+"cly_cmp_id",!1,!0)),ie("cly_cmp_uid",he(h.namespace+"cly_cmp_uid",!1,!0))),he(h.namespace+"cly_ignore",!1,!0)&&ie("cly_ignore",he(h.namespace+"cly_ignore",!1,!0)),tt("cly_id",!1,!0),tt("cly_id_type",!1,!0),tt("cly_event",!1,!0),tt("cly_session",!1,!0),tt("cly_queue",!1,!0),tt("cly_cmp_id",!1,!0),tt("cly_cmp_uid",!1,!0),tt("cly_ignore",!1,!0)}}this.onStorageChange=function(o,l){switch(c(i.INFO,"onStorageChange, Applying storage changes"),o){case"cly_queue":pe=h.deserialize(l||"[]");break;case"cly_event":ve=h.deserialize(l||"[]");break;case"cly_remote_configs":be=h.deserialize(l||"{}");break;case"cly_ignore":h.ignore_visitor=h.deserialize(l);break;case"cly_id":h.device_id=h.deserialize(l);break;case"cly_id_type":Ie=h.deserialize(l);break;default:}},this._internals={store:ie,getDocWidth:d,getDocHeight:Ae,getViewportHeight:v,get_page_coord:ze,get_event_target:ce,add_event:k,createNewObjectFromProperties:Y,truncateObject:te,truncateSingleValue:$,stripTrailingSlash:z,prepareParams:q,sendXmlHttpRequest:ct,isResponseValid:fn,getInternalDeviceIdType:sr,getMsTimestamp:S,getTimestamp:T,isResponseValidBroad:cn,log:c,getMetrics:Jt,generateUUID:C,sendEventsForced:ki,isUUID:or,getId:Ai,heartBeat:Kt,toRequestQueue:Ce,reportViewDuration:Si,loadJS:ee,loadCSS:H,getLastView:rr,setToken:un,getToken:ar,showLoader:le,hideLoader:me,setValueInStorage:ie,getValueFromStorage:he,removeValueFromStorage:tt,add_cly_events:Je,processScrollView:Oi,processScroll:ln,currentUserAgentString:Oe,userAgentDeviceDetection:Ge,userAgentSearchBotDetection:ae,getRequestQueue:cr,getEventQueue:fr,clearQueue:function(){pe=[],ie("cly_queue",[]),ve=[],ie("cly_event",[])}},this.initialize()};e.CountlyClass=B,e.init=function(g){g=g||{};var h=g.app_key||e.app_key;if(!e.i||!e.i[h]){var J=new e.CountlyClass(g);if(!e.i){e.i={};for(var X in J)e[X]=J[X]}e.i[h]=J}return e.i[h]};function O(g){var h=[];if(typeof g.options<"u")for(var J=0;J<g.options.length;J++)g.options[J].selected&&h.push(g.options[J].value);return h.join(", ")}function C(){var g=new Date().getTime(),h="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(J){var X=(g+Math.random()*16)%16|0;return g=Math.floor(g/16),(J==="x"?X:X&3|8).toString(16)});return h}function T(){return Math.floor(new Date().getTime()/1e3)}var W=0;function S(){var g=new Date().getTime();return W>=g?W++:W=g,W}function _(g,h,J){if(h&&Object.keys(h).length){if(typeof h[g]<"u")return h[g]}else if(typeof e[g]<"u")return e[g];return J}function M(g,h,J){for(var X in e.i)e.i[X].tracking_crashes&&e.i[X].recordError(g,h,J)}function q(g){var h=[];for(var J in g)h.push(J+"="+encodeURIComponent(g[J]));return h.join("&")}function z(g){return typeof g=="string"&&g.substring(g.length-1)==="/"?g.substring(0,g.length-1):g}function Y(g,h){for(var J={},X,we=0,Se=h.length;we<Se;we++)X=h[we],typeof g[X]<"u"&&(J[X]=g[X]);return J}function F(g,h,J){if(!!J){for(var X,we=0,Se=J.length;we<Se;we++)X=J[we],typeof h[X]<"u"&&(g[X]=h[X]);return g}}function te(g,h,J,X,we,Se){var xe={};if(g){if(Object.keys(g).length>X){var Pe={},pe=0;for(var ve in g)pe<X&&(Pe[ve]=g[ve],pe++);g=Pe}for(var be in g){var Ue=$(be,h,we,Se),Ke=$(g[be],J,we,Se);xe[Ue]=Ke}}return xe}function $(g,h,J,X){var we=g;return typeof g=="number"&&(g=g.toString()),typeof g=="string"&&g.length>h&&(we=g.substring(0,h),X(i.DEBUG,J+", Key: [ "+g+" ] is longer than accepted length. It will be truncated.")),we}var ke=function(g,h){for(h=h.toUpperCase();g;){if(g.nodeName.toUpperCase()===h)return g;g=g.parentElement}},k=function(g,h,J){typeof g.addEventListener<"u"?g.addEventListener(h,J,!1):g.attachEvent("on"+h,J)},ce=function(g){return g?typeof g.target<"u"?g.target:g.srcElement:window.event.srcElement};function Oe(g){if(g)return g;var h=navigator.userAgent;return h||navigator.userAgentData&&(h=navigator.userAgentData.brands.map(function(J){return J.brand+":"+J.version}).join(),h+=navigator.userAgentData.mobile?" mobi ":" ",h+=navigator.userAgentData.platform),h}function Ge(g){var h;if(g)h=g;else{if(navigator.userAgentData.mobile)return"phone";h=Oe()}h=h.toLowerCase();var J="desktop",X=/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/,we=/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/;return X.test(h)?J="tablet":we.test(h)&&(J="phone"),J}function ae(g){var h=/(CountlySiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome)/;return h.test(g||Oe())}function ze(g){return typeof g.pageY>"u"&&typeof g.clientX=="number"&&document.documentElement&&(g.pageX=g.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,g.pageY=g.clientY+document.body.scrollTop+document.documentElement.scrollTop),g}function Ae(){var g=document;return Math.max(Math.max(g.body.scrollHeight,g.documentElement.scrollHeight),Math.max(g.body.offsetHeight,g.documentElement.offsetHeight),Math.max(g.body.clientHeight,g.documentElement.clientHeight))}function d(){var g=document;return Math.max(Math.max(g.body.scrollWidth,g.documentElement.scrollWidth),Math.max(g.body.offsetWidth,g.documentElement.offsetWidth),Math.max(g.body.clientWidth,g.documentElement.clientWidth))}function v(){var g=document;return Math.min(Math.min(g.body.clientHeight,g.documentElement.clientHeight),Math.min(g.body.offsetHeight,g.documentElement.offsetHeight),window.innerHeight)}function P(){return window.innerWidth>window.innerHeight?"landscape":"portrait"}window.addEventListener("storage",function(g){var h=(g.key+"").split("/"),J=h.pop(),X=h.pop();e.i&&e.i[X]&&e.i[X].onStorageChange(J,g.newValue)});function Z(g,h,J,X,we,Se){var xe=document.createElement(g),Pe;xe.setAttribute(h,J),xe.setAttribute(X,we);var pe=function(){Pe||Se(),Pe=!0};Se&&(xe.onreadystatechange=pe,xe.onload=pe),document.getElementsByTagName("head")[0].appendChild(xe)}function ee(g,h){Z("script","type","text/javascript","src",g,h)}function H(g,h){Z("link","rel","stylesheet","href",g,h)}function le(){var g=document.getElementById("cly-loader");if(!g){var h="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}",J=document.head||document.getElementsByTagName("head")[0],X=document.createElement("style");X.type="text/css",X.styleSheet?X.styleSheet.cssText=h:X.appendChild(document.createTextNode(h)),J.appendChild(X),g=document.createElement("div"),g.setAttribute("id","cly-loader"),document.body.onload=function(){if(!e.showLoaderProtection)try{document.body.appendChild(g)}catch{}}}g.style.display="block"}function me(){e.showLoaderProtection=!0;var g=document.getElementById("cly-loader");g&&(g.style.display="none")}return e.serialize=function(g){return typeof g=="object"&&(g=JSON.stringify(g)),g},e.deserialize=function(g){try{g=JSON.parse(g)}catch{}return g},e.getViewName=function(){return window.location.pathname},e.getViewUrl=function(){return window.location.pathname},e.getSearchQuery=function(){return window.location.search},e.DeviceIdType={DEVELOPER_SUPPLIED:u.DEVELOPER_SUPPLIED,SDK_GENERATED:u.SDK_GENERATED,TEMPORARY_ID:u.TEMPORARY_ID},e})});function _r(){var e=Object.create(null);e.ftp=21,e.file=0,e.gopher=70,e.http=80,e.https=443,e.ws=80,e.wss=443;var t=Object.create(null);t["%2e"]=".",t[".%2e"]="..",t["%2e."]="..",t["%2e%2e"]="..";function r(S){return e[S]!==void 0}function i(){C.call(this),this._isInvalid=!0}function u(S){return S==""&&i.call(this),S.toLowerCase()}function p(S){var _=S.charCodeAt(0);return _>32&&_<127&&[34,35,60,62,63,96].indexOf(_)==-1?S:encodeURIComponent(S)}function R(S){var _=S.charCodeAt(0);return _>32&&_<127&&[34,35,60,62,96].indexOf(_)==-1?S:encodeURIComponent(S)}var f=void 0,E=/[a-zA-Z]/,B=/[a-zA-Z0-9\+\-\.]/;function O(S,_,M){function q(v){ke.push(v)}var z=_||"scheme start",Y=0,F="",te=!1,$=!1,ke=[];e:for(;(S[Y-1]!=f||Y==0)&&!this._isInvalid;){var k=S[Y];switch(z){case"scheme start":if(k&&E.test(k))F+=k.toLowerCase(),z="scheme";else if(_){q("Invalid scheme.");break e}else{F="",z="no scheme";continue}break;case"scheme":if(k&&B.test(k))F+=k.toLowerCase();else if(k==":"){if(this._scheme=F,F="",_)break e;r(this._scheme)&&(this._isRelative=!0),this._scheme=="file"?z="relative":this._isRelative&&M&&M._scheme==this._scheme?z="relative or authority":this._isRelative?z="authority first slash":z="scheme data"}else if(_){if(f==k)break e;q("Code point not allowed in scheme: "+k);break e}else{F="",Y=0,z="no scheme";continue}break;case"scheme data":k=="?"?(this._query="?",z="query"):k=="#"?(this._fragment="#",z="fragment"):f!=k&&k!="	"&&k!=`
`&&k!="\r"&&(this._schemeData+=p(k));break;case"no scheme":if(!M||!r(M._scheme))q("Missing scheme."),i.call(this);else{z="relative";continue}break;case"relative or authority":if(k=="/"&&S[Y+1]=="/")z="authority ignore slashes";else{q("Expected /, got: "+k),z="relative";continue}break;case"relative":if(this._isRelative=!0,this._scheme!="file"&&(this._scheme=M._scheme),f==k){this._host=M._host,this._port=M._port,this._path=M._path.slice(),this._query=M._query,this._username=M._username,this._password=M._password;break e}else if(k=="/"||k=="\\")k=="\\"&&q("\\ is an invalid code point."),z="relative slash";else if(k=="?")this._host=M._host,this._port=M._port,this._path=M._path.slice(),this._query="?",this._username=M._username,this._password=M._password,z="query";else if(k=="#")this._host=M._host,this._port=M._port,this._path=M._path.slice(),this._query=M._query,this._fragment="#",this._username=M._username,this._password=M._password,z="fragment";else{var ce=S[Y+1],Oe=S[Y+2];(this._scheme!="file"||!E.test(k)||ce!=":"&&ce!="|"||f!=Oe&&Oe!="/"&&Oe!="\\"&&Oe!="?"&&Oe!="#")&&(this._host=M._host,this._port=M._port,this._username=M._username,this._password=M._password,this._path=M._path.slice(),this._path.pop()),z="relative path";continue}break;case"relative slash":if(k=="/"||k=="\\")k=="\\"&&q("\\ is an invalid code point."),this._scheme=="file"?z="file host":z="authority ignore slashes";else{this._scheme!="file"&&(this._host=M._host,this._port=M._port,this._username=M._username,this._password=M._password),z="relative path";continue}break;case"authority first slash":if(k=="/")z="authority second slash";else{q("Expected '/', got: "+k),z="authority ignore slashes";continue}break;case"authority second slash":if(z="authority ignore slashes",k!="/"){q("Expected '/', got: "+k);continue}break;case"authority ignore slashes":if(k!="/"&&k!="\\"){z="authority";continue}else q("Expected authority, got: "+k);break;case"authority":if(k=="@"){te&&(q("@ already seen."),F+="%40"),te=!0;for(var Ge=0;Ge<F.length;Ge++){var ae=F[Ge];if(ae=="	"||ae==`
`||ae=="\r"){q("Invalid whitespace in authority.");continue}if(ae==":"&&this._password===null){this._password="";continue}var ze=p(ae);this._password!==null?this._password+=ze:this._username+=ze}F=""}else if(f==k||k=="/"||k=="\\"||k=="?"||k=="#"){Y-=F.length,F="",z="host";continue}else F+=k;break;case"file host":if(f==k||k=="/"||k=="\\"||k=="?"||k=="#"){F.length==2&&E.test(F[0])&&(F[1]==":"||F[1]=="|")?z="relative path":(F.length==0||(this._host=u.call(this,F),F=""),z="relative path start");continue}else k=="	"||k==`
`||k=="\r"?q("Invalid whitespace in file host."):F+=k;break;case"host":case"hostname":if(k==":"&&!$){if(this._host=u.call(this,F),F="",z="port",_=="hostname")break e}else if(f==k||k=="/"||k=="\\"||k=="?"||k=="#"){if(this._host=u.call(this,F),F="",z="relative path start",_)break e;continue}else k!="	"&&k!=`
`&&k!="\r"?(k=="["?$=!0:k=="]"&&($=!1),F+=k):q("Invalid code point in host/hostname: "+k);break;case"port":if(/[0-9]/.test(k))F+=k;else if(f==k||k=="/"||k=="\\"||k=="?"||k=="#"||_){if(F!=""){var Ae=parseInt(F,10);Ae!=e[this._scheme]&&(this._port=Ae+""),F=""}if(_)break e;z="relative path start";continue}else k=="	"||k==`
`||k=="\r"?q("Invalid code point in port: "+k):i.call(this);break;case"relative path start":if(k=="\\"&&q("'\\' not allowed in path."),z="relative path",k!="/"&&k!="\\")continue;break;case"relative path":if(f==k||k=="/"||k=="\\"||!_&&(k=="?"||k=="#")){k=="\\"&&q("\\ not allowed in relative path.");var d;(d=t[F.toLowerCase()])&&(F=d),F==".."?(this._path.pop(),k!="/"&&k!="\\"&&this._path.push("")):F=="."&&k!="/"&&k!="\\"?this._path.push(""):F!="."&&(this._scheme=="file"&&this._path.length==0&&F.length==2&&E.test(F[0])&&F[1]=="|"&&(F=F[0]+":"),this._path.push(F)),F="",k=="?"?(this._query="?",z="query"):k=="#"&&(this._fragment="#",z="fragment")}else k!="	"&&k!=`
`&&k!="\r"&&(F+=p(k));break;case"query":!_&&k=="#"?(this._fragment="#",z="fragment"):f!=k&&k!="	"&&k!=`
`&&k!="\r"&&(this._query+=R(k));break;case"fragment":f!=k&&k!="	"&&k!=`
`&&k!="\r"&&(this._fragment+=k);break}Y++}}function C(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function T(S,_){_!==void 0&&!(_ instanceof T)&&(_=new T(String(_))),S=String(S),this._url=S,C.call(this);var M=S.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");O.call(this,M,null,_)}T.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var S="";return(this._username!=""||this._password!=null)&&(S=this._username+(this._password!=null?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+S+this.host:"")+this.pathname+this._query+this._fragment},set href(S){C.call(this),O.call(this,S)},get protocol(){return this._scheme+":"},set protocol(S){this._isInvalid||O.call(this,S+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(S){this._isInvalid||!this._isRelative||O.call(this,S,"host")},get hostname(){return this._host},set hostname(S){this._isInvalid||!this._isRelative||O.call(this,S,"hostname")},get port(){return this._port},set port(S){this._isInvalid||!this._isRelative||O.call(this,S,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(S){this._isInvalid||!this._isRelative||(this._path=[],O.call(this,S,"relative path start"))},get search(){return this._isInvalid||!this._query||this._query=="?"?"":this._query},set search(S){this._isInvalid||!this._isRelative||(this._query="?",S[0]=="?"&&(S=S.slice(1)),O.call(this,S,"query"))},get hash(){return this._isInvalid||!this._fragment||this._fragment=="#"?"":this._fragment},set hash(S){this._isInvalid||(this._fragment="#",S[0]=="#"&&(S=S.slice(1)),O.call(this,S,"fragment"))},get origin(){var S;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return S=this.host,S?this._scheme+"://"+S:""}};var W=self.URL;return W&&(T.createObjectURL=function(S){return W.createObjectURL.apply(W,arguments)},T.revokeObjectURL=function(S){W.revokeObjectURL(S)}),T}var Xe=_r();var _n=Xt(Qt());var Qe=class{constructor(t="div",r=void 0,i="\u{1F551}"){let u=document.createElement(t);this.element=u,r!=null&&(this.className=r),this.textContent=i}static fromElement(t){let r=new Qe("div");return r.element=t,r}asterisk(){this.textContent="*"}lose(){this.textContent="\u274C"}win(t){if(t!=null){this.textContent="";let r=document.createElement("a");r.href=t,r.target="_blank",r.textContent="\u2705",this.element.title=t,this.element.appendChild(r)}else this.textContent="\u2705"}global(){this.textContent="\u{1F30D}"}err(){this.textContent="\u26A0\uFE0F"}empty(){this.textContent=""}get style(){return this.element.style}append(t){return t instanceof Qe&&(t=t.element),this.element.append(t)}get classList(){return this.element.classList}set title(t){this.element.title=t}set className(t){this.element.className=t}set textContent(t){this.element.textContent=t}};var je=class{constructor(t,...r){this.parent=t;this.tag=new Qe(...r)}};var lt=class extends je{constructor(r,...i){super(r,...i);this.parent=r;this._className="Not-set";this._tagName="Not-set"}get className(){return this._className}get tagName(){return this._tagName}check(){}checked(){}onerror(){this.tag.err()}};var mn="Hello from IPFS Gateway Checker",at="bafybeifx7yeb55armcsxwwitkymga5xf53dxiarykms3ygqic223w5sk3m",ut="bafybeibwzifw52ttrkqlikfzext5akxu7lz4xiwjgwzmqcpdzmp3n5vnbe",yn="/ipns/en.wikipedia-on-ipfs.org/favicon.ico",Ti=["raw","car"],wn="https://ipfs.io";var Re=class{constructor(t){this.namespace=t}log(t,...r){let[i,...u]=r,p=this.namespace!=null?`${this.namespace}.${t}: `:"";console[t](`${p}${i}`,...u)}debug(...t){this.log("debug",...t)}info(...t){this.log("info",...t)}warn(...t){this.log("warn",...t)}error(...t){this.log("error",...t)}};var{fetch:vr}=(0,_n.default)(),Ni=new Re("Cors"),Zt=class extends lt{constructor(r){super(r,"div","Cors");this.parent=r;this._className="Cors";this._tagName="div"}async check(){let r=Date.now(),u=`${this.parent.gateway.replace(":hash",at)}?now=${r}#x-ipfs-companion-no-redirect`;try{let p=await vr(u),{status:R}=p,f=await p.text();if(this.tag.title=`Response code: ${R}`,mn===f.trim())this.tag.asterisk(),this.parent.tag.classList.add("cors");else throw Ni.debug("The response text did not match the expected string"),this.onerror(),new Error(`URL '${u} does not support CORS`)}catch(p){throw Ni.error(p),this.onerror(),p}}checked(){Ni.warn("Not implemented yet")}onerror(){this.tag.empty()}};var br=Object.create,An=Object.defineProperty,Er=Object.getOwnPropertyDescriptor,kr=Object.getOwnPropertyNames,Rr=Object.getPrototypeOf,Sr=Object.prototype.hasOwnProperty,xt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ir=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of kr(t))!Sr.call(e,u)&&u!==r&&An(e,u,{get:()=>t[u],enumerable:!(i=Er(t,u))||i.enumerable});return e},On=(e,t,r)=>(r=e!=null?br(Rr(e)):{},Ir(t||!e||!e.__esModule?An(r,"default",{value:e,enumerable:!0}):r,e)),Ar=xt(e=>{"use strict";e.byteLength=E,e.toByteArray=O,e.fromByteArray=W;var t=[],r=[],i=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(p=0,R=u.length;p<R;++p)t[p]=u[p],r[u.charCodeAt(p)]=p;var p,R;r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63;function f(S){var _=S.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var M=S.indexOf("=");M===-1&&(M=_);var q=M===_?0:4-M%4;return[M,q]}function E(S){var _=f(S),M=_[0],q=_[1];return(M+q)*3/4-q}function B(S,_,M){return(_+M)*3/4-M}function O(S){var _,M=f(S),q=M[0],z=M[1],Y=new i(B(S,q,z)),F=0,te=z>0?q-4:q,$;for($=0;$<te;$+=4)_=r[S.charCodeAt($)]<<18|r[S.charCodeAt($+1)]<<12|r[S.charCodeAt($+2)]<<6|r[S.charCodeAt($+3)],Y[F++]=_>>16&255,Y[F++]=_>>8&255,Y[F++]=_&255;return z===2&&(_=r[S.charCodeAt($)]<<2|r[S.charCodeAt($+1)]>>4,Y[F++]=_&255),z===1&&(_=r[S.charCodeAt($)]<<10|r[S.charCodeAt($+1)]<<4|r[S.charCodeAt($+2)]>>2,Y[F++]=_>>8&255,Y[F++]=_&255),Y}function C(S){return t[S>>18&63]+t[S>>12&63]+t[S>>6&63]+t[S&63]}function T(S,_,M){for(var q,z=[],Y=_;Y<M;Y+=3)q=(S[Y]<<16&16711680)+(S[Y+1]<<8&65280)+(S[Y+2]&255),z.push(C(q));return z.join("")}function W(S){for(var _,M=S.length,q=M%3,z=[],Y=16383,F=0,te=M-q;F<te;F+=Y)z.push(T(S,F,F+Y>te?te:F+Y));return q===1?(_=S[M-1],z.push(t[_>>2]+t[_<<4&63]+"==")):q===2&&(_=(S[M-2]<<8)+S[M-1],z.push(t[_>>10]+t[_>>4&63]+t[_<<2&63]+"=")),z.join("")}}),Or=xt(e=>{e.read=function(t,r,i,u,p){var R,f,E=p*8-u-1,B=(1<<E)-1,O=B>>1,C=-7,T=i?p-1:0,W=i?-1:1,S=t[r+T];for(T+=W,R=S&(1<<-C)-1,S>>=-C,C+=E;C>0;R=R*256+t[r+T],T+=W,C-=8);for(f=R&(1<<-C)-1,R>>=-C,C+=u;C>0;f=f*256+t[r+T],T+=W,C-=8);if(R===0)R=1-O;else{if(R===B)return f?NaN:(S?-1:1)*(1/0);f=f+Math.pow(2,u),R=R-O}return(S?-1:1)*f*Math.pow(2,R-u)},e.write=function(t,r,i,u,p,R){var f,E,B,O=R*8-p-1,C=(1<<O)-1,T=C>>1,W=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=u?0:R-1,_=u?1:-1,M=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(E=isNaN(r)?1:0,f=C):(f=Math.floor(Math.log(r)/Math.LN2),r*(B=Math.pow(2,-f))<1&&(f--,B*=2),f+T>=1?r+=W/B:r+=W*Math.pow(2,1-T),r*B>=2&&(f++,B/=2),f+T>=C?(E=0,f=C):f+T>=1?(E=(r*B-1)*Math.pow(2,p),f=f+T):(E=r*Math.pow(2,T-1)*Math.pow(2,p),f=0));p>=8;t[i+S]=E&255,S+=_,E/=256,p-=8);for(f=f<<p|E,O+=p;O>0;t[i+S]=f&255,S+=_,f/=256,O-=8);t[i+S-_]|=M*128}}),xr=xt(e=>{"use strict";var t=Ar(),r=Or(),i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=f,e.SlowBuffer=z,e.INSPECT_MAX_BYTES=50;var u=2147483647;e.kMaxLength=u,f.TYPED_ARRAY_SUPPORT=p(),!f.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function p(){try{let n=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(n,s),n.foo()===42}catch{return!1}}Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}});function R(n){if(n>u)throw new RangeError('The value "'+n+'" is invalid for option "size"');let s=new Uint8Array(n);return Object.setPrototypeOf(s,f.prototype),s}function f(n,s,a){if(typeof n=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return C(n)}return E(n,s,a)}f.poolSize=8192;function E(n,s,a){if(typeof n=="string")return T(n,s);if(ArrayBuffer.isView(n))return S(n);if(n==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(Be(n,ArrayBuffer)||n&&Be(n.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Be(n,SharedArrayBuffer)||n&&Be(n.buffer,SharedArrayBuffer)))return _(n,s,a);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let m=n.valueOf&&n.valueOf();if(m!=null&&m!==n)return f.from(m,s,a);let w=M(n);if(w)return w;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return f.from(n[Symbol.toPrimitive]("string"),s,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}f.from=function(n,s,a){return E(n,s,a)},Object.setPrototypeOf(f.prototype,Uint8Array.prototype),Object.setPrototypeOf(f,Uint8Array);function B(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(n<0)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function O(n,s,a){return B(n),n<=0?R(n):s!==void 0?typeof a=="string"?R(n).fill(s,a):R(n).fill(s):R(n)}f.alloc=function(n,s,a){return O(n,s,a)};function C(n){return B(n),R(n<0?0:q(n)|0)}f.allocUnsafe=function(n){return C(n)},f.allocUnsafeSlow=function(n){return C(n)};function T(n,s){if((typeof s!="string"||s==="")&&(s="utf8"),!f.isEncoding(s))throw new TypeError("Unknown encoding: "+s);let a=Y(n,s)|0,m=R(a),w=m.write(n,s);return w!==a&&(m=m.slice(0,w)),m}function W(n){let s=n.length<0?0:q(n.length)|0,a=R(s);for(let m=0;m<s;m+=1)a[m]=n[m]&255;return a}function S(n){if(Be(n,Uint8Array)){let s=new Uint8Array(n);return _(s.buffer,s.byteOffset,s.byteLength)}return W(n)}function _(n,s,a){if(s<0||n.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(n.byteLength<s+(a||0))throw new RangeError('"length" is outside of buffer bounds');let m;return s===void 0&&a===void 0?m=new Uint8Array(n):a===void 0?m=new Uint8Array(n,s):m=new Uint8Array(n,s,a),Object.setPrototypeOf(m,f.prototype),m}function M(n){if(f.isBuffer(n)){let s=q(n.length)|0,a=R(s);return a.length===0||n.copy(a,0,0,s),a}if(n.length!==void 0)return typeof n.length!="number"||ot(n.length)?R(0):W(n);if(n.type==="Buffer"&&Array.isArray(n.data))return W(n.data)}function q(n){if(n>=u)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u.toString(16)+" bytes");return n|0}function z(n){return+n!=n&&(n=0),f.alloc(+n)}f.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==f.prototype},f.compare=function(n,s){if(Be(n,Uint8Array)&&(n=f.from(n,n.offset,n.byteLength)),Be(s,Uint8Array)&&(s=f.from(s,s.offset,s.byteLength)),!f.isBuffer(n)||!f.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===s)return 0;let a=n.length,m=s.length;for(let w=0,x=Math.min(a,m);w<x;++w)if(n[w]!==s[w]){a=n[w],m=s[w];break}return a<m?-1:m<a?1:0},f.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(n,s){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return f.alloc(0);let a;if(s===void 0)for(s=0,a=0;a<n.length;++a)s+=n[a].length;let m=f.allocUnsafe(s),w=0;for(a=0;a<n.length;++a){let x=n[a];if(Be(x,Uint8Array))w+x.length>m.length?(f.isBuffer(x)||(x=f.from(x)),x.copy(m,w)):Uint8Array.prototype.set.call(m,x,w);else if(f.isBuffer(x))x.copy(m,w);else throw new TypeError('"list" argument must be an Array of Buffers');w+=x.length}return m};function Y(n,s){if(f.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||Be(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);let a=n.length,m=arguments.length>2&&arguments[2]===!0;if(!m&&a===0)return 0;let w=!1;for(;;)switch(s){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return gt(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a*2;case"hex":return a>>>1;case"base64":return At(n).length;default:if(w)return m?-1:gt(n).length;s=(""+s).toLowerCase(),w=!0}}f.byteLength=Y;function F(n,s,a){let m=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((a===void 0||a>this.length)&&(a=this.length),a<=0)||(a>>>=0,s>>>=0,a<=s))return"";for(n||(n="utf8");;)switch(n){case"hex":return ee(this,s,a);case"utf8":case"utf-8":return Ae(this,s,a);case"ascii":return P(this,s,a);case"latin1":case"binary":return Z(this,s,a);case"base64":return ze(this,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,s,a);default:if(m)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),m=!0}}f.prototype._isBuffer=!0;function te(n,s,a){let m=n[s];n[s]=n[a],n[a]=m}f.prototype.swap16=function(){let n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let s=0;s<n;s+=2)te(this,s,s+1);return this},f.prototype.swap32=function(){let n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let s=0;s<n;s+=4)te(this,s,s+3),te(this,s+1,s+2);return this},f.prototype.swap64=function(){let n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let s=0;s<n;s+=8)te(this,s,s+7),te(this,s+1,s+6),te(this,s+2,s+5),te(this,s+3,s+4);return this},f.prototype.toString=function(){let n=this.length;return n===0?"":arguments.length===0?Ae(this,0,n):F.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(n){if(!f.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:f.compare(this,n)===0},f.prototype.inspect=function(){let n="",s=e.INSPECT_MAX_BYTES;return n=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(n+=" ... "),"<Buffer "+n+">"},i&&(f.prototype[i]=f.prototype.inspect),f.prototype.compare=function(n,s,a,m,w){if(Be(n,Uint8Array)&&(n=f.from(n,n.offset,n.byteLength)),!f.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(s===void 0&&(s=0),a===void 0&&(a=n?n.length:0),m===void 0&&(m=0),w===void 0&&(w=this.length),s<0||a>n.length||m<0||w>this.length)throw new RangeError("out of range index");if(m>=w&&s>=a)return 0;if(m>=w)return-1;if(s>=a)return 1;if(s>>>=0,a>>>=0,m>>>=0,w>>>=0,this===n)return 0;let x=w-m,L=a-s,ue=Math.min(x,L),ne=this.slice(m,w),oe=n.slice(s,a);for(let se=0;se<ue;++se)if(ne[se]!==oe[se]){x=ne[se],L=oe[se];break}return x<L?-1:L<x?1:0};function $(n,s,a,m,w){if(n.length===0)return-1;if(typeof a=="string"?(m=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,ot(a)&&(a=w?0:n.length-1),a<0&&(a=n.length+a),a>=n.length){if(w)return-1;a=n.length-1}else if(a<0)if(w)a=0;else return-1;if(typeof s=="string"&&(s=f.from(s,m)),f.isBuffer(s))return s.length===0?-1:ke(n,s,a,m,w);if(typeof s=="number")return s=s&255,typeof Uint8Array.prototype.indexOf=="function"?w?Uint8Array.prototype.indexOf.call(n,s,a):Uint8Array.prototype.lastIndexOf.call(n,s,a):ke(n,[s],a,m,w);throw new TypeError("val must be string, number or Buffer")}function ke(n,s,a,m,w){let x=1,L=n.length,ue=s.length;if(m!==void 0&&(m=String(m).toLowerCase(),m==="ucs2"||m==="ucs-2"||m==="utf16le"||m==="utf-16le")){if(n.length<2||s.length<2)return-1;x=2,L/=2,ue/=2,a/=2}function ne(se,Ee){return x===1?se[Ee]:se.readUInt16BE(Ee*x)}let oe;if(w){let se=-1;for(oe=a;oe<L;oe++)if(ne(n,oe)===ne(s,se===-1?0:oe-se)){if(se===-1&&(se=oe),oe-se+1===ue)return se*x}else se!==-1&&(oe-=oe-se),se=-1}else for(a+ue>L&&(a=L-ue),oe=a;oe>=0;oe--){let se=!0;for(let Ee=0;Ee<ue;Ee++)if(ne(n,oe+Ee)!==ne(s,Ee)){se=!1;break}if(se)return oe}return-1}f.prototype.includes=function(n,s,a){return this.indexOf(n,s,a)!==-1},f.prototype.indexOf=function(n,s,a){return $(this,n,s,a,!0)},f.prototype.lastIndexOf=function(n,s,a){return $(this,n,s,a,!1)};function k(n,s,a,m){a=Number(a)||0;let w=n.length-a;m?(m=Number(m),m>w&&(m=w)):m=w;let x=s.length;m>x/2&&(m=x/2);let L;for(L=0;L<m;++L){let ue=parseInt(s.substr(L*2,2),16);if(ot(ue))return L;n[a+L]=ue}return L}function ce(n,s,a,m){return Le(gt(s,n.length-a),n,a,m)}function Oe(n,s,a,m){return Le(mt(s),n,a,m)}function Ge(n,s,a,m){return Le(At(s),n,a,m)}function ae(n,s,a,m){return Le(rt(s,n.length-a),n,a,m)}f.prototype.write=function(n,s,a,m){if(s===void 0)m="utf8",a=this.length,s=0;else if(a===void 0&&typeof s=="string")m=s,a=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(a)?(a=a>>>0,m===void 0&&(m="utf8")):(m=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let w=this.length-s;if((a===void 0||a>w)&&(a=w),n.length>0&&(a<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");m||(m="utf8");let x=!1;for(;;)switch(m){case"hex":return k(this,n,s,a);case"utf8":case"utf-8":return ce(this,n,s,a);case"ascii":case"latin1":case"binary":return Oe(this,n,s,a);case"base64":return Ge(this,n,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,n,s,a);default:if(x)throw new TypeError("Unknown encoding: "+m);m=(""+m).toLowerCase(),x=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ze(n,s,a){return s===0&&a===n.length?t.fromByteArray(n):t.fromByteArray(n.slice(s,a))}function Ae(n,s,a){a=Math.min(n.length,a);let m=[],w=s;for(;w<a;){let x=n[w],L=null,ue=x>239?4:x>223?3:x>191?2:1;if(w+ue<=a){let ne,oe,se,Ee;switch(ue){case 1:x<128&&(L=x);break;case 2:ne=n[w+1],(ne&192)===128&&(Ee=(x&31)<<6|ne&63,Ee>127&&(L=Ee));break;case 3:ne=n[w+1],oe=n[w+2],(ne&192)===128&&(oe&192)===128&&(Ee=(x&15)<<12|(ne&63)<<6|oe&63,Ee>2047&&(Ee<55296||Ee>57343)&&(L=Ee));break;case 4:ne=n[w+1],oe=n[w+2],se=n[w+3],(ne&192)===128&&(oe&192)===128&&(se&192)===128&&(Ee=(x&15)<<18|(ne&63)<<12|(oe&63)<<6|se&63,Ee>65535&&Ee<1114112&&(L=Ee))}}L===null?(L=65533,ue=1):L>65535&&(L-=65536,m.push(L>>>10&1023|55296),L=56320|L&1023),m.push(L),w+=ue}return v(m)}var d=4096;function v(n){let s=n.length;if(s<=d)return String.fromCharCode.apply(String,n);let a="",m=0;for(;m<s;)a+=String.fromCharCode.apply(String,n.slice(m,m+=d));return a}function P(n,s,a){let m="";a=Math.min(n.length,a);for(let w=s;w<a;++w)m+=String.fromCharCode(n[w]&127);return m}function Z(n,s,a){let m="";a=Math.min(n.length,a);for(let w=s;w<a;++w)m+=String.fromCharCode(n[w]);return m}function ee(n,s,a){let m=n.length;(!s||s<0)&&(s=0),(!a||a<0||a>m)&&(a=m);let w="";for(let x=s;x<a;++x)w+=Ct[n[x]];return w}function H(n,s,a){let m=n.slice(s,a),w="";for(let x=0;x<m.length-1;x+=2)w+=String.fromCharCode(m[x]+m[x+1]*256);return w}f.prototype.slice=function(n,s){let a=this.length;n=~~n,s=s===void 0?a:~~s,n<0?(n+=a,n<0&&(n=0)):n>a&&(n=a),s<0?(s+=a,s<0&&(s=0)):s>a&&(s=a),s<n&&(s=n);let m=this.subarray(n,s);return Object.setPrototypeOf(m,f.prototype),m};function le(n,s,a){if(n%1!==0||n<0)throw new RangeError("offset is not uint");if(n+s>a)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUintLE=f.prototype.readUIntLE=function(n,s,a){n=n>>>0,s=s>>>0,a||le(n,s,this.length);let m=this[n],w=1,x=0;for(;++x<s&&(w*=256);)m+=this[n+x]*w;return m},f.prototype.readUintBE=f.prototype.readUIntBE=function(n,s,a){n=n>>>0,s=s>>>0,a||le(n,s,this.length);let m=this[n+--s],w=1;for(;s>0&&(w*=256);)m+=this[n+--s]*w;return m},f.prototype.readUint8=f.prototype.readUInt8=function(n,s){return n=n>>>0,s||le(n,1,this.length),this[n]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(n,s){return n=n>>>0,s||le(n,2,this.length),this[n]|this[n+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(n,s){return n=n>>>0,s||le(n,2,this.length),this[n]<<8|this[n+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(n,s){return n=n>>>0,s||le(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(n,s){return n=n>>>0,s||le(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},f.prototype.readBigUInt64LE=Me(function(n){n=n>>>0,be(n,"offset");let s=this[n],a=this[n+7];(s===void 0||a===void 0)&&Ue(n,this.length-8);let m=s+this[++n]*2**8+this[++n]*2**16+this[++n]*2**24,w=this[++n]+this[++n]*2**8+this[++n]*2**16+a*2**24;return BigInt(m)+(BigInt(w)<<BigInt(32))}),f.prototype.readBigUInt64BE=Me(function(n){n=n>>>0,be(n,"offset");let s=this[n],a=this[n+7];(s===void 0||a===void 0)&&Ue(n,this.length-8);let m=s*2**24+this[++n]*2**16+this[++n]*2**8+this[++n],w=this[++n]*2**24+this[++n]*2**16+this[++n]*2**8+a;return(BigInt(m)<<BigInt(32))+BigInt(w)}),f.prototype.readIntLE=function(n,s,a){n=n>>>0,s=s>>>0,a||le(n,s,this.length);let m=this[n],w=1,x=0;for(;++x<s&&(w*=256);)m+=this[n+x]*w;return w*=128,m>=w&&(m-=Math.pow(2,8*s)),m},f.prototype.readIntBE=function(n,s,a){n=n>>>0,s=s>>>0,a||le(n,s,this.length);let m=s,w=1,x=this[n+--m];for(;m>0&&(w*=256);)x+=this[n+--m]*w;return w*=128,x>=w&&(x-=Math.pow(2,8*s)),x},f.prototype.readInt8=function(n,s){return n=n>>>0,s||le(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},f.prototype.readInt16LE=function(n,s){n=n>>>0,s||le(n,2,this.length);let a=this[n]|this[n+1]<<8;return a&32768?a|4294901760:a},f.prototype.readInt16BE=function(n,s){n=n>>>0,s||le(n,2,this.length);let a=this[n+1]|this[n]<<8;return a&32768?a|4294901760:a},f.prototype.readInt32LE=function(n,s){return n=n>>>0,s||le(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},f.prototype.readInt32BE=function(n,s){return n=n>>>0,s||le(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},f.prototype.readBigInt64LE=Me(function(n){n=n>>>0,be(n,"offset");let s=this[n],a=this[n+7];(s===void 0||a===void 0)&&Ue(n,this.length-8);let m=this[n+4]+this[n+5]*2**8+this[n+6]*2**16+(a<<24);return(BigInt(m)<<BigInt(32))+BigInt(s+this[++n]*2**8+this[++n]*2**16+this[++n]*2**24)}),f.prototype.readBigInt64BE=Me(function(n){n=n>>>0,be(n,"offset");let s=this[n],a=this[n+7];(s===void 0||a===void 0)&&Ue(n,this.length-8);let m=(s<<24)+this[++n]*2**16+this[++n]*2**8+this[++n];return(BigInt(m)<<BigInt(32))+BigInt(this[++n]*2**24+this[++n]*2**16+this[++n]*2**8+a)}),f.prototype.readFloatLE=function(n,s){return n=n>>>0,s||le(n,4,this.length),r.read(this,n,!0,23,4)},f.prototype.readFloatBE=function(n,s){return n=n>>>0,s||le(n,4,this.length),r.read(this,n,!1,23,4)},f.prototype.readDoubleLE=function(n,s){return n=n>>>0,s||le(n,8,this.length),r.read(this,n,!0,52,8)},f.prototype.readDoubleBE=function(n,s){return n=n>>>0,s||le(n,8,this.length),r.read(this,n,!1,52,8)};function me(n,s,a,m,w,x){if(!f.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>w||s<x)throw new RangeError('"value" argument is out of bounds');if(a+m>n.length)throw new RangeError("Index out of range")}f.prototype.writeUintLE=f.prototype.writeUIntLE=function(n,s,a,m){if(n=+n,s=s>>>0,a=a>>>0,!m){let L=Math.pow(2,8*a)-1;me(this,n,s,a,L,0)}let w=1,x=0;for(this[s]=n&255;++x<a&&(w*=256);)this[s+x]=n/w&255;return s+a},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(n,s,a,m){if(n=+n,s=s>>>0,a=a>>>0,!m){let L=Math.pow(2,8*a)-1;me(this,n,s,a,L,0)}let w=a-1,x=1;for(this[s+w]=n&255;--w>=0&&(x*=256);)this[s+w]=n/x&255;return s+a},f.prototype.writeUint8=f.prototype.writeUInt8=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,1,255,0),this[s]=n&255,s+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,2,65535,0),this[s]=n&255,this[s+1]=n>>>8,s+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,2,65535,0),this[s]=n>>>8,this[s+1]=n&255,s+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,4,4294967295,0),this[s+3]=n>>>24,this[s+2]=n>>>16,this[s+1]=n>>>8,this[s]=n&255,s+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,4,4294967295,0),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=n&255,s+4};function g(n,s,a,m,w){ve(s,m,w,n,a,7);let x=Number(s&BigInt(4294967295));n[a++]=x,x=x>>8,n[a++]=x,x=x>>8,n[a++]=x,x=x>>8,n[a++]=x;let L=Number(s>>BigInt(32)&BigInt(4294967295));return n[a++]=L,L=L>>8,n[a++]=L,L=L>>8,n[a++]=L,L=L>>8,n[a++]=L,a}function h(n,s,a,m,w){ve(s,m,w,n,a,7);let x=Number(s&BigInt(4294967295));n[a+7]=x,x=x>>8,n[a+6]=x,x=x>>8,n[a+5]=x,x=x>>8,n[a+4]=x;let L=Number(s>>BigInt(32)&BigInt(4294967295));return n[a+3]=L,L=L>>8,n[a+2]=L,L=L>>8,n[a+1]=L,L=L>>8,n[a]=L,a+8}f.prototype.writeBigUInt64LE=Me(function(n,s=0){return g(this,n,s,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeBigUInt64BE=Me(function(n,s=0){return h(this,n,s,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeIntLE=function(n,s,a,m){if(n=+n,s=s>>>0,!m){let ue=Math.pow(2,8*a-1);me(this,n,s,a,ue-1,-ue)}let w=0,x=1,L=0;for(this[s]=n&255;++w<a&&(x*=256);)n<0&&L===0&&this[s+w-1]!==0&&(L=1),this[s+w]=(n/x>>0)-L&255;return s+a},f.prototype.writeIntBE=function(n,s,a,m){if(n=+n,s=s>>>0,!m){let ue=Math.pow(2,8*a-1);me(this,n,s,a,ue-1,-ue)}let w=a-1,x=1,L=0;for(this[s+w]=n&255;--w>=0&&(x*=256);)n<0&&L===0&&this[s+w+1]!==0&&(L=1),this[s+w]=(n/x>>0)-L&255;return s+a},f.prototype.writeInt8=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,1,127,-128),n<0&&(n=255+n+1),this[s]=n&255,s+1},f.prototype.writeInt16LE=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,2,32767,-32768),this[s]=n&255,this[s+1]=n>>>8,s+2},f.prototype.writeInt16BE=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,2,32767,-32768),this[s]=n>>>8,this[s+1]=n&255,s+2},f.prototype.writeInt32LE=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,4,2147483647,-2147483648),this[s]=n&255,this[s+1]=n>>>8,this[s+2]=n>>>16,this[s+3]=n>>>24,s+4},f.prototype.writeInt32BE=function(n,s,a){return n=+n,s=s>>>0,a||me(this,n,s,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=n&255,s+4},f.prototype.writeBigInt64LE=Me(function(n,s=0){return g(this,n,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),f.prototype.writeBigInt64BE=Me(function(n,s=0){return h(this,n,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function J(n,s,a,m,w,x){if(a+m>n.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function X(n,s,a,m,w){return s=+s,a=a>>>0,w||J(n,s,a,4,34028234663852886e22,-34028234663852886e22),r.write(n,s,a,m,23,4),a+4}f.prototype.writeFloatLE=function(n,s,a){return X(this,n,s,!0,a)},f.prototype.writeFloatBE=function(n,s,a){return X(this,n,s,!1,a)};function we(n,s,a,m,w){return s=+s,a=a>>>0,w||J(n,s,a,8,17976931348623157e292,-17976931348623157e292),r.write(n,s,a,m,52,8),a+8}f.prototype.writeDoubleLE=function(n,s,a){return we(this,n,s,!0,a)},f.prototype.writeDoubleBE=function(n,s,a){return we(this,n,s,!1,a)},f.prototype.copy=function(n,s,a,m){if(!f.isBuffer(n))throw new TypeError("argument should be a Buffer");if(a||(a=0),!m&&m!==0&&(m=this.length),s>=n.length&&(s=n.length),s||(s=0),m>0&&m<a&&(m=a),m===a||n.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("sourceEnd out of bounds");m>this.length&&(m=this.length),n.length-s<m-a&&(m=n.length-s+a);let w=m-a;return this===n&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(s,a,m):Uint8Array.prototype.set.call(n,this.subarray(a,m),s),w},f.prototype.fill=function(n,s,a,m){if(typeof n=="string"){if(typeof s=="string"?(m=s,s=0,a=this.length):typeof a=="string"&&(m=a,a=this.length),m!==void 0&&typeof m!="string")throw new TypeError("encoding must be a string");if(typeof m=="string"&&!f.isEncoding(m))throw new TypeError("Unknown encoding: "+m);if(n.length===1){let x=n.charCodeAt(0);(m==="utf8"&&x<128||m==="latin1")&&(n=x)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(s<0||this.length<s||this.length<a)throw new RangeError("Out of range index");if(a<=s)return this;s=s>>>0,a=a===void 0?this.length:a>>>0,n||(n=0);let w;if(typeof n=="number")for(w=s;w<a;++w)this[w]=n;else{let x=f.isBuffer(n)?n:f.from(n,m),L=x.length;if(L===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(w=0;w<a-s;++w)this[w+s]=x[w%L]}return this};var Se={};function xe(n,s,a){Se[n]=class extends a{constructor(){super(),Object.defineProperty(this,"message",{value:s.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${n}]`,this.stack,delete this.name}get code(){return n}set code(m){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:m,writable:!0})}toString(){return`${this.name} [${n}]: ${this.message}`}}}xe("ERR_BUFFER_OUT_OF_BOUNDS",function(n){return n?`${n} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),xe("ERR_INVALID_ARG_TYPE",function(n,s){return`The "${n}" argument must be of type number. Received type ${typeof s}`},TypeError),xe("ERR_OUT_OF_RANGE",function(n,s,a){let m=`The value of "${n}" is out of range.`,w=a;return Number.isInteger(a)&&Math.abs(a)>2**32?w=Pe(String(a)):typeof a=="bigint"&&(w=String(a),(a>BigInt(2)**BigInt(32)||a<-(BigInt(2)**BigInt(32)))&&(w=Pe(w)),w+="n"),m+=` It must be ${s}. Received ${w}`,m},RangeError);function Pe(n){let s="",a=n.length,m=n[0]==="-"?1:0;for(;a>=m+4;a-=3)s=`_${n.slice(a-3,a)}${s}`;return`${n.slice(0,a)}${s}`}function pe(n,s,a){be(s,"offset"),(n[s]===void 0||n[s+a]===void 0)&&Ue(s,n.length-(a+1))}function ve(n,s,a,m,w,x){if(n>a||n<s){let L=typeof s=="bigint"?"n":"",ue;throw x>3?s===0||s===BigInt(0)?ue=`>= 0${L} and < 2${L} ** ${(x+1)*8}${L}`:ue=`>= -(2${L} ** ${(x+1)*8-1}${L}) and < 2 ** ${(x+1)*8-1}${L}`:ue=`>= ${s}${L} and <= ${a}${L}`,new Se.ERR_OUT_OF_RANGE("value",ue,n)}pe(m,w,x)}function be(n,s){if(typeof n!="number")throw new Se.ERR_INVALID_ARG_TYPE(s,"number",n)}function Ue(n,s,a){throw Math.floor(n)!==n?(be(n,a),new Se.ERR_OUT_OF_RANGE(a||"offset","an integer",n)):s<0?new Se.ERR_BUFFER_OUT_OF_BOUNDS:new Se.ERR_OUT_OF_RANGE(a||"offset",`>= ${a?1:0} and <= ${s}`,n)}var Ke=/[^+/0-9A-Za-z-_]/g;function $e(n){if(n=n.split("=")[0],n=n.trim().replace(Ke,""),n.length<2)return"";for(;n.length%4!==0;)n=n+"=";return n}function gt(n,s){s=s||1/0;let a,m=n.length,w=null,x=[];for(let L=0;L<m;++L){if(a=n.charCodeAt(L),a>55295&&a<57344){if(!w){if(a>56319){(s-=3)>-1&&x.push(239,191,189);continue}else if(L+1===m){(s-=3)>-1&&x.push(239,191,189);continue}w=a;continue}if(a<56320){(s-=3)>-1&&x.push(239,191,189),w=a;continue}a=(w-55296<<10|a-56320)+65536}else w&&(s-=3)>-1&&x.push(239,191,189);if(w=null,a<128){if((s-=1)<0)break;x.push(a)}else if(a<2048){if((s-=2)<0)break;x.push(a>>6|192,a&63|128)}else if(a<65536){if((s-=3)<0)break;x.push(a>>12|224,a>>6&63|128,a&63|128)}else if(a<1114112){if((s-=4)<0)break;x.push(a>>18|240,a>>12&63|128,a>>6&63|128,a&63|128)}else throw new Error("Invalid code point")}return x}function mt(n){let s=[];for(let a=0;a<n.length;++a)s.push(n.charCodeAt(a)&255);return s}function rt(n,s){let a,m,w,x=[];for(let L=0;L<n.length&&!((s-=2)<0);++L)a=n.charCodeAt(L),m=a>>8,w=a%256,x.push(w),x.push(m);return x}function At(n){return t.toByteArray($e(n))}function Le(n,s,a,m){let w;for(w=0;w<m&&!(w+a>=s.length||w>=n.length);++w)s[w+a]=n[w];return w}function Be(n,s){return n instanceof s||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===s.name}function ot(n){return n!==n}var Ct=function(){let n="0123456789abcdef",s=new Array(256);for(let a=0;a<16;++a){let m=a*16;for(let w=0;w<16;++w)s[m+w]=n[a]+n[w]}return s}();function Me(n){return typeof BigInt>"u"?yt:n}function yt(){throw new Error("BigInt not supported")}}),Tr=xt(()=>{}),Nr=xt(e=>{var t=e,{Buffer:r}=xr(),i=Tr();t.toBuffer=function(f,E,B){B=~~B;let O;if(this.isV4Format(f))O=E||r.alloc(B+4),f.split(/\./g).map(C=>{O[B++]=parseInt(C,10)&255});else if(this.isV6Format(f)){let C=f.split(":",8),T;for(T=0;T<C.length;T++){let W=this.isV4Format(C[T]),S;W&&(S=this.toBuffer(C[T]),C[T]=S.slice(0,2).toString("hex")),S&&++T<8&&C.splice(T,0,S.slice(2,4).toString("hex"))}if(C[0]==="")for(;C.length<8;)C.unshift("0");else if(C[C.length-1]==="")for(;C.length<8;)C.push("0");else if(C.length<8){for(T=0;T<C.length&&C[T]!=="";T++);let W=[T,1];for(T=9-C.length;T>0;T--)W.push("0");C.splice(...W)}for(O=E||r.alloc(B+16),T=0;T<C.length;T++){let W=parseInt(C[T],16);O[B++]=W>>8&255,O[B++]=W&255}}if(!O)throw Error(`Invalid ip address: ${f}`);return O},t.toString=function(f,E,B){E=~~E,B=B||f.length-E;let O=[];if(B===4){for(let C=0;C<B;C++)O.push(f[E+C]);O=O.join(".")}else if(B===16){for(let C=0;C<B;C+=2)O.push(f.readUInt16BE(E+C).toString(16));O=O.join(":"),O=O.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),O=O.replace(/:{3,4}/,"::")}return O};var u=/^(\d{1,3}\.){3,3}\d{1,3}$/,p=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;t.isV4Format=function(f){return u.test(f)},t.isV6Format=function(f){return p.test(f)};function R(f){return f===4?"ipv4":f===6?"ipv6":f?f.toLowerCase():"ipv4"}t.fromPrefixLen=function(f,E){f>32?E="ipv6":E=R(E);let B=4;E==="ipv6"&&(B=16);let O=r.alloc(B);for(let C=0,T=O.length;C<T;++C){let W=8;f<8&&(W=f),f-=W,O[C]=~(255>>W)&255}return t.toString(O)},t.mask=function(f,E){f=t.toBuffer(f),E=t.toBuffer(E);let B=r.alloc(Math.max(f.length,E.length)),O;if(f.length===E.length)for(O=0;O<f.length;O++)B[O]=f[O]&E[O];else if(E.length===4)for(O=0;O<E.length;O++)B[O]=f[f.length-4+O]&E[O];else{for(O=0;O<B.length-6;O++)B[O]=0;for(B[10]=255,B[11]=255,O=0;O<f.length;O++)B[O+12]=f[O]&E[O+12];O+=12}for(;O<B.length;O++)B[O]=0;return t.toString(B)},t.cidr=function(f){let E=f.split("/"),B=E[0];if(E.length!==2)throw new Error(`invalid CIDR subnet: ${B}`);let O=t.fromPrefixLen(parseInt(E[1],10));return t.mask(B,O)},t.subnet=function(f,E){let B=t.toLong(t.mask(f,E)),O=t.toBuffer(E),C=0;for(let W=0;W<O.length;W++)if(O[W]===255)C+=8;else{let S=O[W]&255;for(;S;)S=S<<1&255,C++}let T=2**(32-C);return{networkAddress:t.fromLong(B),firstAddress:T<=2?t.fromLong(B):t.fromLong(B+1),lastAddress:T<=2?t.fromLong(B+T-1):t.fromLong(B+T-2),broadcastAddress:t.fromLong(B+T-1),subnetMask:E,subnetMaskLength:C,numHosts:T<=2?T:T-2,length:T,contains(W){return B===t.toLong(t.mask(W,E))}}},t.cidrSubnet=function(f){let E=f.split("/"),B=E[0];if(E.length!==2)throw new Error(`invalid CIDR subnet: ${B}`);let O=t.fromPrefixLen(parseInt(E[1],10));return t.subnet(B,O)},t.not=function(f){let E=t.toBuffer(f);for(let B=0;B<E.length;B++)E[B]=255^E[B];return t.toString(E)},t.or=function(f,E){if(f=t.toBuffer(f),E=t.toBuffer(E),f.length===E.length){for(let T=0;T<f.length;++T)f[T]|=E[T];return t.toString(f)}let B=f,O=E;E.length>f.length&&(B=E,O=f);let C=B.length-O.length;for(let T=C;T<B.length;++T)B[T]|=O[T-C];return t.toString(B)},t.isEqual=function(f,E){if(f=t.toBuffer(f),E=t.toBuffer(E),f.length===E.length){for(let O=0;O<f.length;O++)if(f[O]!==E[O])return!1;return!0}if(E.length===4){let O=E;E=f,f=O}for(let O=0;O<10;O++)if(E[O]!==0)return!1;let B=E.readUInt16BE(10);if(B!==0&&B!==65535)return!1;for(let O=0;O<4;O++)if(f[O]!==E[O+12])return!1;return!0},t.isPrivate=function(f){return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(f)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(f)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(f)||/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(f)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(f)||/^f[cd][0-9a-f]{2}:/i.test(f)||/^fe80:/i.test(f)||/^::1$/.test(f)||/^::$/.test(f)},t.isPublic=function(f){return!t.isPrivate(f)},t.isLoopback=function(f){return/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(f)||/^fe80::1$/.test(f)||/^::1$/.test(f)||/^::$/.test(f)},t.loopback=function(f){if(f=R(f),f!=="ipv4"&&f!=="ipv6")throw new Error("family must be ipv4 or ipv6");return f==="ipv4"?"127.0.0.1":"fe80::1"},t.address=function(f,E){let B=i.networkInterfaces();if(E=R(E),f&&f!=="private"&&f!=="public"){let C=B[f].filter(T=>R(T.family)===E);return C.length===0?void 0:C[0].address}let O=Object.keys(B).map(C=>{let T=B[C].filter(W=>(W.family=R(W.family),W.family!==E||t.isLoopback(W.address)?!1:f?f==="public"?t.isPrivate(W.address):t.isPublic(W.address):!0));return T.length?T[0].address:void 0}).filter(Boolean);return O.length?O[0]:t.loopback(E)},t.toLong=function(f){let E=0;return f.split(".").forEach(B=>{E<<=8,E+=parseInt(B)}),E>>>0},t.fromLong=function(f){return`${f>>>24}.${f>>16&255}.${f>>8&255}.${f&255}`}}),Br=xt((e,t)=>{var r=typeof self<"u"?self:e,i=function(){function p(){this.fetch=!1,this.DOMException=r.DOMException}return p.prototype=r,new p}();(function(p){var R=function(f){var E={searchParams:"URLSearchParams"in p,iterable:"Symbol"in p&&"iterator"in Symbol,blob:"FileReader"in p&&"Blob"in p&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in p,arrayBuffer:"ArrayBuffer"in p};function B(d){return d&&DataView.prototype.isPrototypeOf(d)}if(E.arrayBuffer)var O=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],C=ArrayBuffer.isView||function(d){return d&&O.indexOf(Object.prototype.toString.call(d))>-1};function T(d){if(typeof d!="string"&&(d=String(d)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(d))throw new TypeError("Invalid character in header field name");return d.toLowerCase()}function W(d){return typeof d!="string"&&(d=String(d)),d}function S(d){var v={next:function(){var P=d.shift();return{done:P===void 0,value:P}}};return E.iterable&&(v[Symbol.iterator]=function(){return v}),v}function _(d){this.map={},d instanceof _?d.forEach(function(v,P){this.append(P,v)},this):Array.isArray(d)?d.forEach(function(v){this.append(v[0],v[1])},this):d&&Object.getOwnPropertyNames(d).forEach(function(v){this.append(v,d[v])},this)}_.prototype.append=function(d,v){d=T(d),v=W(v);var P=this.map[d];this.map[d]=P?P+", "+v:v},_.prototype.delete=function(d){delete this.map[T(d)]},_.prototype.get=function(d){return d=T(d),this.has(d)?this.map[d]:null},_.prototype.has=function(d){return this.map.hasOwnProperty(T(d))},_.prototype.set=function(d,v){this.map[T(d)]=W(v)},_.prototype.forEach=function(d,v){for(var P in this.map)this.map.hasOwnProperty(P)&&d.call(v,this.map[P],P,this)},_.prototype.keys=function(){var d=[];return this.forEach(function(v,P){d.push(P)}),S(d)},_.prototype.values=function(){var d=[];return this.forEach(function(v){d.push(v)}),S(d)},_.prototype.entries=function(){var d=[];return this.forEach(function(v,P){d.push([P,v])}),S(d)},E.iterable&&(_.prototype[Symbol.iterator]=_.prototype.entries);function M(d){if(d.bodyUsed)return Promise.reject(new TypeError("Already read"));d.bodyUsed=!0}function q(d){return new Promise(function(v,P){d.onload=function(){v(d.result)},d.onerror=function(){P(d.error)}})}function z(d){var v=new FileReader,P=q(v);return v.readAsArrayBuffer(d),P}function Y(d){var v=new FileReader,P=q(v);return v.readAsText(d),P}function F(d){for(var v=new Uint8Array(d),P=new Array(v.length),Z=0;Z<v.length;Z++)P[Z]=String.fromCharCode(v[Z]);return P.join("")}function te(d){if(d.slice)return d.slice(0);var v=new Uint8Array(d.byteLength);return v.set(new Uint8Array(d)),v.buffer}function $(){return this.bodyUsed=!1,this._initBody=function(d){this._bodyInit=d,d?typeof d=="string"?this._bodyText=d:E.blob&&Blob.prototype.isPrototypeOf(d)?this._bodyBlob=d:E.formData&&FormData.prototype.isPrototypeOf(d)?this._bodyFormData=d:E.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)?this._bodyText=d.toString():E.arrayBuffer&&E.blob&&B(d)?(this._bodyArrayBuffer=te(d.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):E.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(d)||C(d))?this._bodyArrayBuffer=te(d):this._bodyText=d=Object.prototype.toString.call(d):this._bodyText="",this.headers.get("content-type")||(typeof d=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):E.searchParams&&URLSearchParams.prototype.isPrototypeOf(d)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},E.blob&&(this.blob=function(){var d=M(this);if(d)return d;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?M(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(z)}),this.text=function(){var d=M(this);if(d)return d;if(this._bodyBlob)return Y(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(F(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},E.formData&&(this.formData=function(){return this.text().then(Oe)}),this.json=function(){return this.text().then(JSON.parse)},this}var ke=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function k(d){var v=d.toUpperCase();return ke.indexOf(v)>-1?v:d}function ce(d,v){v=v||{};var P=v.body;if(d instanceof ce){if(d.bodyUsed)throw new TypeError("Already read");this.url=d.url,this.credentials=d.credentials,v.headers||(this.headers=new _(d.headers)),this.method=d.method,this.mode=d.mode,this.signal=d.signal,!P&&d._bodyInit!=null&&(P=d._bodyInit,d.bodyUsed=!0)}else this.url=String(d);if(this.credentials=v.credentials||this.credentials||"same-origin",(v.headers||!this.headers)&&(this.headers=new _(v.headers)),this.method=k(v.method||this.method||"GET"),this.mode=v.mode||this.mode||null,this.signal=v.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&P)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(P)}ce.prototype.clone=function(){return new ce(this,{body:this._bodyInit})};function Oe(d){var v=new FormData;return d.trim().split("&").forEach(function(P){if(P){var Z=P.split("="),ee=Z.shift().replace(/\+/g," "),H=Z.join("=").replace(/\+/g," ");v.append(decodeURIComponent(ee),decodeURIComponent(H))}}),v}function Ge(d){var v=new _,P=d.replace(/\r?\n[\t ]+/g," ");return P.split(/\r?\n/).forEach(function(Z){var ee=Z.split(":"),H=ee.shift().trim();if(H){var le=ee.join(":").trim();v.append(H,le)}}),v}$.call(ce.prototype);function ae(d,v){v||(v={}),this.type="default",this.status=v.status===void 0?200:v.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in v?v.statusText:"OK",this.headers=new _(v.headers),this.url=v.url||"",this._initBody(d)}$.call(ae.prototype),ae.prototype.clone=function(){return new ae(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new _(this.headers),url:this.url})},ae.error=function(){var d=new ae(null,{status:0,statusText:""});return d.type="error",d};var ze=[301,302,303,307,308];ae.redirect=function(d,v){if(ze.indexOf(v)===-1)throw new RangeError("Invalid status code");return new ae(null,{status:v,headers:{location:d}})},f.DOMException=p.DOMException;try{new f.DOMException}catch{f.DOMException=function(d,v){this.message=d,this.name=v;var P=Error(d);this.stack=P.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function Ae(d,v){return new Promise(function(P,Z){var ee=new ce(d,v);if(ee.signal&&ee.signal.aborted)return Z(new f.DOMException("Aborted","AbortError"));var H=new XMLHttpRequest;function le(){H.abort()}H.onload=function(){var me={status:H.status,statusText:H.statusText,headers:Ge(H.getAllResponseHeaders()||"")};me.url="responseURL"in H?H.responseURL:me.headers.get("X-Request-URL");var g="response"in H?H.response:H.responseText;P(new ae(g,me))},H.onerror=function(){Z(new TypeError("Network request failed"))},H.ontimeout=function(){Z(new TypeError("Network request failed"))},H.onabort=function(){Z(new f.DOMException("Aborted","AbortError"))},H.open(ee.method,ee.url,!0),ee.credentials==="include"?H.withCredentials=!0:ee.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&E.blob&&(H.responseType="blob"),ee.headers.forEach(function(me,g){H.setRequestHeader(g,me)}),ee.signal&&(ee.signal.addEventListener("abort",le),H.onreadystatechange=function(){H.readyState===4&&ee.signal.removeEventListener("abort",le)}),H.send(typeof ee._bodyInit>"u"?null:ee._bodyInit)})}return Ae.polyfill=!0,p.fetch||(p.fetch=Ae,p.Headers=_,p.Request=ce,p.Response=ae),f.Headers=_,f.Request=ce,f.Response=ae,f.fetch=Ae,Object.defineProperty(f,"__esModule",{value:!0}),f}({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var u=i;e=u.fetch,e.default=u.fetch,e.fetch=u.fetch,e.Headers=u.Headers,e.Request=u.Request,e.Response=u.Response,t.exports=e}),Dr=(e,t,r,i)=>{if(r==="length"||r==="prototype"||r==="arguments"||r==="caller")return;let u=Object.getOwnPropertyDescriptor(e,r),p=Object.getOwnPropertyDescriptor(t,r);!Ur(u,p)&&i||Object.defineProperty(e,r,p)},Ur=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},Lr=(e,t)=>{let r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)},Cr=(e,t)=>`/* Wrapped ${e}*/
${t}`,Pr=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Mr=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Fr=(e,t,r)=>{let i=r===""?"":`with ${r.trim()}() `,u=Cr.bind(null,i,t.toString());Object.defineProperty(u,"name",Mr),Object.defineProperty(e,"toString",{...Pr,value:u})};function Gr(e,t,{ignoreNonConfigurable:r=!1}={}){let{name:i}=e;for(let u of Reflect.ownKeys(t))Dr(e,t,u,r);return Lr(e,t),Fr(e,t,i),e}var zr=new WeakMap;function $r(e,{cacheKey:t=([i])=>i,cache:r=new Map}={}){let i=new Map,u=function(...p){let R=t(p);if(i.has(R))return i.get(R);let f=(async()=>{try{if(r&&await r.has(R))return await r.get(R);let E=await e.apply(this,p);try{return E}finally{r&&await r.set(R,E)}}finally{i.delete(R)}})();return i.set(R,f),f};return Gr(u,e,{ignoreNonConfigurable:!0}),zr.set(u,r),u}var Vr=On(Nr(),1),jr=["string","number","bigint","symbol"],Hr=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Wr(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let t=typeof e;return jr.includes(t)?t:t==="function"?"Function":Array.isArray(e)?"Array":qr(e)?"Buffer":Kr(e)||"Object"}function qr(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Kr(e){let t=Object.prototype.toString.call(e).slice(8,-1);if(Hr.includes(t))return t}var D=class{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};D.uint=new D(0,"uint",!0);D.negint=new D(1,"negint",!0);D.bytes=new D(2,"bytes",!0);D.string=new D(3,"string",!0);D.array=new D(4,"array",!1);D.map=new D(5,"map",!1);D.tag=new D(6,"tag",!1);D.float=new D(7,"float",!0);D.false=new D(7,"false",!0);D.true=new D(7,"true",!0);D.null=new D(7,"null",!0);D.undefined=new D(7,"undefined",!0);D.break=new D(7,"break",!0);var K=class{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}},Tt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Jr=new TextDecoder,Yr=new TextEncoder;function ni(e){return Tt&&globalThis.Buffer.isBuffer(e)}function Xr(e){return e instanceof Uint8Array?ni(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var Qr=Tt?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):bn(e,t,r):(e,t,r)=>r-t>64?Jr.decode(e.subarray(t,r)):bn(e,t,r),Zr=Tt?e=>e.length>64?globalThis.Buffer.from(e):vn(e):e=>e.length>64?Yr.encode(e):vn(e),Ci=Tt?(e,t,r)=>ni(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),eo=Tt?(e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),Xr(globalThis.Buffer.concat(e,t))):(e,t)=>{let r=new Uint8Array(t),i=0;for(let u of e)i+u.length>r.length&&(u=u.subarray(0,r.length-i)),r.set(u,i),i+=u.length;return r},to=Tt?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function io(e,t){if(ni(e)&&ni(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function vn(e,t=1/0){let r,i=e.length,u=null,p=[];for(let R=0;R<i;++R){if(r=e.charCodeAt(R),r>55295&&r<57344){if(!u){if(r>56319){(t-=3)>-1&&p.push(239,191,189);continue}else if(R+1===i){(t-=3)>-1&&p.push(239,191,189);continue}u=r;continue}if(r<56320){(t-=3)>-1&&p.push(239,191,189),u=r;continue}r=(u-55296<<10|r-56320)+65536}else u&&(t-=3)>-1&&p.push(239,191,189);if(u=null,r<128){if((t-=1)<0)break;p.push(r)}else if(r<2048){if((t-=2)<0)break;p.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;p.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;p.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return p}function bn(e,t,r){let i=[];for(;t<r;){let u=e[t],p=null,R=u>239?4:u>223?3:u>191?2:1;if(t+R<=r){let f,E,B,O;switch(R){case 1:u<128&&(p=u);break;case 2:f=e[t+1],(f&192)===128&&(O=(u&31)<<6|f&63,O>127&&(p=O));break;case 3:f=e[t+1],E=e[t+2],(f&192)===128&&(E&192)===128&&(O=(u&15)<<12|(f&63)<<6|E&63,O>2047&&(O<55296||O>57343)&&(p=O));break;case 4:f=e[t+1],E=e[t+2],B=e[t+3],(f&192)===128&&(E&192)===128&&(B&192)===128&&(O=(u&15)<<18|(f&63)<<12|(E&63)<<6|B&63,O>65535&&O<1114112&&(p=O))}}p===null?(p=65533,R=1):p>65535&&(p-=65536,i.push(p>>>10&1023|55296),p=56320|p&1023),i.push(p),t+=R}return no(i)}var En=4096;function no(e){let t=e.length;if(t<=En)return String.fromCharCode.apply(String,e);let r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=En));return r}var ro=256,oo=class{constructor(e=ro){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){let r=t.length-(this.maxCursor-this.cursor)-1;r<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,r),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=to(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Ci(r,0,this.cursor)}else t=eo(this.chunks,this.cursor);return e&&this.reset(),t}},re="CBOR decode error:",xn="CBOR encode error:",Vt=[];Vt[23]=1;Vt[24]=2;Vt[25]=3;Vt[26]=5;Vt[27]=9;function Nt(e,t,r){if(e.length-t<r)throw new Error(`${re} not enough data for type`)}var Ne=[24,256,65536,4294967296,BigInt("18446744073709551616")];function vt(e,t,r){Nt(e,t,1);let i=e[t];if(r.strict===!0&&i<Ne[0])throw new Error(`${re} integer encoded in more bytes than necessary (strict decode)`);return i}function bt(e,t,r){Nt(e,t,2);let i=e[t]<<8|e[t+1];if(r.strict===!0&&i<Ne[1])throw new Error(`${re} integer encoded in more bytes than necessary (strict decode)`);return i}function Et(e,t,r){Nt(e,t,4);let i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&i<Ne[2])throw new Error(`${re} integer encoded in more bytes than necessary (strict decode)`);return i}function kt(e,t,r){Nt(e,t,8);let i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],u=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],p=(BigInt(i)<<BigInt(32))+BigInt(u);if(r.strict===!0&&p<Ne[3])throw new Error(`${re} integer encoded in more bytes than necessary (strict decode)`);if(p<=Number.MAX_SAFE_INTEGER)return Number(p);if(r.allowBigInt===!0)return p;throw new Error(`${re} integers outside of the safe integer range are not supported`)}function so(e,t,r,i){return new K(D.uint,vt(e,t+1,i),2)}function ao(e,t,r,i){return new K(D.uint,bt(e,t+1,i),3)}function fo(e,t,r,i){return new K(D.uint,Et(e,t+1,i),5)}function co(e,t,r,i){return new K(D.uint,kt(e,t+1,i),9)}function Rt(e,t){return We(e,0,t.value)}function We(e,t,r){if(r<Ne[0]){let i=Number(r);e.push([t|i])}else if(r<Ne[1]){let i=Number(r);e.push([t|24,i])}else if(r<Ne[2]){let i=Number(r);e.push([t|25,i>>>8,i&255])}else if(r<Ne[3]){let i=Number(r);e.push([t|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{let i=BigInt(r);if(i<Ne[4]){let u=[t|27,0,0,0,0,0,0,0],p=Number(i&BigInt(4294967295)),R=Number(i>>BigInt(32)&BigInt(4294967295));u[8]=p&255,p=p>>8,u[7]=p&255,p=p>>8,u[6]=p&255,p=p>>8,u[5]=p&255,u[4]=R&255,R=R>>8,u[3]=R&255,R=R>>8,u[2]=R&255,R=R>>8,u[1]=R&255,e.push(u)}else throw new Error(`${re} encountered BigInt larger than allowable range`)}}Rt.encodedSize=function(e){return We.encodedSize(e.value)};We.encodedSize=function(e){return e<Ne[0]?1:e<Ne[1]?2:e<Ne[2]?3:e<Ne[3]?5:9};Rt.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function lo(e,t,r,i){return new K(D.negint,-1-vt(e,t+1,i),2)}function uo(e,t,r,i){return new K(D.negint,-1-bt(e,t+1,i),3)}function ho(e,t,r,i){return new K(D.negint,-1-Et(e,t+1,i),5)}var Pi=BigInt(-1),Tn=BigInt(1);function po(e,t,r,i){let u=kt(e,t+1,i);if(typeof u!="bigint"){let p=-1-u;if(p>=Number.MIN_SAFE_INTEGER)return new K(D.negint,p,9)}if(i.allowBigInt!==!0)throw new Error(`${re} integers outside of the safe integer range are not supported`);return new K(D.negint,Pi-BigInt(u),9)}function Mi(e,t){let r=t.value,i=typeof r=="bigint"?r*Pi-Tn:r*-1-1;We(e,t.type.majorEncoded,i)}Mi.encodedSize=function(e){let t=e.value,r=typeof t=="bigint"?t*Pi-Tn:t*-1-1;return r<Ne[0]?1:r<Ne[1]?2:r<Ne[2]?3:r<Ne[3]?5:9};Mi.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function jt(e,t,r,i){Nt(e,t,r+i);let u=Ci(e,t+r,t+r+i);return new K(D.bytes,u,r+i)}function go(e,t,r,i){return jt(e,t,1,r)}function mo(e,t,r,i){return jt(e,t,2,vt(e,t+1,i))}function yo(e,t,r,i){return jt(e,t,3,bt(e,t+1,i))}function wo(e,t,r,i){return jt(e,t,5,Et(e,t+1,i))}function _o(e,t,r,i){let u=kt(e,t+1,i);if(typeof u=="bigint")throw new Error(`${re} 64-bit integer bytes lengths not supported`);return jt(e,t,9,u)}function ri(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===D.string?Zr(e.value):e.value),e.encodedBytes}function fi(e,t){let r=ri(t);We(e,t.type.majorEncoded,r.length),e.push(r)}fi.encodedSize=function(e){let t=ri(e);return We.encodedSize(t.length)+t.length};fi.compareTokens=function(e,t){return vo(ri(e),ri(t))};function vo(e,t){return e.length<t.length?-1:e.length>t.length?1:io(e,t)}function Ht(e,t,r,i,u){let p=r+i;Nt(e,t,p);let R=new K(D.string,Qr(e,t+r,t+p),p);return u.retainStringBytes===!0&&(R.byteValue=Ci(e,t+r,t+p)),R}function bo(e,t,r,i){return Ht(e,t,1,r,i)}function Eo(e,t,r,i){return Ht(e,t,2,vt(e,t+1,i),i)}function ko(e,t,r,i){return Ht(e,t,3,bt(e,t+1,i),i)}function Ro(e,t,r,i){return Ht(e,t,5,Et(e,t+1,i),i)}function So(e,t,r,i){let u=kt(e,t+1,i);if(typeof u=="bigint")throw new Error(`${re} 64-bit integer string lengths not supported`);return Ht(e,t,9,u,i)}var Io=fi;function Bt(e,t,r,i){return new K(D.array,i,r)}function Ao(e,t,r,i){return Bt(e,t,1,r)}function Oo(e,t,r,i){return Bt(e,t,2,vt(e,t+1,i))}function xo(e,t,r,i){return Bt(e,t,3,bt(e,t+1,i))}function To(e,t,r,i){return Bt(e,t,5,Et(e,t+1,i))}function No(e,t,r,i){let u=kt(e,t+1,i);if(typeof u=="bigint")throw new Error(`${re} 64-bit integer array lengths not supported`);return Bt(e,t,9,u)}function Bo(e,t,r,i){if(i.allowIndefinite===!1)throw new Error(`${re} indefinite length items not allowed`);return Bt(e,t,1,1/0)}function Fi(e,t){We(e,D.array.majorEncoded,t.value)}Fi.compareTokens=Rt.compareTokens;Fi.encodedSize=function(e){return We.encodedSize(e.value)};function Dt(e,t,r,i){return new K(D.map,i,r)}function Do(e,t,r,i){return Dt(e,t,1,r)}function Uo(e,t,r,i){return Dt(e,t,2,vt(e,t+1,i))}function Lo(e,t,r,i){return Dt(e,t,3,bt(e,t+1,i))}function Co(e,t,r,i){return Dt(e,t,5,Et(e,t+1,i))}function Po(e,t,r,i){let u=kt(e,t+1,i);if(typeof u=="bigint")throw new Error(`${re} 64-bit integer map lengths not supported`);return Dt(e,t,9,u)}function Mo(e,t,r,i){if(i.allowIndefinite===!1)throw new Error(`${re} indefinite length items not allowed`);return Dt(e,t,1,1/0)}function Gi(e,t){We(e,D.map.majorEncoded,t.value)}Gi.compareTokens=Rt.compareTokens;Gi.encodedSize=function(e){return We.encodedSize(e.value)};function Fo(e,t,r,i){return new K(D.tag,r,1)}function Go(e,t,r,i){return new K(D.tag,vt(e,t+1,i),2)}function zo(e,t,r,i){return new K(D.tag,bt(e,t+1,i),3)}function $o(e,t,r,i){return new K(D.tag,Et(e,t+1,i),5)}function Vo(e,t,r,i){return new K(D.tag,kt(e,t+1,i),9)}function zi(e,t){We(e,D.tag.majorEncoded,t.value)}zi.compareTokens=Rt.compareTokens;zi.encodedSize=function(e){return We.encodedSize(e.value)};var jo=20,Ho=21,Wo=22,qo=23;function Ko(e,t,r,i){if(i.allowUndefined===!1)throw new Error(`${re} undefined values are not supported`);return i.coerceUndefinedToNull===!0?new K(D.null,null,1):new K(D.undefined,void 0,1)}function Jo(e,t,r,i){if(i.allowIndefinite===!1)throw new Error(`${re} indefinite length items not allowed`);return new K(D.break,void 0,1)}function $i(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${re} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${re} Infinity values are not supported`)}return new K(D.float,e,t)}function Yo(e,t,r,i){return $i(ji(e,t+1),3,i)}function Xo(e,t,r,i){return $i(Hi(e,t+1),5,i)}function Qo(e,t,r,i){return $i(Un(e,t+1),9,i)}function Vi(e,t,r){let i=t.value;if(i===!1)e.push([D.float.majorEncoded|jo]);else if(i===!0)e.push([D.float.majorEncoded|Ho]);else if(i===null)e.push([D.float.majorEncoded|Wo]);else if(i===void 0)e.push([D.float.majorEncoded|qo]);else{let u,p=!1;(!r||r.float64!==!0)&&(Bn(i),u=ji(Ze,1),i===u||Number.isNaN(i)?(Ze[0]=249,e.push(Ze.slice(0,3)),p=!0):(Dn(i),u=Hi(Ze,1),i===u&&(Ze[0]=250,e.push(Ze.slice(0,5)),p=!0))),p||(Zo(i),u=Un(Ze,1),Ze[0]=251,e.push(Ze.slice(0,9)))}}Vi.encodedSize=function(e,t){let r=e.value;if(r===!1||r===!0||r===null||r===void 0)return 1;if(!t||t.float64!==!0){Bn(r);let i=ji(Ze,1);if(r===i||Number.isNaN(r))return 3;if(Dn(r),i=Hi(Ze,1),r===i)return 5}return 9};var Nn=new ArrayBuffer(9),He=new DataView(Nn,1),Ze=new Uint8Array(Nn,0);function Bn(e){if(e===1/0)He.setUint16(0,31744,!1);else if(e===-1/0)He.setUint16(0,64512,!1);else if(Number.isNaN(e))He.setUint16(0,32256,!1);else{He.setFloat32(0,e);let t=He.getUint32(0),r=(t&2139095040)>>23,i=t&8388607;if(r===255)He.setUint16(0,31744,!1);else if(r===0)He.setUint16(0,(e&2147483648)>>16|i>>13,!1);else{let u=r-127;u<-24?He.setUint16(0,0):u<-14?He.setUint16(0,(t&2147483648)>>16|1<<24+u,!1):He.setUint16(0,(t&2147483648)>>16|u+15<<10|i>>13,!1)}}}function ji(e,t){if(e.length-t<2)throw new Error(`${re} not enough data for float16`);let r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let i=r>>10&31,u=r&1023,p;return i===0?p=u*2**-24:i!==31?p=(u+1024)*2**(i-25):p=u===0?1/0:NaN,r&32768?-p:p}function Dn(e){He.setFloat32(0,e,!1)}function Hi(e,t){if(e.length-t<4)throw new Error(`${re} not enough data for float32`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function Zo(e){He.setFloat64(0,e,!1)}function Un(e,t){if(e.length-t<8)throw new Error(`${re} not enough data for float64`);let r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}Vi.compareTokens=Rt.compareTokens;function fe(e,t,r){throw new Error(`${re} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function ci(e){return()=>{throw new Error(`${re} ${e}`)}}var G=[];for(let e=0;e<=23;e++)G[e]=fe;G[24]=so;G[25]=ao;G[26]=fo;G[27]=co;G[28]=fe;G[29]=fe;G[30]=fe;G[31]=fe;for(let e=32;e<=55;e++)G[e]=fe;G[56]=lo;G[57]=uo;G[58]=ho;G[59]=po;G[60]=fe;G[61]=fe;G[62]=fe;G[63]=fe;for(let e=64;e<=87;e++)G[e]=go;G[88]=mo;G[89]=yo;G[90]=wo;G[91]=_o;G[92]=fe;G[93]=fe;G[94]=fe;G[95]=ci("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)G[e]=bo;G[120]=Eo;G[121]=ko;G[122]=Ro;G[123]=So;G[124]=fe;G[125]=fe;G[126]=fe;G[127]=ci("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)G[e]=Ao;G[152]=Oo;G[153]=xo;G[154]=To;G[155]=No;G[156]=fe;G[157]=fe;G[158]=fe;G[159]=Bo;for(let e=160;e<=183;e++)G[e]=Do;G[184]=Uo;G[185]=Lo;G[186]=Co;G[187]=Po;G[188]=fe;G[189]=fe;G[190]=fe;G[191]=Mo;for(let e=192;e<=215;e++)G[e]=Fo;G[216]=Go;G[217]=zo;G[218]=$o;G[219]=Vo;G[220]=fe;G[221]=fe;G[222]=fe;G[223]=fe;for(let e=224;e<=243;e++)G[e]=ci("simple values are not supported");G[244]=fe;G[245]=fe;G[246]=fe;G[247]=Ko;G[248]=ci("simple values are not supported");G[249]=Yo;G[250]=Xo;G[251]=Qo;G[252]=fe;G[253]=fe;G[254]=fe;G[255]=Jo;var it=[];for(let e=0;e<24;e++)it[e]=new K(D.uint,e,1);for(let e=-1;e>=-24;e--)it[31-e]=new K(D.negint,e,1);it[64]=new K(D.bytes,new Uint8Array(0),1);it[96]=new K(D.string,"",1);it[128]=new K(D.array,0,1);it[160]=new K(D.map,0,1);it[244]=new K(D.false,!1,1);it[245]=new K(D.true,!0,1);it[246]=new K(D.null,null,1);function es(){let e=[];return e[D.uint.major]=Rt,e[D.negint.major]=Mi,e[D.bytes.major]=fi,e[D.string.major]=Io,e[D.array.major]=Fi,e[D.map.major]=Gi,e[D.tag.major]=zi,e[D.float.major]=Vi,e}var Aa=es(),Oa=new oo,Di=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${xn} object contains circular references`);return new Di(t,e)}},ht={null:new K(D.null,null),undefined:new K(D.undefined,void 0),true:new K(D.true,!0),false:new K(D.false,!1),emptyArray:new K(D.array,0),emptyMap:new K(D.map,0)},pt={number(e,t,r,i){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new K(D.float,e):e>=0?new K(D.uint,e):new K(D.negint,e)},bigint(e,t,r,i){return e>=BigInt(0)?new K(D.uint,e):new K(D.negint,e)},Uint8Array(e,t,r,i){return new K(D.bytes,e)},string(e,t,r,i){return new K(D.string,e)},boolean(e,t,r,i){return e?ht.true:ht.false},null(e,t,r,i){return ht.null},undefined(e,t,r,i){return ht.undefined},ArrayBuffer(e,t,r,i){return new K(D.bytes,new Uint8Array(e))},DataView(e,t,r,i){return new K(D.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,i){if(!e.length)return r.addBreakTokens===!0?[ht.emptyArray,new K(D.break)]:ht.emptyArray;i=Di.createCheck(i,e);let u=[],p=0;for(let R of e)u[p++]=Bi(R,r,i);return r.addBreakTokens?[new K(D.array,e.length),u,new K(D.break)]:[new K(D.array,e.length),u]},Object(e,t,r,i){let u=t!=="Object",p=u?e.keys():Object.keys(e),R=u?e.size:p.length;if(!R)return r.addBreakTokens===!0?[ht.emptyMap,new K(D.break)]:ht.emptyMap;i=Di.createCheck(i,e);let f=[],E=0;for(let B of p)f[E++]=[Bi(B,r,i),Bi(u?e.get(B):e[B],r,i)];return ts(f,r),r.addBreakTokens?[new K(D.map,R),f,new K(D.break)]:[new K(D.map,R),f]}};pt.Map=pt.Object;pt.Buffer=pt.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))pt[`${e}Array`]=pt.DataView;function Bi(e,t={},r){let i=Wr(e),u=t&&t.typeEncoders&&t.typeEncoders[i]||pt[i];if(typeof u=="function"){let R=u(e,i,t,r);if(R!=null)return R}let p=pt[i];if(!p)throw new Error(`${xn} unsupported type: ${i}`);return p(e,i,t,r)}function ts(e,t){t.mapSorter&&e.sort(t.mapSorter)}var is={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},ns=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=it[e];if(t===void 0){let r=G[e];if(!r)throw new Error(`${re} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let i=e&31;t=r(this.data,this.pos,i,this.options)}return this.pos+=t.encodedLength,t}},zt=Symbol.for("DONE"),li=Symbol.for("BREAK");function rs(e,t,r){let i=[];for(let u=0;u<e.value;u++){let p=$t(t,r);if(p===li){if(e.value===1/0)break;throw new Error(`${re} got unexpected break to lengthed array`)}if(p===zt)throw new Error(`${re} found array but not enough entries (got ${u}, expected ${e.value})`);i[u]=p}return i}function os(e,t,r){let i=r.useMaps===!0,u=i?void 0:{},p=i?new Map:void 0;for(let R=0;R<e.value;R++){let f=$t(t,r);if(f===li){if(e.value===1/0)break;throw new Error(`${re} got unexpected break to lengthed map`)}if(f===zt)throw new Error(`${re} found map but not enough entries (got ${R} [no key], expected ${e.value})`);if(i!==!0&&typeof f!="string")throw new Error(`${re} non-string keys not supported (got ${typeof f})`);let E=$t(t,r);if(E===zt)throw new Error(`${re} found map but not enough entries (got ${R} [no value], expected ${e.value})`);i?p.set(f,E):u[f]=E}return i?p:u}function $t(e,t){if(e.done())return zt;let r=e.next();if(r.type===D.break)return li;if(r.type.terminal)return r.value;if(r.type===D.array)return rs(r,e,t);if(r.type===D.map)return os(r,e,t);if(r.type===D.tag){if(t.tags&&typeof t.tags[r.value]=="function"){let i=$t(e,t);return t.tags[r.value](i)}throw new Error(`${re} tag not supported (${r.value})`)}throw new Error("unsupported")}function ss(e,t){if(!(e instanceof Uint8Array))throw new Error(`${re} data to decode must be a Uint8Array`);t=Object.assign({},is,t);let r=t.tokenizer||new ns(e,t),i=$t(r,t);if(i===zt)throw new Error(`${re} did not find any content to decode`);if(i===li)throw new Error(`${re} got unexpected break`);if(!r.done())throw new Error(`${re} too many terminals, data makes no sense`);return i}var as=Ln,kn=128,fs=127,cs=~fs,ls=Math.pow(2,31);function Ln(e,t,r){t=t||[],r=r||0;for(var i=r;e>=ls;)t[r++]=e&255|kn,e/=128;for(;e&cs;)t[r++]=e&255|kn,e>>>=7;return t[r]=e|0,Ln.bytes=r-i+1,t}var us=Ui,hs=128,Rn=127;function Ui(e,i){var r=0,i=i||0,u=0,p=i,R,f=e.length;do{if(p>=f)throw Ui.bytes=0,new RangeError("Could not decode varint");R=e[p++],r+=u<28?(R&Rn)<<u:(R&Rn)*Math.pow(2,u),u+=7}while(R>=hs);return Ui.bytes=p-i,r}var ds=Math.pow(2,7),ps=Math.pow(2,14),gs=Math.pow(2,21),ms=Math.pow(2,28),ys=Math.pow(2,35),ws=Math.pow(2,42),_s=Math.pow(2,49),vs=Math.pow(2,56),bs=Math.pow(2,63),Es=function(e){return e<ds?1:e<ps?2:e<gs?3:e<ms?4:e<ys?5:e<ws?6:e<_s?7:e<vs?8:e<bs?9:10},ks={encode:as,decode:us,encodingLength:Es},Rs=ks,oi=Rs,Li=(e,t=0)=>[oi.decode(e,t),oi.decode.bytes],si=(e,t,r=0)=>(oi.encode(e,t,r),t),ai=e=>oi.encodingLength(e),xa=new Uint8Array(0),Ss=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Wi=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Is=(e,t)=>{let r=t.byteLength,i=ai(e),u=i+ai(r),p=new Uint8Array(u+r);return si(e,p,0),si(r,p,i),p.set(t,u),new qi(e,r,t,p)},As=e=>{let t=Wi(e),[r,i]=Li(t),[u,p]=Li(t.subarray(i)),R=t.subarray(i+p);if(R.byteLength!==u)throw new Error("Incorrect length");return new qi(r,u,R,t)},Os=(e,t)=>e===t?!0:e.code===t.code&&e.size===t.size&&Ss(e.bytes,t.bytes),qi=class{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}};function xs(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var u=0;u<e.length;u++){var p=e.charAt(u),R=p.charCodeAt(0);if(r[R]!==255)throw new TypeError(p+" is ambiguous");r[R]=u}var f=e.length,E=e.charAt(0),B=Math.log(f)/Math.log(256),O=Math.log(256)/Math.log(f);function C(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var _=0,M=0,q=0,z=S.length;q!==z&&S[q]===0;)q++,_++;for(var Y=(z-q)*O+1>>>0,F=new Uint8Array(Y);q!==z;){for(var te=S[q],$=0,ke=Y-1;(te!==0||$<M)&&ke!==-1;ke--,$++)te+=256*F[ke]>>>0,F[ke]=te%f>>>0,te=te/f>>>0;if(te!==0)throw new Error("Non-zero carry");M=$,q++}for(var k=Y-M;k!==Y&&F[k]===0;)k++;for(var ce=E.repeat(_);k<Y;++k)ce+=e.charAt(F[k]);return ce}function T(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var _=0;if(S[_]!==" "){for(var M=0,q=0;S[_]===E;)M++,_++;for(var z=(S.length-_)*B+1>>>0,Y=new Uint8Array(z);S[_];){var F=r[S.charCodeAt(_)];if(F===255)return;for(var te=0,$=z-1;(F!==0||te<q)&&$!==-1;$--,te++)F+=f*Y[$]>>>0,Y[$]=F%256>>>0,F=F/256>>>0;if(F!==0)throw new Error("Non-zero carry");q=te,_++}if(S[_]!==" "){for(var ke=z-q;ke!==z&&Y[ke]===0;)ke++;for(var k=new Uint8Array(M+(z-ke)),ce=M;ke!==z;)k[ce++]=Y[ke++];return k}}}function W(S){var _=T(S);if(_)return _;throw new Error(`Non-${t} character`)}return{encode:C,decodeUnsafe:T,decode:W}}var Ts=xs,Ns=Ts,Bs=Ns,Ds=class{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Us=class{constructor(e,t,r){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Cn(this,e)}},Ls=class{constructor(e){this.decoders=e}or(e){return Cn(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Cn=(e,t)=>new Ls({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Cs=class{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new Ds(e,t,r),this.decoder=new Us(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Pn=({name:e,prefix:t,encode:r,decode:i})=>new Cs(e,t,r,i),Mn=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:u}=Bs(r,t);return Pn({prefix:e,name:t,encode:i,decode:p=>Wi(u(p))})},Ps=(e,t,r,i)=>{let u={};for(let O=0;O<t.length;++O)u[t[O]]=O;let p=e.length;for(;e[p-1]==="=";)--p;let R=new Uint8Array(p*r/8|0),f=0,E=0,B=0;for(let O=0;O<p;++O){let C=u[e[O]];if(C===void 0)throw new SyntaxError(`Non-${i} character`);E=E<<r|C,f+=r,f>=8&&(f-=8,R[B++]=255&E>>f)}if(f>=r||255&E<<8-f)throw new SyntaxError("Unexpected end of data");return R},Ms=(e,t,r)=>{let i=t[t.length-1]==="=",u=(1<<r)-1,p="",R=0,f=0;for(let E=0;E<e.length;++E)for(f=f<<8|e[E],R+=8;R>r;)R-=r,p+=t[u&f>>R];if(R&&(p+=t[u&f<<r-R]),i)for(;p.length*r&7;)p+="=";return p},ft=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>Pn({prefix:t,name:e,encode(u){return Ms(u,i,r)},decode(u){return Ps(u,i,r,e)}}),dt=Mn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ta=Mn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ii=ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Na=ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ba=ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Da=ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ua=ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),La=ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ca=ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Pa=ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ma=ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Te=class{constructor(e,t,r,i){this.code=t,this.version=e,this.multihash=r,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:ti,byteLength:ti,code:ei,version:ei,multihash:ei,bytes:ei,_baseCache:ti,asCID:ti})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==Gt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==$s)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Te.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,r=Is(e,t);return Te.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Os(this.multihash,e.multihash)}toString(e){let{bytes:t,version:r,_baseCache:i}=this;switch(r){case 0:return Gs(t,i,e||dt.encoder);default:return zs(t,i,e||ii.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return js(/^0\.0/,Hs),!!(e&&(e[In]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof Te)return e;if(e!=null&&e.asCID===e){let{version:t,code:r,multihash:i,bytes:u}=e;return new Te(t,r,i,u||Sn(t,r,i.bytes))}else if(e!=null&&e[In]===!0){let{version:t,multihash:r,code:i}=e,u=As(r);return Te.create(t,i,u)}else return null}static create(e,t,r){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==Gt)throw new Error(`Version 0 CID must use dag-pb (code: ${Gt}) block encoding`);return new Te(e,t,r,r.bytes)}case 1:{let i=Sn(e,t,r.bytes);return new Te(e,t,r,i)}default:throw new Error("Invalid version")}}static createV0(e){return Te.create(0,Gt,e)}static createV1(e,t){return Te.create(1,e,t)}static decode(e){let[t,r]=Te.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=Te.inspectBytes(e),r=t.size-t.multihashSize,i=Wi(e.subarray(r,r+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");let u=i.subarray(t.multihashSize-t.digestSize),p=new qi(t.multihashCode,t.digestSize,u,i);return[t.version===0?Te.createV0(p):Te.createV1(t.codec,p),e.subarray(t.size)]}static inspectBytes(e){let t=0,r=()=>{let[O,C]=Li(e.subarray(t));return t+=C,O},i=r(),u=Gt;if(i===18?(i=0,t=0):i===1&&(u=r()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let p=t,R=r(),f=r(),E=t+f,B=E-p;return{version:i,codec:u,multihashCode:R,digestSize:f,multihashSize:B,size:E}}static parse(e,t){let[r,i]=Fs(e,t),u=Te.decode(i);return u._baseCache.set(r,e),u}},Fs=(e,t)=>{switch(e[0]){case"Q":{let r=t||dt;return[dt.prefix,r.decode(`${dt.prefix}${e}`)]}case dt.prefix:{let r=t||dt;return[dt.prefix,r.decode(e)]}case ii.prefix:{let r=t||ii;return[ii.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},Gs=(e,t,r)=>{let{prefix:i}=r;if(i!==dt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let u=t.get(i);if(u==null){let p=r.encode(e).slice(1);return t.set(i,p),p}else return u},zs=(e,t,r)=>{let{prefix:i}=r,u=t.get(i);if(u==null){let p=r.encode(e);return t.set(i,p),p}else return u},Gt=112,$s=18,Sn=(e,t,r)=>{let i=ai(e),u=i+ai(t),p=new Uint8Array(u+r.byteLength);return si(e,p,0),si(t,p,i),p.set(r,u),p},In=Symbol.for("@ipld/js-cid/CID"),ei={writable:!1,configurable:!1,enumerable:!0},ti={writable:!1,enumerable:!1,configurable:!1},Vs="0.0.0-dev",js=(e,t)=>{if(e.test(Vs))console.warn(t);else throw new Error(t)},Hs=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,Ws=42;function qs(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return Te.decode(e.subarray(1))}var Fn={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};Fn.tags[Ws]=qs;var Ks=e=>ss(e,Fn),Js=On(Br(),1),Ys="Earth";function Xs(e){return{country_name:e[0],country_code:e[1],region_code:e[2],city:e[3],postal_code:e[4],latitude:e[5],longitude:e[6],planet:Ys}}var Qs=Te.parse("bafyreihnpl7ami7esahkfdnemm6idx4r2n6u3apmtcrxlqwuapgjsciihy"),Zs=["https://ipfs.io","https://dweb.link"];async function ea(e,t){if(typeof e=="function")return e(t);if(typeof e?.block?.get=="function")return e.block.get(t);let r=Array.isArray(e)?e:[e];for(let i of r){let u=new URL(i);u.pathname=`/ipfs/${t.toString()}`,u.search="?format=raw";try{let p=await(0,Js.default)(u,{headers:{Accept:"application/vnd.ipld.raw"},cache:"force-cache"});if(!p.ok)throw p;return new Uint8Array(await p.arrayBuffer())}catch(p){throw new Error(`unable to fetch raw block for CID ${t}`,{cause:p})}}}async function Gn(e,t,r=1){try{let i=await ea(e,t);return{obj:await Ks(i),block:i}}catch(i){if(r<3)return await Gn(e,t,r+1);throw i}}async function ta(e,t,r){let i,u;try{({obj:i,block:u}=await Gn(e,t))}catch(R){throw(process?.env?.DEBUG||process?.env?.TEST)&&console.error(u?`[ipfs-geoip] failed to parse DAG-CBOR behind CID '${t}'`:`[ipfs-geoip] failed to get raw block for CID '${t}'`,R),R}let p=0;if("data"in i){if("data"in i){for(;i.data[p]&&i.data[p].min<=r;)p++;let R=i.data[p-1];if(!R)throw new Error("Failed to lookup leaf node");if(!R.data)throw new Error("Unmapped range");return Xs(R.data)}}else{for(;i.mins[p]&&i.mins[p]<=r;)p++;let R=i.links[p-1];if(!R)throw new Error("Failed to lookup node");let f=ia(R);if(!f)throw new Error("Failed to lookup node");return zn(e,f,r)}}var zn=$r(ta,{cachePromiseRejection:!1,cacheKey:e=>{let[,t,r]=e;return`${t}.${r}`}});function $n(e=Zs,t){return zn(e,Qs,Vr.default.toLong(t))}function ia(e){return e?Te.asCID(e):null}var St=class{constructor({tokensPerInterval:t,interval:r,stopped:i}){if(this.tokensPerInterval=t,this._isStopped=i,typeof r=="string")switch(r){case"sec":case"second":{this.interval=1e3;break}case"min":case"minute":{this.interval=1e3*60;break}case"hr":case"hour":{this.interval=1e3*60*60;break}case"day":{this.interval=1e3*60*60*24;break}default:throw new Error("Invalid interval "+r)}else this.interval=r;this.tokensRemovedAt=[],this.awaitingRestart=new Set}dripTokens(){throw new Error("dripTokens() not implemented")}getDelayForTokens(){throw new Error("getDelayForTokens() not implemented")}getTokens(){return this.dripTokens(),Math.floor(this.tokens)}tryRemoveTokens(t){return this.dripTokens(),t>this.tokens?!1:(this.tokens-=t,this.tokensRemovedAt.push([Date.now(),t]),!0)}async awaitTokens(t=1){this._isStopped&&await new Promise(i=>this.awaitingRestart.add(i));let r=this.getDelayForTokens(t);return r===0?Math.floor(this.tokens):(await new Promise(i=>setTimeout(()=>i(),r)),this.awaitTokens(t))}reset(){this.awaitingRestart.forEach(t=>t())}stop(t=!0){this._isStopped=!0,t&&this.tryRemoveTokens(this.getTokens())}start(){this._isStopped=!1}get isStopped(){return this._isStopped}};var Ut=class extends St{constructor({bucketSize:t,tokensPerInterval:r,interval:i,stopped:u=!1}){super({tokensPerInterval:r,interval:i,stopped:u}),this.bucketSize=t,this.tokens=u?0:this.bucketSize,this.tokensRemovedAt=u?[0]:[Date.now()]}dripTokens(){if(this._isStopped)return;let t=Date.now(),r=this.tokensRemovedAt[0],i=Math.max(t-r,0);this.tokensRemovedAt=[t];let u=i*(this.tokensPerInterval/this.interval);return this.tokens=Math.min(this.tokens+u,this.bucketSize),Math.floor(this.tokens)}getDelayForTokens(t=1){if(t>this.bucketSize)throw new Error(`Cannot supply ${t} tokens at once (max is bucketSize = ${this.bucketSize}`);this.dripTokens();let r=t-this.tokens;if(r<=0)return 0;if(!this._isStopped)return Math.ceil(r*(this.interval/this.tokensPerInterval))}reset(){this._isStopped=!1,this.tokens=this.bucketSize,this.tokensRemovedAt=[Date.now()],super.reset()}};var It=new Re("Flag"),nt=class extends je{constructor(r,i){super(r,"div","Flag");this.parent=r;this.hostname=i}async check(){let r=!0;try{let i=localStorage.getItem(this.hostname);if(i!=null){let u=JSON.parse(i),p=Date.now(),R=u.time,f=p-R,E=7*24*60*60*1e3;f<E&&(r=!1,this.onResponse(u))}}catch(i){throw It.error(`error while getting savedSTR for ${this.hostname}`,i),this.onError(),i}if(r){this.startLimiters();let i=await this.waitForAvailableEndpoint();await this.dnsRequest(i)}}startLimiters(){nt.googleLimiter.isStopped===!0&&nt.googleLimiter.start(),nt.cloudFlareLimiter.isStopped===!0&&nt.cloudFlareLimiter.start()}async waitForAvailableEndpoint(){let r=await Promise.race([nt.googleLimiter.awaitTokens(1).then(()=>nt.googleLimiter.tryRemoveTokens(1)).then(i=>{if(i)return`https://dns.google/resolve?name=${this.hostname}&type=A`}),nt.cloudFlareLimiter.awaitTokens(1).then(()=>nt.cloudFlareLimiter.tryRemoveTokens(1)).then(i=>{if(i)return`https://cloudflare-dns.com/dns-query?name=${this.hostname}&type=A`})]);return r??(It.info("we awaited tokens, but could not retrieve any.. restarting dnsRequest"),await this.waitForAvailableEndpoint())}async dnsRequest(r){try{let u=await(await fetch(r,{method:"GET",headers:{Accept:"application/dns-json"}})).json();await this.handleDnsQueryResponse(u)}catch(i){It.error("problem submitting DNS request",r,i),this.onError()}}async handleDnsQueryResponse(r){if(r.Answer==null)return It.error('Response does not contain the "Answer" property:',r),this.onError();let i=null;for(let u=0;u<r.Answer.length&&i==null;u++){let p=r.Answer[u];p.type===1&&(i=p.data)}if(i!=null)try{let u=await $n(wn,i);if(u?.country_code!=null){this.onResponse(u),u.time=Date.now();let p=JSON.stringify(u);localStorage.setItem(this.hostname,p)}else It.error("geoipResponse.country_code is null")}catch(u){It.error(`error while getting DNS A record for ${this.hostname}`,u),this.onError()}else It.error("IP is still null",r)}onError(){this.tag.empty()}onResponse(r){this.tag.style.setProperty("background-image",`url('https://ipfs.io/ipfs/QmaYjj5BHGAWfopTdE8ESzypbuthsZqTeqz9rEuh3EJZi6/${r.country_code.toLowerCase()}.svg')`),this.tag.title=r.country_name,this.tag.empty()}},Lt=nt;Lt.googleLimiter=new Ut({bucketSize:1,tokensPerInterval:1,interval:1e3*2,stopped:!0}),Lt.cloudFlareLimiter=new Ut({bucketSize:1,tokensPerInterval:1,interval:1e3*2,stopped:!0});var ui=new Re("expectSubdomainRedirect");async function Vn(e){let{redirected:t,url:r}=await fetch(e.toString());ui.debug("redirected: ",t),ui.debug("responseUrl: ",r),t&&ui.debug("definitely redirected");let{hostname:i}=new Xe(r);if(!i.startsWith(ut)){let u=`Expected ${e.toString()} to redirect to subdomain '${ut}' but instead received '${r}'`;throw ui.debug(u),new Error(u)}}async function hi(e){return await new Promise((r,i)=>{let u=new Image,p=setTimeout(()=>{i(new Error(`Timeout when attempting to load img from '${u.src}`))},15e3),R=(f,E,B,O,C)=>{clearTimeout(p),C==null?i(new Error(`Unknown Error when attempting to load img from '${u.src}`)):i(C)};u.onerror=R,u.onload=()=>{clearTimeout(p),r()},u.src=e.toString()})}var na=new Re("Origin"),di=class{constructor(t){this.parent=t;this.tag=new Qe("div","Origin")}async check(){let t=new Xe(this.parent.gateway),r=new Xe(`${t.protocol}//${ut}.ipfs.${t.hostname}/?now=${Date.now()}&filename=1x1.png#x-ipfs-companion-no-redirect`),i=new Xe(`${t.protocol}//${t.hostname}/ipfs/${ut}?now=${Date.now()}&filename=1x1.png#x-ipfs-companion-no-redirect`);await hi(r).then(async()=>await Vn(i)).then(()=>{this.tag.win(r.toString()),this.parent.tag.classList.add("origin")}).catch(u=>this.onerror(u))}onerror(t){throw na.error(t),this.tag.err(),t}};var jn=Xt(Qt());var{fetch:ra}=(0,jn.default)(),Ki=new Re("Trustless"),pi=class extends lt{constructor(r){super(r,"div","Trustless");this.parent=r;this._className="Trustless";this._tagName="div"}async check(){let r=Date.now(),i=this.parent.gateway.replace(":hash",at);this.parent.tag.classList.add("trustless");try{let u=await Promise.all(Ti.map(async R=>{let f=`${i}?format=${R}&now=${r}#x-ipfs-companion-no-redirect`,E=await ra(f);return Boolean(E.headers.get("Content-Type")?.includes(`application/vnd.ipld.${R}`))})),p=Ti.filter((R,f)=>!u[f]);if(p.length===0)this.tag.win();else{let R=`URL '${i} does not support the following Trustless response types: [${p.join(", ")}]`;throw Ki.debug(R),new Error(R)}}catch(u){throw Ki.error(u),this.onerror(),u}}checked(){Ki.warn("Not implemented yet")}onerror(){this.tag.err()}};var oa=new Re("Status"),gi=class extends je{constructor(r){super(r,"div","Status");this.parent=r;this._up=!1;this._down=!1}async check(){let r=new Xe(this.parent.gateway),i=new Xe(`${r.protocol}//${r.hostname}/ipfs/${ut}?now=${Date.now()}&filename=1x1.png#x-ipfs-companion-no-redirect`);await hi(i).catch(u=>{throw u!=null&&oa.error(this.parent.gateway,u),u})}get down(){return this._down}set down(r){!this.up&&!this.down&&(this._down=!0,this.tag.lose())}get up(){return this._up}set up(r){!this.up&&!this.down&&(this._up=!0,this.tag.global(),this.parent.tag.classList.add("online"))}onerror(){throw new Error("Not implemented")}};function Ji(e){let t=e.toString();return e?.hostname!=null&&(t=e.hostname.toString()),t.replace(`${at}.ipfs.`,"").replace(`${at}.`,"")}var Hn=Xt(Qt());var{fetch:sa}=(0,Hn.default)(),Yi=new Re("Ipns"),mi=class extends lt{constructor(r){super(r,"div","Ipns");this.parent=r;this._className="Ipns";this._tagName="div"}async check(){let r=Date.now(),i=new URL(this.parent.gateway);i.pathname=yn;let u=`${i.href}?now=${r}#x-ipfs-companion-no-redirect`;try{if((await sa(u)).status===200)this.tag.win();else throw Yi.debug(`${this.parent.gateway} does not support IPNS`),new Error(`URL '${u} is not reachable`)}catch(p){throw Yi.error(p),this.onerror(),p}}checked(){Yi.warn("Not implemented yet")}onerror(){this.tag.err()}};var Fe=new Re("GatewayNode"),yi=class extends je{constructor(r,i,u){super(r,"div","Node");this.parent=r;this.atLeastOneSuccess=!1;this.tag.empty(),this.tag.style.order=Date.now().toString(),this.status=new gi(this),this.tag.append(this.status.tag),this.cors=new Zt(this),this.tag.append(this.cors.tag),this.ipns=new mi(this),this.tag.append(this.ipns.tag),this.origin=new di(this),this.tag.append(this.origin.tag),this.trustless=new pi(this),this.tag.append(this.trustless.tag),this.link=document.createElement("div");let p=i.replace(":hash",at);this.link.url=new Xe(p),this.link.textContent=Ji(this.link.url),this.link.className="Link",this.flag=new Lt(this,this.link.textContent),this.tag.append(this.flag.tag),this.tag.append(this.link),this.took=document.createElement("div"),this.took.className="Took",this.tag.append(this.took),this.gateway=i,this.index=u,this.checkingTime=0}async check(){this.checkingTime=Date.now(),this.flag.check().then(()=>Fe.debug(this.gateway,"Flag success"));let r=[this.status.check().then(()=>Fe.debug(this.gateway,"Status success")).then(this.onSuccessfulCheck.bind(this)),this.cors.check().then(()=>Fe.debug(this.gateway,"CORS success")).then(this.onSuccessfulCheck.bind(this)),this.ipns.check().then(()=>Fe.debug(this.gateway,"IPNS success")).then(this.onSuccessfulCheck.bind(this)),this.origin.check().then(()=>Fe.debug(this.gateway,"Origin success")).then(this.onSuccessfulCheck.bind(this)),this.trustless.check().then(()=>Fe.debug(this.gateway,"Trustless success")).then(this.onSuccessfulCheck.bind(this))];await Promise.allSettled(r).then(i=>i.map(u=>u.status)).then(i=>{i.includes("fulfilled")?(Fe.debug(`For gateway '${this.gateway}', at least one promise was successfully fulfilled`),Fe.debug(this.gateway,"this.status.up: ",this.status.up),Fe.debug(this.gateway,"this.status.down: ",this.status.down),this.status.up=!0,Fe.debug(this.gateway,"this.status.up: ",this.status.up),Fe.debug(this.gateway,"this.status.down: ",this.status.down)):(this.status.down=!0,Fe.debug(`For gateway '${this.gateway}', all promises were rejected`))})}onSuccessfulCheck(){if(!this.atLeastOneSuccess){Fe.info(`For gateway '${this.gateway}', at least one check was successful`),this.atLeastOneSuccess=!0,this.status.up=!0;let r=this.link.url;if(r!=null){let p=Ji(r);this.link.innerHTML=`<a title="${p}" href="${r.toString()}#x-ipfs-companion-no-redirect" target="_blank">${p}</a>`}let i=Date.now()-this.checkingTime;this.tag.style.order=i.toString();let u=(i/1e3).toFixed(2);this.took.textContent=`${u}s`}}onerror(){this.tag.err()}};var wi=class{constructor(t){this.parent=t;let r=document.getElementById("checker.results");if(r==null)throw new Error('Element with Id "checker.results" not found.');this.element=r}append(t){this.element.append(t.element)}};var _i=class extends je{constructor(r){super(r);this.parent=r;let i=document.getElementById("checker.stats");if(i==null)throw new Error('Could not find element with Id "checker.stats"');this.tag=Qe.fromElement(i),this.gateways=document.createElement("div"),this.gateways.textContent="0/0 tested",this.gateways.className="Gateways",this.tag.append(this.gateways),this.totals=document.createElement("div"),this.totals.textContent="0 online",this.totals.className="Totals",this.tag.append(this.totals)}update(){let r=0,i=0;for(let u of this.parent.nodes)u.status.up?r+=1:u.status.down&&(i+=1);this.gateways.textContent=`${r+i}/${this.parent.nodes.length} tested`,this.totals.textContent=`${r} online`}};var aa=new Re("Checker"),vi=class{constructor(){this.nodes=[];let t=document.getElementById("checker");if(t==null)throw new Error('Element with Id "checker" not found.');this.element=t,this.stats=new _i(this),this.results=new wi(this),this.updateStats=this.updateStats.bind(this)}updateStats(){this.stats.update()}async checkGateways(t){let r=[];for(let i of t){let u=new yi(this.results,i,this.nodes.length);this.nodes.push(u),this.results.append(u.tag),setTimeout(()=>{r.push(u.check().catch(p=>aa.error(p)).finally(this.updateStats))},100*this.nodes.length)}}};var Wn=["https://ipfs.io/ipfs/:hash","https://dweb.link/ipfs/:hash","https://gateway.ipfs.io/ipfs/:hash","https://ninetailed.ninja/ipfs/:hash","https://via0.com/ipfs/:hash","https://ipfs.eternum.io/ipfs/:hash","https://hardbin.com/ipfs/:hash","https://cloudflare-ipfs.com/ipfs/:hash","https://astyanax.io/ipfs/:hash","https://cf-ipfs.com/ipfs/:hash","https://ipns.co/ipfs/:hash","https://gateway.originprotocol.com/ipfs/:hash","https://gateway.pinata.cloud/ipfs/:hash","https://ipfs.sloppyta.co/ipfs/:hash","https://ipfs.busy.org/ipfs/:hash","https://ipfs.greyh.at/ipfs/:hash","https://gateway.serph.network/ipfs/:hash","https://jorropo.net/ipfs/:hash","https://ipfs.fooock.com/ipfs/:hash","https://cdn.cwinfo.net/ipfs/:hash","https://aragon.ventures/ipfs/:hash","https://permaweb.io/ipfs/:hash","https://ipfs.best-practice.se/ipfs/:hash","https://storjipfs-gateway.com/ipfs/:hash","https://ipfs.runfission.com/ipfs/:hash","https://ipfs.trusti.id/ipfs/:hash","https://ipfs.overpi.com/ipfs/:hash","https://ipfs.ink/ipfs/:hash","https://ipfsgateway.makersplace.com/ipfs/:hash","https://ipfs.funnychain.co/ipfs/:hash","https://ipfs.telos.miami/ipfs/:hash","https://ipfs.mttk.net/ipfs/:hash","https://ipfs.fleek.co/ipfs/:hash","https://ipfs.jbb.one/ipfs/:hash","https://ipfs.yt/ipfs/:hash","https://hashnews.k1ic.com/ipfs/:hash","https://ipfs.drink.cafe/ipfs/:hash","https://ipfs.kavin.rocks/ipfs/:hash","https://ipfs.denarius.io/ipfs/:hash","https://crustwebsites.net/ipfs/:hash","https://ipfs0.sjc.cloudsigma.com/ipfs/:hash","http://ipfs.genenetwork.org/ipfs/:hash","https://ipfs.eth.aragon.network/ipfs/:hash","https://ipfs.smartholdem.io/ipfs/:hash","https://ipfs.xoqq.ch/ipfs/:hash","http://natoboram.mynetgear.com:8080/ipfs/:hash","https://video.oneloveipfs.com/ipfs/:hash","http://ipfs.anonymize.com/ipfs/:hash","https://ipfs.scalaproject.io/ipfs/:hash","https://search.ipfsgate.com/ipfs/:hash","https://ipfs.decoo.io/ipfs/:hash","https://alexdav.id/ipfs/:hash","https://ipfs.uploads.nu/ipfs/:hash","https://hub.textile.io/ipfs/:hash","https://ipfs1.pixura.io/ipfs/:hash","https://ravencoinipfs-gateway.com/ipfs/:hash","https://konubinix.eu/ipfs/:hash","https://ipfs.tubby.cloud/ipfs/:hash","https://ipfs.lain.la/ipfs/:hash","https://ipfs.kaleido.art/ipfs/:hash","https://ipfs.slang.cx/ipfs/:hash","https://ipfs.arching-kaos.com/ipfs/:hash","https://storry.tv/ipfs/:hash","https://ipfs.1-2.dev/ipfs/:hash","https://dweb.eu.org/ipfs/:hash","https://permaweb.eu.org/ipfs/:hash","https://ipfs.namebase.io/ipfs/:hash","https://ipfs.tribecap.co/ipfs/:hash","https://ipfs.kinematiks.com/ipfs/:hash","https://c4rex.co/ipfs/:hash","https://nftstorage.link/ipfs/:hash","https://gravity.jup.io/ipfs/:hash","http://fzdqwfb5ml56oadins5jpuhe6ki6bk33umri35p5kt2tue4fpws5efid.onion/ipfs/:hash","https://tth-ipfs.com/ipfs/:hash","https://ipfs.chisdealhd.co.uk/ipfs/:hash","https://ipfs.alloyxuast.tk/ipfs/:hash","https://ipfs.litnet.work/ipfs/:hash","https://4everland.io/ipfs/:hash","https://ipfs-gateway.cloud/ipfs/:hash","https://w3s.link/ipfs/:hash","https://cthd.icu/ipfs/:hash","https://ipfs.joaoleitao.org/ipfs/:hash","https://ipfs.tayfundogdas.me/ipfs/:hash","https://ipfs.jpu.jp/ipfs/:hash"];var qe=Xt(Kn()),Jn=localStorage.getItem("metrics_consent"),Yn=document.querySelector(".js-metrics-notification"),Qi=document.querySelector(".js-metrics-notification-decline-warning"),Zi=document.querySelector(".js-metrics-notification-accept"),Xn=document.querySelector(".js-metrics-notification-decline"),Qn=document.querySelector(".js-metrics-notification-warning-close"),Wt=document.querySelector(".js-cookie-banner-toggle");function en(e){tr(),qe.default.add_consent(e),Array.isArray(e)?localStorage.setItem("metrics_consent",JSON.stringify(e)):localStorage.setItem("metrics_consent",JSON.stringify([e]))}function tn(){Zi?.removeEventListener("click",tn),en(["all"])}function Zn(){en(["necessary"]),tr(),ca()}function ca(){Qi?.classList.remove("hidden"),Wt?.setAttribute("disabled","")}function er(){Qn?.removeEventListener("click",er),Qi?.classList.add("hidden"),Wt?.removeAttribute("disabled")}function tr(){Zi?.removeEventListener("click",tn),Xn?.removeEventListener("click",Zn),Yn?.classList.add("hidden"),Wt?.removeAttribute("disabled")}function Xi(){Zi?.addEventListener("click",tn),Xn?.addEventListener("click",Zn),Qn?.addEventListener("click",er),Yn?.classList.remove("hidden"),Wt?.setAttribute("disabled",""),Qi?.classList.add("hidden")}function la(){Xi()}function ir(){Wt?.addEventListener("click",la),qe.default.init({app_key:"3c2c0819434074fc4d339ddd8e112a1e741ecb72",url:"https://countly.ipfs.io",require_consent:!0});let e=["sessions","views"],t=["attribution","users","location"],r=["events","crashes","apm"],i=["scrolls","clicks","forms","star-rating","feedback"];if(qe.default.group_features({all:[...e,...t,...r,...i],necessary:e,marketing:t,tracking:i,performance:r}),qe.default.track_clicks(),qe.default.track_errors(),qe.default.track_forms(),qe.default.track_links(),qe.default.track_pageview(),qe.default.track_scrolls(),qe.default.track_sessions(),qe.default.track_view(),Jn!=null)try{en(JSON.parse(Jn))}catch{Xi()}else Xi()}ir();var nr=new Re("App index");window.checker=new vi;window.checker.checkGateways(Wn).catch(e=>{nr.error("Unexpected error"),nr.error(e)});})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
return IpfsPublicGatewayChecker}));
